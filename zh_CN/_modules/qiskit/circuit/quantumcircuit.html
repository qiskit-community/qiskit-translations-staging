


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>qiskit.circuit.quantumcircuit &mdash; Qiskit 0.30.1 文档</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="../../../getting_started.html">Getting started</a>
          </li>

          <li>
            <a href="../../../tutorials.html">Tutorials</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/partners/" target="_blank">Partners</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Applications
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/machine-learning/">
                  <span class="dropdown-title">Machine learning</span>
                  <p>QSVM, VQC (Variational Quantum Classifier), and QGAN (Quantum Generative
                    Adversarial Network) algorithms.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/nature/">
                  <span class="dropdown-title">Nature</span>
                  <p>Quantum applications in chemistry, physics, and biology.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/finance/">
                  <span class="dropdown-title">Finance</span>
                  <p>Uncertainty components for stock/securities problems, Ising translators for
                    portfolio optimizations and data providers to source real or random data.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/optimization/">
                  <span class="dropdown-title">Optimization</span>
                  <p>High-level optimization problems that are ready to
                    run on simulators and real quantum devices</p>
                </a>
              </div>
          </li>
          <li>
              <a href=="https://qiskit.org/documentation/experiments/" target="_blank">Experiments</a>
          </li>
          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.slack.com">
                  <span class="dropdown-title">Slack support</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/textbook">
                  <span class="dropdown-title">Qiskit Textbook</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/events">
                  <span class="dropdown-title">Qiskit events</span>
                  <p></p>
                </a>
            </div>
          </li>
          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">zh_CN</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Languages</dt>
      
        <dd><a class="version" href="/documentation/_modules/qiskit/circuit/quantumcircuit.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/_modules/qiskit/circuit/quantumcircuit.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/_modules/qiskit/circuit/quantumcircuit.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/_modules/qiskit/circuit/quantumcircuit.html">Korean</a></dd>
      
        <dd><a class="version" href="/documentation/locale/pt_BR/_modules/qiskit/circuit/quantumcircuit.html">Portuguese, Brazilian</a></dd>
      
        <dd><a class="version" href="/documentation/locale/fr_FR/_modules/qiskit/circuit/quantumcircuit.html">French</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ta_IN/_modules/qiskit/circuit/quantumcircuit.html">Tamil</a></dd>
      
    </dl>
    
    <dl>
      <dt>Previous Releases</dt>
      
        <dd><a class="version" href="/documentation/stable/0.19/index.html">0.19</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.24/index.html">0.24</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.25/index.html">0.25</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.26/index.html">0.26</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.27/index.html">0.27</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.28/index.html">0.28</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.29/index.html">0.29</a></dd>
      
    </dl>
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Documentation Homepage</a></li>
</ul>
<p><span class="caption-text">Frontmatter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../qc_intro.html">Quantum computing in a nutshell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro_tutorial1.html">Introduction to Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing_to_qiskit.html">Contributing to Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration.html">Local Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions</a></li>
</ul>
<p><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../apidoc/circuit_library.html">Circuit Library</a></li>
</ul>
<p><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../apidoc/terra.html">Qiskit Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apidoc/aer.html">Qiskit Aer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apidoc/ignis.html">Qiskit Ignis (deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apidoc/aqua.html">Qiskit Aqua (deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apidoc/ibmq-provider.html">Qiskit IBM Quantum Provider</a></li>
</ul>
<p><span class="caption-text">Qiskit Aqua Migration Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../aqua_migration.html">Qiskit Aqua Migration Guide</a></li>
</ul>
<p><span class="caption-text">Troubleshooting</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/lab/docs/iql/manage/errors">IBM Quantum API error codes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../index.html">模块代码</a> &gt;</li>
        
      <li>qiskit.circuit.quantumcircuit</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content style-external-links">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>qiskit.circuit.quantumcircuit 源代码</h1><div class="highlight"><pre>
<span></span><span class="c1"># This code is part of Qiskit.</span>
<span class="c1">#</span>
<span class="c1"># (C) Copyright IBM 2017.</span>
<span class="c1">#</span>
<span class="c1"># This code is licensed under the Apache License, Version 2.0. You may</span>
<span class="c1"># obtain a copy of this license in the LICENSE.txt file in the root directory</span>
<span class="c1"># of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.</span>
<span class="c1">#</span>
<span class="c1"># Any modifications or derivative works of this code must retain this</span>
<span class="c1"># copyright notice, and modified files need to carry a notice indicating</span>
<span class="c1"># that they have been altered from the originals.</span>

<span class="c1"># pylint: disable=bad-docstring-quotes,invalid-name</span>

<span class="sd">&quot;&quot;&quot;Quantum circuit object.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit.exceptions</span> <span class="kn">import</span> <span class="n">QiskitError</span><span class="p">,</span> <span class="n">MissingOptionalLibraryError</span>
<span class="kn">from</span> <span class="nn">qiskit.utils.multiprocessing</span> <span class="kn">import</span> <span class="n">is_main_process</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.instruction</span> <span class="kn">import</span> <span class="n">Instruction</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.gate</span> <span class="kn">import</span> <span class="n">Gate</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.parameter</span> <span class="kn">import</span> <span class="n">Parameter</span>
<span class="kn">from</span> <span class="nn">qiskit.qasm.qasm</span> <span class="kn">import</span> <span class="n">Qasm</span>
<span class="kn">from</span> <span class="nn">qiskit.qasm.exceptions</span> <span class="kn">import</span> <span class="n">QasmError</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.exceptions</span> <span class="kn">import</span> <span class="n">CircuitError</span>
<span class="kn">from</span> <span class="nn">qiskit.utils.deprecation</span> <span class="kn">import</span> <span class="n">deprecate_function</span><span class="p">,</span> <span class="n">deprecate_arguments</span>
<span class="kn">from</span> <span class="nn">.parameterexpression</span> <span class="kn">import</span> <span class="n">ParameterExpression</span>
<span class="kn">from</span> <span class="nn">.quantumregister</span> <span class="kn">import</span> <span class="n">QuantumRegister</span><span class="p">,</span> <span class="n">Qubit</span><span class="p">,</span> <span class="n">AncillaRegister</span><span class="p">,</span> <span class="n">AncillaQubit</span>
<span class="kn">from</span> <span class="nn">.classicalregister</span> <span class="kn">import</span> <span class="n">ClassicalRegister</span><span class="p">,</span> <span class="n">Clbit</span>
<span class="kn">from</span> <span class="nn">.parametertable</span> <span class="kn">import</span> <span class="n">ParameterTable</span><span class="p">,</span> <span class="n">ParameterView</span>
<span class="kn">from</span> <span class="nn">.parametervector</span> <span class="kn">import</span> <span class="n">ParameterVector</span><span class="p">,</span> <span class="n">ParameterVectorElement</span>
<span class="kn">from</span> <span class="nn">.instructionset</span> <span class="kn">import</span> <span class="n">InstructionSet</span>
<span class="kn">from</span> <span class="nn">.register</span> <span class="kn">import</span> <span class="n">Register</span>
<span class="kn">from</span> <span class="nn">.bit</span> <span class="kn">import</span> <span class="n">Bit</span>
<span class="kn">from</span> <span class="nn">.quantumcircuitdata</span> <span class="kn">import</span> <span class="n">QuantumCircuitData</span>
<span class="kn">from</span> <span class="nn">.delay</span> <span class="kn">import</span> <span class="n">Delay</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pygments</span>
    <span class="kn">from</span> <span class="nn">pygments.formatters</span> <span class="kn">import</span> <span class="n">Terminal256Formatter</span>  <span class="c1"># pylint: disable=no-name-in-module</span>
    <span class="kn">from</span> <span class="nn">qiskit.qasm.pygments</span> <span class="kn">import</span> <span class="n">OpenQASMLexer</span>  <span class="c1"># pylint: disable=ungrouped-imports</span>
    <span class="kn">from</span> <span class="nn">qiskit.qasm.pygments</span> <span class="kn">import</span> <span class="n">QasmTerminalStyle</span>  <span class="c1"># pylint: disable=ungrouped-imports</span>

    <span class="n">HAS_PYGMENTS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># pylint: disable=broad-except</span>
    <span class="n">HAS_PYGMENTS</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="QuantumCircuit"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.html#qiskit.circuit.QuantumCircuit">[文档]</a><span class="k">class</span> <span class="nc">QuantumCircuit</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a new circuit.</span>

<span class="sd">    A circuit is a list of instructions bound to some registers.</span>

<span class="sd">    Args:</span>
<span class="sd">        regs (list(:class:`Register`) or list(``int``) or list(list(:class:`Bit`))): The</span>
<span class="sd">            registers to be included in the circuit.</span>

<span class="sd">            * If a list of :class:`Register` objects, represents the :class:`QuantumRegister`</span>
<span class="sd">              and/or :class:`ClassicalRegister` objects to include in the circuit.</span>

<span class="sd">              For example:</span>

<span class="sd">                * ``QuantumCircuit(QuantumRegister(4))``</span>
<span class="sd">                * ``QuantumCircuit(QuantumRegister(4), ClassicalRegister(3))``</span>
<span class="sd">                * ``QuantumCircuit(QuantumRegister(4, &#39;qr0&#39;), QuantumRegister(2, &#39;qr1&#39;))``</span>

<span class="sd">            * If a list of ``int``, the amount of qubits and/or classical bits to include in</span>
<span class="sd">              the circuit. It can either be a single int for just the number of quantum bits,</span>
<span class="sd">              or 2 ints for the number of quantum bits and classical bits, respectively.</span>

<span class="sd">              For example:</span>

<span class="sd">                * ``QuantumCircuit(4) # A QuantumCircuit with 4 qubits``</span>
<span class="sd">                * ``QuantumCircuit(4, 3) # A QuantumCircuit with 4 qubits and 3 classical bits``</span>

<span class="sd">            * If a list of python lists containing :class:`Bit` objects, a collection of</span>
<span class="sd">              :class:`Bit` s to be added to the circuit.</span>


<span class="sd">        name (str): the name of the quantum circuit. If not set, an</span>
<span class="sd">            automatically generated string will be assigned.</span>
<span class="sd">        global_phase (float or ParameterExpression): The global phase of the circuit in radians.</span>
<span class="sd">        metadata (dict): Arbitrary key value metadata to associate with the</span>
<span class="sd">            circuit. This gets stored as free-form data in a dict in the</span>
<span class="sd">            :attr:`~qiskit.circuit.QuantumCircuit.metadata` attribute. It will</span>
<span class="sd">            not be directly used in the circuit.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CircuitError: if the circuit name, if given, is not valid.</span>

<span class="sd">    Examples:</span>

<span class="sd">        Construct a simple Bell state circuit.</span>

<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from qiskit import QuantumCircuit</span>

<span class="sd">            qc = QuantumCircuit(2, 2)</span>
<span class="sd">            qc.h(0)</span>
<span class="sd">            qc.cx(0, 1)</span>
<span class="sd">            qc.measure([0, 1], [0, 1])</span>
<span class="sd">            qc.draw()</span>

<span class="sd">        Construct a 5-qubit GHZ circuit.</span>

<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from qiskit import QuantumCircuit</span>

<span class="sd">            qc = QuantumCircuit(5)</span>
<span class="sd">            qc.h(0)</span>
<span class="sd">            qc.cx(0, range(1, 5))</span>
<span class="sd">            qc.measure_all()</span>

<span class="sd">        Construct a 4-qubit Bernstein-Vazirani circuit using registers.</span>

<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from qiskit import QuantumRegister, ClassicalRegister, QuantumCircuit</span>

<span class="sd">            qr = QuantumRegister(3, &#39;q&#39;)</span>
<span class="sd">            anc = QuantumRegister(1, &#39;ancilla&#39;)</span>
<span class="sd">            cr = ClassicalRegister(3, &#39;c&#39;)</span>
<span class="sd">            qc = QuantumCircuit(qr, anc, cr)</span>

<span class="sd">            qc.x(anc[0])</span>
<span class="sd">            qc.h(anc[0])</span>
<span class="sd">            qc.h(qr[0:3])</span>
<span class="sd">            qc.cx(qr[0:3], anc[0])</span>
<span class="sd">            qc.h(qr[0:3])</span>
<span class="sd">            qc.barrier(qr)</span>
<span class="sd">            qc.measure(qr, cr)</span>

<span class="sd">            qc.draw()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">instances</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;circuit&quot;</span>

    <span class="c1"># Class variable OPENQASM header</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;OPENQASM 2.0;&quot;</span>
    <span class="n">extension_lib</span> <span class="o">=</span> <span class="s1">&#39;include &quot;qelib1.inc&quot;;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">regs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">global_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">QuantumRegister</span><span class="p">,</span> <span class="n">ClassicalRegister</span><span class="p">))</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regs</span><span class="p">):</span>
            <span class="c1"># check if inputs are integers, but also allow e.g. 2.0</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">valid_reg_size</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">reg</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regs</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="n">valid_reg_size</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_reg_size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                    <span class="s2">&quot;Circuit args must be Registers or integers. (</span><span class="si">%s</span><span class="s2"> &#39;</span><span class="si">%s</span><span class="s2">&#39; was &quot;</span>
                    <span class="s2">&quot;provided)&quot;</span> <span class="o">%</span> <span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regs</span><span class="p">],</span> <span class="n">regs</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="n">regs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regs</span><span class="p">)</span>  <span class="c1"># cast to int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_base_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_base_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls_prefix</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name_update</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;The circuit name should be a string &quot;</span> <span class="s2">&quot;(or None to auto-generate a name).&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_base_name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_increment_instances</span><span class="p">()</span>

        <span class="c1"># Data contains a list of instructions and their contexts,</span>
        <span class="c1"># in the order they were applied.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># This is a map of registers bound to this circuit, by name.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qubits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qubit_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clbits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clbit_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ancillas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calibrations</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="o">*</span><span class="n">regs</span><span class="p">)</span>

        <span class="c1"># Parameter table tracks instructions with variable parameters.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span> <span class="o">=</span> <span class="n">ParameterTable</span><span class="p">()</span>

        <span class="c1"># Cache to avoid re-sorting parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_layout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_phase</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span> <span class="o">=</span> <span class="n">global_phase</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;dt&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Only a dictionary or None is accepted for circuit metadata&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the circuit data (instructions and context).</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuitData: a list-like object containing the tuples for the circuit&#39;s data.</span>

<span class="sd">            Each tuple is in the format ``(instruction, qargs, cargs)``, where instruction is an</span>
<span class="sd">            Instruction (or subclass) object, qargs is a list of Qubit objects, and cargs is a</span>
<span class="sd">            list of Clbit objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">QuantumCircuitData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return calibration dictionary.</span>

<span class="sd">        The custom pulse definition of a given gate is of the form</span>
<span class="sd">            {&#39;gate_name&#39;: {(qubits, params): schedule}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calibrations</span><span class="p">)</span>

    <span class="nd">@calibrations</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibrations</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the circuit calibration data from a dictionary of calibration definition.</span>

<span class="sd">        Args:</span>
<span class="sd">            calibrations (dict): A dictionary of input in the format</span>
<span class="sd">                {&#39;gate_name&#39;: {(qubits, gate_params): schedule}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calibrations</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">calibrations</span><span class="p">)</span>

    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_input</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the circuit data from a list of instructions and context.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_input (list): A list of instructions with context</span>
<span class="sd">                in the format (instruction, qargs, cargs), where Instruction</span>
<span class="sd">                is an Instruction (or subclass) object, qargs is a list of</span>
<span class="sd">                Qubit objects, and cargs is a list of Clbit objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If data_input is QuantumCircuitData(self), clearing self._data</span>
        <span class="c1"># below will also empty data_input, so make a shallow copy first.</span>
        <span class="n">data_input</span> <span class="o">=</span> <span class="n">data_input</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span> <span class="o">=</span> <span class="n">ParameterTable</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="n">data_input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The user provided metadata associated with the circuit</span>

<span class="sd">        The metadata for the circuit is a user provided ``dict`` of metadata</span>
<span class="sd">        for the circuit. It will not be used to influence the execution or</span>
<span class="sd">        operation of the circuit, but it is expected to be passed between</span>
<span class="sd">        all transforms of the circuit (ie transpilation) and that providers will</span>
<span class="sd">        associate any circuit metadata with the results it returns from</span>
<span class="sd">        execution of that circuit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@metadata</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the circuit metadata&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Only a dictionary or None is accepted for circuit metadata&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">QuantumCircuit</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># TODO: remove the DAG from this function</span>
        <span class="kn">from</span> <span class="nn">qiskit.converters</span> <span class="kn">import</span> <span class="n">circuit_to_dag</span>

        <span class="k">return</span> <span class="n">circuit_to_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="n">circuit_to_dag</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_increment_instances</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">instances</span> <span class="o">+=</span> <span class="mi">1</span>

<div class="viewcode-block" id="QuantumCircuit.cls_instances"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cls_instances.html#qiskit.circuit.QuantumCircuit.cls_instances">[文档]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">cls_instances</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current number of instances of this class,</span>
<span class="sd">        useful for auto naming.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">instances</span></div>

<div class="viewcode-block" id="QuantumCircuit.cls_prefix"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cls_prefix.html#qiskit.circuit.QuantumCircuit.cls_prefix">[文档]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">cls_prefix</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the prefix to use for auto naming.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">prefix</span></div>

    <span class="k">def</span> <span class="nf">_name_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;update name of instance using instance number&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_main_process</span><span class="p">():</span>
            <span class="n">pid_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">mp</span><span class="o">.</span><span class="n">current_process</span><span class="p">()</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pid_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_base_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cls_instances</span><span class="p">()</span><span class="si">}{</span><span class="n">pid_name</span><span class="si">}</span><span class="s2">&quot;</span>

<div class="viewcode-block" id="QuantumCircuit.has_register"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.has_register.html#qiskit.circuit.QuantumCircuit.has_register">[文档]</a>    <span class="k">def</span> <span class="nf">has_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">register</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test if this circuit has the register r.</span>

<span class="sd">        Args:</span>
<span class="sd">            register (Register): a quantum or classical register.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the register is contained in this circuit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">has_reg</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">QuantumRegister</span><span class="p">)</span> <span class="ow">and</span> <span class="n">register</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">:</span>
            <span class="n">has_reg</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">ClassicalRegister</span><span class="p">)</span> <span class="ow">and</span> <span class="n">register</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">:</span>
            <span class="n">has_reg</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">has_reg</span></div>

<div class="viewcode-block" id="QuantumCircuit.reverse_ops"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.reverse_ops.html#qiskit.circuit.QuantumCircuit.reverse_ops">[文档]</a>    <span class="k">def</span> <span class="nf">reverse_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reverse the circuit by reversing the order of instructions.</span>

<span class="sd">        This is done by recursively reversing all instructions.</span>
<span class="sd">        It does not invert (adjoint) any gate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: the reversed circuit.</span>

<span class="sd">        Examples:</span>

<span class="sd">            input:</span>
<span class="sd">                 ┌───┐</span>
<span class="sd">            q_0: ┤ H ├─────■──────</span>
<span class="sd">                 └───┘┌────┴─────┐</span>
<span class="sd">            q_1: ─────┤ RX(1.57) ├</span>
<span class="sd">                      └──────────┘</span>

<span class="sd">            output:</span>
<span class="sd">                             ┌───┐</span>
<span class="sd">            q_0: ─────■──────┤ H ├</span>
<span class="sd">                 ┌────┴─────┐└───┘</span>
<span class="sd">            q_1: ┤ RX(1.57) ├─────</span>
<span class="sd">                 └──────────┘</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reverse_circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_reverse&quot;</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
            <span class="n">reverse_circ</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">inst</span><span class="o">.</span><span class="n">reverse_ops</span><span class="p">(),</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span><span class="p">)</span>

        <span class="n">reverse_circ</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
        <span class="n">reverse_circ</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span>
        <span class="k">return</span> <span class="n">reverse_circ</span></div>

<div class="viewcode-block" id="QuantumCircuit.reverse_bits"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.reverse_bits.html#qiskit.circuit.QuantumCircuit.reverse_bits">[文档]</a>    <span class="k">def</span> <span class="nf">reverse_bits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a circuit with the opposite order of wires.</span>

<span class="sd">        The circuit is &quot;vertically&quot; flipped. If a circuit is</span>
<span class="sd">        defined over multiple registers, the resulting circuit will have</span>
<span class="sd">        the same registers but with their order flipped.</span>

<span class="sd">        This method is useful for converting a circuit written in little-endian</span>
<span class="sd">        convention to the big-endian equivalent, and vice versa.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: the circuit with reversed bit order.</span>

<span class="sd">        Examples:</span>

<span class="sd">            input:</span>
<span class="sd">                 ┌───┐</span>
<span class="sd">            q_0: ┤ H ├─────■──────</span>
<span class="sd">                 └───┘┌────┴─────┐</span>
<span class="sd">            q_1: ─────┤ RX(1.57) ├</span>
<span class="sd">                      └──────────┘</span>

<span class="sd">            output:</span>
<span class="sd">                      ┌──────────┐</span>
<span class="sd">            q_0: ─────┤ RX(1.57) ├</span>
<span class="sd">                 ┌───┐└────┬─────┘</span>
<span class="sd">            q_1: ┤ H ├─────■──────</span>
<span class="sd">                 └───┘</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span>
            <span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">),</span>
            <span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">global_phase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">num_qubits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_qubits</span>
        <span class="n">num_clbits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clbits</span>
        <span class="n">old_qubits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span>
        <span class="n">old_clbits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span>
        <span class="n">new_qubits</span> <span class="o">=</span> <span class="n">circ</span><span class="o">.</span><span class="n">qubits</span>
        <span class="n">new_clbits</span> <span class="o">=</span> <span class="n">circ</span><span class="o">.</span><span class="n">clbits</span>

        <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">new_qargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_qubits</span><span class="p">[</span><span class="n">num_qubits</span> <span class="o">-</span> <span class="n">old_qubits</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qargs</span><span class="p">]</span>
            <span class="n">new_cargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_clbits</span><span class="p">[</span><span class="n">num_clbits</span> <span class="o">-</span> <span class="n">old_clbits</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cargs</span><span class="p">]</span>
            <span class="n">circ</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">new_qargs</span><span class="p">,</span> <span class="n">new_cargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">circ</span></div>

<div class="viewcode-block" id="QuantumCircuit.inverse"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.inverse.html#qiskit.circuit.QuantumCircuit.inverse">[文档]</a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Invert (take adjoint of) this circuit.</span>

<span class="sd">        This is done by recursively inverting all gates.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: the inverted circuit</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: if the circuit cannot be inverted.</span>

<span class="sd">        Examples:</span>

<span class="sd">            input:</span>
<span class="sd">                 ┌───┐</span>
<span class="sd">            q_0: ┤ H ├─────■──────</span>
<span class="sd">                 └───┘┌────┴─────┐</span>
<span class="sd">            q_1: ─────┤ RX(1.57) ├</span>
<span class="sd">                      └──────────┘</span>

<span class="sd">            output:</span>
<span class="sd">                              ┌───┐</span>
<span class="sd">            q_0: ──────■──────┤ H ├</span>
<span class="sd">                 ┌─────┴─────┐└───┘</span>
<span class="sd">            q_1: ┤ RX(-1.57) ├─────</span>
<span class="sd">                 └───────────┘</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inverse_circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_dg&quot;</span><span class="p">,</span>
            <span class="n">global_phase</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">):</span>
            <span class="n">inverse_circ</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">inst</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inverse_circ</span></div>

<div class="viewcode-block" id="QuantumCircuit.repeat"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.repeat.html#qiskit.circuit.QuantumCircuit.repeat">[文档]</a>    <span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Repeat this circuit ``reps`` times.</span>

<span class="sd">        Args:</span>
<span class="sd">            reps (int): How often this circuit should be repeated.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: A circuit containing ``reps`` repetitions of this circuit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repeated_circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;**</span><span class="si">{</span><span class="n">reps</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># benefit of appending instructions: decomposing shows the subparts, i.e. the power</span>
        <span class="c1"># is actually `reps` times this circuit, and it is currently much faster than `compose`.</span>
        <span class="k">if</span> <span class="n">reps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># try to append as gate if possible to not disallow to_gate</span>
                <span class="n">inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_gate</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">QiskitError</span><span class="p">:</span>
                <span class="n">inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
                <span class="n">repeated_circ</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">repeated_circ</span></div>

<div class="viewcode-block" id="QuantumCircuit.power"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.power.html#qiskit.circuit.QuantumCircuit.power">[文档]</a>    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">matrix_power</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raise this circuit to the power of ``power``.</span>

<span class="sd">        If ``power`` is a positive integer and ``matrix_power`` is ``False``, this implementation</span>
<span class="sd">        defaults to calling ``repeat``. Otherwise, if the circuit is unitary, the matrix is</span>
<span class="sd">        computed to calculate the matrix power.</span>

<span class="sd">        Args:</span>
<span class="sd">            power (int): The power to raise this circuit to.</span>
<span class="sd">            matrix_power (bool): If True, the circuit is converted to a matrix and then the</span>
<span class="sd">                matrix power is computed. If False, and ``power`` is a positive integer,</span>
<span class="sd">                the implementation defaults to ``repeat``.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: If the circuit needs to be converted to a gate but it is not unitary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: A circuit implementing this circuit raised to the power of ``power``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">power</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">matrix_power</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>

        <span class="c1"># attempt conversion to gate</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_parameters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot raise a parameterized circuit to a non-positive power &quot;</span>
                <span class="s2">&quot;or matrix-power, please bind the free parameters: &quot;</span>
                <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">gate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_gate</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">QiskitError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;The circuit contains non-unitary operations and cannot be &quot;</span>
                <span class="s2">&quot;controlled. Note that no qiskit.circuit.Instruction objects may &quot;</span>
                <span class="s2">&quot;be in the circuit for this operation.&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>

        <span class="n">power_circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">)</span>
        <span class="n">power_circuit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gate</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">power</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">gate</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">power_circuit</span></div>

<div class="viewcode-block" id="QuantumCircuit.control"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.control.html#qiskit.circuit.QuantumCircuit.control">[文档]</a>    <span class="k">def</span> <span class="nf">control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_ctrl_qubits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Control this circuit on ``num_ctrl_qubits`` qubits.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_ctrl_qubits (int): The number of control qubits.</span>
<span class="sd">            label (str): An optional label to give the controlled operation for visualization.</span>
<span class="sd">            ctrl_state (str or int): The control state in decimal or as a bitstring</span>
<span class="sd">                (e.g. &#39;111&#39;). If None, use ``2**num_ctrl_qubits - 1``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: The controlled version of this circuit.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: If the circuit contains a non-unitary operation and cannot be controlled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_gate</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">QiskitError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;The circuit contains non-unitary operations and cannot be &quot;</span>
                <span class="s2">&quot;controlled. Note that no qiskit.circuit.Instruction objects may &quot;</span>
                <span class="s2">&quot;be in the circuit for this operation.&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>

        <span class="n">controlled_gate</span> <span class="o">=</span> <span class="n">gate</span><span class="o">.</span><span class="n">control</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="p">)</span>
        <span class="n">control_qreg</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">)</span>
        <span class="n">controlled_circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span>
            <span class="n">control_qreg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;c_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">controlled_circ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">controlled_gate</span><span class="p">,</span> <span class="n">controlled_circ</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">controlled_circ</span></div>

<div class="viewcode-block" id="QuantumCircuit.combine"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.combine.html#qiskit.circuit.QuantumCircuit.combine">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.combine() method is being deprecated. &quot;</span>
        <span class="s2">&quot;Use the compose() method which is more flexible w.r.t &quot;</span>
        <span class="s2">&quot;circuit register compatibility.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED - Returns rhs appended to self if self contains compatible registers.</span>

<span class="sd">        Two circuits are compatible if they contain the same registers</span>
<span class="sd">        or if they contain different registers with unique names. The</span>
<span class="sd">        returned circuit will contain all unique registers between both</span>
<span class="sd">        circuits.</span>

<span class="sd">        Return self + rhs as a new object.</span>

<span class="sd">        Args:</span>
<span class="sd">            rhs (QuantumCircuit): The quantum circuit to append to the right hand side.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: Returns a new QuantumCircuit object</span>

<span class="sd">        Raises:</span>
<span class="sd">            QiskitError: if the rhs circuit is not compatible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check registers in LHS are compatible with RHS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_compatible_regs</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

        <span class="c1"># Make new circuit with combined registers</span>
        <span class="n">combined_qregs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">)</span>
        <span class="n">combined_cregs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">qregs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">:</span>
                <span class="n">combined_qregs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">cregs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">:</span>
                <span class="n">combined_cregs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="o">*</span><span class="n">combined_qregs</span><span class="p">,</span> <span class="o">*</span><span class="n">combined_cregs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">instruction_context</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">rhs</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
            <span class="n">circuit</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="o">*</span><span class="n">instruction_context</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">global_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span> <span class="o">+</span> <span class="n">rhs</span><span class="o">.</span><span class="n">global_phase</span>

        <span class="k">for</span> <span class="n">gate</span><span class="p">,</span> <span class="n">cals</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">calibrations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">sched</span> <span class="ow">in</span> <span class="n">cals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">circuit</span><span class="o">.</span><span class="n">add_calibration</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span> <span class="n">qubits</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">schedule</span><span class="o">=</span><span class="n">sched</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">gate</span><span class="p">,</span> <span class="n">cals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">sched</span> <span class="ow">in</span> <span class="n">cals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">circuit</span><span class="o">.</span><span class="n">add_calibration</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span> <span class="n">qubits</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">schedule</span><span class="o">=</span><span class="n">sched</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">circuit</span></div>

<div class="viewcode-block" id="QuantumCircuit.extend"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.extend.html#qiskit.circuit.QuantumCircuit.extend">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.extend() method is being deprecated. Use the &quot;</span>
        <span class="s2">&quot;compose() (potentially with the inplace=True argument) and tensor() &quot;</span>
        <span class="s2">&quot;methods which are more flexible w.r.t circuit register compatibility.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED - Append QuantumCircuit to the RHS if it contains compatible registers.</span>

<span class="sd">        Two circuits are compatible if they contain the same registers</span>
<span class="sd">        or if they contain different registers with unique names. The</span>
<span class="sd">        returned circuit will contain all unique registers between both</span>
<span class="sd">        circuits.</span>

<span class="sd">        Modify and return self.</span>

<span class="sd">        Args:</span>
<span class="sd">            rhs (QuantumCircuit): The quantum circuit to append to the right hand side.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: Returns this QuantumCircuit object (which has been modified)</span>

<span class="sd">        Raises:</span>
<span class="sd">            QiskitError: if the rhs circuit is not compatible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check registers in LHS are compatible with RHS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_compatible_regs</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

        <span class="c1"># Add new registers</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">qregs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qubits</span> <span class="o">+=</span> <span class="n">element</span><span class="p">[:]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qubit_set</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">element</span><span class="p">[:])</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">cregs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clbits</span> <span class="o">+=</span> <span class="n">element</span><span class="p">[:]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clbit_set</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">element</span><span class="p">[:])</span>

        <span class="c1"># Copy the circuit data if rhs and self are the same, otherwise the data of rhs is</span>
        <span class="c1"># appended to both self and rhs resulting in an infinite loop</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">rhs</span> <span class="ow">is</span> <span class="bp">self</span> <span class="k">else</span> <span class="n">rhs</span><span class="o">.</span><span class="n">data</span>

        <span class="c1"># Add new gates</span>
        <span class="k">for</span> <span class="n">instruction_context</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="o">*</span><span class="n">instruction_context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span> <span class="o">+=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">global_phase</span>

        <span class="k">for</span> <span class="n">gate</span><span class="p">,</span> <span class="n">cals</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">calibrations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">sched</span> <span class="ow">in</span> <span class="n">cals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_calibration</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span> <span class="n">qubits</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">schedule</span><span class="o">=</span><span class="n">sched</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QuantumCircuit.compose"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.compose.html#qiskit.circuit.QuantumCircuit.compose">[文档]</a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">qubits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clbits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">front</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compose circuit with ``other`` circuit or instruction, optionally permuting wires.</span>

<span class="sd">        ``other`` can be narrower or of equal width to ``self``.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (qiskit.circuit.Instruction or QuantumCircuit or BaseOperator):</span>
<span class="sd">                (sub)circuit to compose onto self.</span>
<span class="sd">            qubits (list[Qubit|int]): qubits of self to compose onto.</span>
<span class="sd">            clbits (list[Clbit|int]): clbits of self to compose onto.</span>
<span class="sd">            front (bool): If True, front composition will be performed (not implemented yet).</span>
<span class="sd">            inplace (bool): If True, modify the object. Otherwise return composed circuit.</span>
<span class="sd">            wrap (bool): If True, wraps the other circuit into a gate (or instruction, depending on</span>
<span class="sd">                whether it contains only unitary instructions) before composing it onto self.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: the composed circuit (returns None if inplace==True).</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: if composing on the front.</span>
<span class="sd">            QiskitError: if ``other`` is wider or there are duplicate edge mappings.</span>

<span class="sd">        Examples::</span>

<span class="sd">            lhs.compose(rhs, qubits=[3, 2], inplace=True)</span>

<span class="sd">            .. parsed-literal::</span>

<span class="sd">                            ┌───┐                   ┌─────┐                ┌───┐</span>
<span class="sd">                lqr_1_0: ───┤ H ├───    rqr_0: ──■──┤ Tdg ├    lqr_1_0: ───┤ H ├───────────────</span>
<span class="sd">                            ├───┤              ┌─┴─┐└─────┘                ├───┤</span>
<span class="sd">                lqr_1_1: ───┤ X ├───    rqr_1: ┤ X ├───────    lqr_1_1: ───┤ X ├───────────────</span>
<span class="sd">                         ┌──┴───┴──┐           └───┘                    ┌──┴───┴──┐┌───┐</span>
<span class="sd">                lqr_1_2: ┤ U1(0.1) ├  +                     =  lqr_1_2: ┤ U1(0.1) ├┤ X ├───────</span>
<span class="sd">                         └─────────┘                                    └─────────┘└─┬─┘┌─────┐</span>
<span class="sd">                lqr_2_0: ─────■─────                           lqr_2_0: ─────■───────■──┤ Tdg ├</span>
<span class="sd">                            ┌─┴─┐                                          ┌─┴─┐        └─────┘</span>
<span class="sd">                lqr_2_1: ───┤ X ├───                           lqr_2_1: ───┤ X ├───────────────</span>
<span class="sd">                            └───┘                                          └───┘</span>
<span class="sd">                lcr_0: 0 ═══════════                           lcr_0: 0 ═══════════════════════</span>

<span class="sd">                lcr_1: 0 ═══════════                           lcr_1: 0 ═══════════════════════</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">to_gate</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">QiskitError</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">QuantumCircuit</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">qubits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">qubits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">clbits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">clbits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">num_clbits</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">front</span><span class="p">:</span>
                <span class="n">dest</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">qubits</span><span class="p">,</span> <span class="n">clbits</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">qargs</span><span class="o">=</span><span class="n">qubits</span><span class="p">,</span> <span class="n">cargs</span><span class="o">=</span><span class="n">clbits</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">dest</span>

        <span class="n">instrs</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span>

        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_qubits</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">num_clbits</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clbits</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;Trying to compose with another QuantumCircuit &quot;</span> <span class="s2">&quot;which has more &#39;in&#39; edges.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># number of qubits and clbits must match number in circuit or None</span>
        <span class="n">identity_qubit_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">))</span>
        <span class="n">identity_clbit_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">clbits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">qubits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">qubit_map</span> <span class="o">=</span> <span class="n">identity_qubit_map</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">qubits</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">qubits</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;Number of items in qubits parameter does not&quot;</span>
                <span class="s2">&quot; match number of qubits in the circuit.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qubit_map</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">other</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">q</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qubits</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">if</span> <span class="n">clbits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">clbit_map</span> <span class="o">=</span> <span class="n">identity_clbit_map</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">clbits</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">clbits</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;Number of items in clbits parameter does not&quot;</span>
                <span class="s2">&quot; match number of clbits in the circuit.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clbit_map</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">other</span><span class="o">.</span><span class="n">clbits</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clbits</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="n">edge_map</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">qubit_map</span><span class="p">,</span> <span class="o">**</span><span class="n">clbit_map</span><span class="p">}</span> <span class="ow">or</span> <span class="p">{</span><span class="o">**</span><span class="n">identity_qubit_map</span><span class="p">,</span> <span class="o">**</span><span class="n">identity_clbit_map</span><span class="p">}</span>

        <span class="n">mapped_instrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="n">instrs</span><span class="p">:</span>
            <span class="n">n_qargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge_map</span><span class="p">[</span><span class="n">qarg</span><span class="p">]</span> <span class="k">for</span> <span class="n">qarg</span> <span class="ow">in</span> <span class="n">qargs</span><span class="p">]</span>
            <span class="n">n_cargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge_map</span><span class="p">[</span><span class="n">carg</span><span class="p">]</span> <span class="k">for</span> <span class="n">carg</span> <span class="ow">in</span> <span class="n">cargs</span><span class="p">]</span>
            <span class="n">n_instr</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">instr</span><span class="o">.</span><span class="n">condition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">qiskit.dagcircuit</span> <span class="kn">import</span> <span class="n">DAGCircuit</span>  <span class="c1"># pylint: disable=cyclic-import</span>

                <span class="n">n_instr</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">DAGCircuit</span><span class="o">.</span><span class="n">_map_condition</span><span class="p">(</span><span class="n">edge_map</span><span class="p">,</span> <span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">)</span>

            <span class="n">mapped_instrs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n_instr</span><span class="p">,</span> <span class="n">n_qargs</span><span class="p">,</span> <span class="n">n_cargs</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">front</span><span class="p">:</span>
            <span class="n">dest</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">mapped_instrs</span> <span class="o">+</span> <span class="n">dest</span><span class="o">.</span><span class="n">_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dest</span><span class="o">.</span><span class="n">_data</span> <span class="o">+=</span> <span class="n">mapped_instrs</span>

        <span class="k">if</span> <span class="n">front</span><span class="p">:</span>
            <span class="n">dest</span><span class="o">.</span><span class="n">_parameter_table</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dest</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
                <span class="n">dest</span><span class="o">.</span><span class="n">_update_parameter_table</span><span class="p">(</span><span class="n">instr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># just append new parameters</span>
            <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">mapped_instrs</span><span class="p">:</span>
                <span class="n">dest</span><span class="o">.</span><span class="n">_update_parameter_table</span><span class="p">(</span><span class="n">instr</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">gate</span><span class="p">,</span> <span class="n">cals</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">calibrations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dest</span><span class="o">.</span><span class="n">_calibrations</span><span class="p">[</span><span class="n">gate</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cals</span><span class="p">)</span>

        <span class="n">dest</span><span class="o">.</span><span class="n">global_phase</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">global_phase</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">dest</span></div>

<div class="viewcode-block" id="QuantumCircuit.tensor"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.tensor.html#qiskit.circuit.QuantumCircuit.tensor">[文档]</a>    <span class="k">def</span> <span class="nf">tensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Tensor ``self`` with ``other``.</span>

<span class="sd">        Remember that in the little-endian convention the leftmost operation will be at the bottom</span>
<span class="sd">        of the circuit. See also</span>
<span class="sd">        [the docs](qiskit.org/documentation/tutorials/circuits/3_summary_of_quantum_operations.html)</span>
<span class="sd">        for more information.</span>

<span class="sd">        .. parsed-literal::</span>

<span class="sd">                 ┌────────┐        ┌─────┐          ┌─────┐</span>
<span class="sd">            q_0: ┤ bottom ├ ⊗ q_0: ┤ top ├  = q_0: ─┤ top ├──</span>
<span class="sd">                 └────────┘        └─────┘         ┌┴─────┴─┐</span>
<span class="sd">                                              q_1: ┤ bottom ├</span>
<span class="sd">                                                   └────────┘</span>

<span class="sd">        Args:</span>
<span class="sd">            other (QuantumCircuit): The other circuit to tensor this circuit with.</span>
<span class="sd">            inplace (bool): If True, modify the object. Otherwise return composed circuit.</span>

<span class="sd">        Examples:</span>

<span class="sd">            .. jupyter-execute::</span>

<span class="sd">                from qiskit import QuantumCircuit</span>
<span class="sd">                top = QuantumCircuit(1)</span>
<span class="sd">                top.x(0);</span>
<span class="sd">                bottom = QuantumCircuit(2)</span>
<span class="sd">                bottom.cry(0.2, 0, 1);</span>
<span class="sd">                tensored = bottom.tensor(top)</span>
<span class="sd">                print(tensored.draw())</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: The tensored circuit (returns None if inplace==True).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_qubits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">num_qubits</span>
        <span class="n">num_clbits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clbits</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">num_clbits</span>

        <span class="c1"># If a user defined both circuits with via register sizes and not with named registers</span>
        <span class="c1"># (e.g. QuantumCircuit(2, 2)) then we have a naming collision, as the registers are by</span>
        <span class="c1"># default called &quot;q&quot; resp. &quot;c&quot;. To still allow tensoring we define new registers of the</span>
        <span class="c1"># correct sizes.</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">qregs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">qregs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;q&quot;</span>
        <span class="p">):</span>
            <span class="c1"># check if classical registers are in the circuit</span>
            <span class="k">if</span> <span class="n">num_clbits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dest</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">num_clbits</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dest</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">)</span>

        <span class="c1"># handle case if ``measure_all`` was called on both circuits, in which case the</span>
        <span class="c1"># registers are both named &quot;meas&quot;</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">cregs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cregs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;meas&quot;</span>
        <span class="p">):</span>
            <span class="n">cr</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clbits</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">num_clbits</span><span class="p">,</span> <span class="s2">&quot;meas&quot;</span><span class="p">)</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>

        <span class="c1"># Now we don&#39;t have to handle any more cases arising from special implicit naming</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span>
                <span class="n">other</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span>
                <span class="n">other</span><span class="o">.</span><span class="n">clbits</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">,</span>
                <span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">,</span>
                <span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">cregs</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># compose self onto the output, and then other</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">num_clbits</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="nb">range</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">),</span>
            <span class="nb">range</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">num_clbits</span><span class="p">,</span> <span class="n">num_clbits</span><span class="p">),</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Replace information from tensored circuit into self when inplace = True</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dest</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">dest</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">qubits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of quantum bits in the order that the registers were added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qubits</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">clbits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of classical bits in the order that the registers were added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clbits</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ancillas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of ancilla bits in the order that the registers were added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ancillas</span>

    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.__add__() method is being deprecated.&quot;</span>
        <span class="s2">&quot;Use the compose() method which is more flexible w.r.t &quot;</span>
        <span class="s2">&quot;circuit register compatibility.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overload + to implement self.combine.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.__iadd__() method is being deprecated. Use the &quot;</span>
        <span class="s2">&quot;compose() (potentially with the inplace=True argument) and tensor() &quot;</span>
        <span class="s2">&quot;methods which are more flexible w.r.t circuit register compatibility.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overload += to implement self.extend.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overload &amp; to implement self.compose.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overload &amp;= to implement self.compose in place.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overload ^ to implement self.tensor.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ixor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overload ^= to implement self.tensor in place.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return number of operations in circuit.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return indexed operation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

<div class="viewcode-block" id="QuantumCircuit.cast"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cast.html#qiskit.circuit.QuantumCircuit.cast">[文档]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cast</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Best effort to cast value to type. Otherwise, returns the value.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">value</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_bit_argument_conversion</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">,</span> <span class="n">in_array</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">,</span> <span class="n">Bit</span><span class="p">):</span>
                <span class="c1"># circuit.h(qr[0]) -&gt; circuit.h([qr[0]])</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="n">bit_representation</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">,</span> <span class="n">Register</span><span class="p">):</span>
                <span class="c1"># circuit.h(qr) -&gt; circuit.h([qr[0], qr[1]])</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">bit_representation</span><span class="p">[:]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">QuantumCircuit</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">int</span><span class="p">):</span>
                <span class="c1"># circuit.h(0) -&gt; circuit.h([qr[0]])</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="n">in_array</span><span class="p">[</span><span class="n">bit_representation</span><span class="p">]]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="c1"># circuit.h(slice(0,2)) -&gt; circuit.h([qr[0], qr[1]])</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">in_array</span><span class="p">[</span><span class="n">bit_representation</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit</span><span class="p">,</span> <span class="n">Bit</span><span class="p">)</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bit_representation</span>
            <span class="p">):</span>
                <span class="c1"># circuit.h([qr[0], qr[1]]) -&gt; circuit.h([qr[0], qr[1]])</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">bit_representation</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">QuantumCircuit</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="c1"># circuit.h([0, 1])     -&gt; circuit.h([qr[0], qr[1]])</span>
                <span class="c1"># circuit.h(range(0,2)) -&gt; circuit.h([qr[0], qr[1]])</span>
                <span class="c1"># circuit.h([qr[0],1])  -&gt; circuit.h([qr[0], qr[1]])</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">index</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Bit</span><span class="p">)</span> <span class="k">else</span> <span class="n">in_array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">bit_representation</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Not able to expand a </span><span class="si">{</span><span class="n">bit_representation</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;Index out of range.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Type error handling </span><span class="si">{</span><span class="n">bit_representation</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">bit_representation</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>
        <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="QuantumCircuit.qbit_argument_conversion"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.qbit_argument_conversion.html#qiskit.circuit.QuantumCircuit.qbit_argument_conversion">[文档]</a>    <span class="k">def</span> <span class="nf">qbit_argument_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit_representation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts several qubit representations (such as indexes, range, etc.)</span>
<span class="sd">        into a list of qubits.</span>

<span class="sd">        Args:</span>
<span class="sd">            qubit_representation (Object): representation to expand</span>

<span class="sd">        Returns:</span>
<span class="sd">            List(tuple): Where each tuple is a qubit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">QuantumCircuit</span><span class="o">.</span><span class="n">_bit_argument_conversion</span><span class="p">(</span><span class="n">qubit_representation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.cbit_argument_conversion"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cbit_argument_conversion.html#qiskit.circuit.QuantumCircuit.cbit_argument_conversion">[文档]</a>    <span class="k">def</span> <span class="nf">cbit_argument_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clbit_representation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts several classical bit representations (such as indexes, range, etc.)</span>
<span class="sd">        into a list of classical bits.</span>

<span class="sd">        Args:</span>
<span class="sd">            clbit_representation (Object): representation to expand</span>

<span class="sd">        Returns:</span>
<span class="sd">            List(tuple): Where each tuple is a classical bit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">QuantumCircuit</span><span class="o">.</span><span class="n">_bit_argument_conversion</span><span class="p">(</span><span class="n">clbit_representation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.append"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.append.html#qiskit.circuit.QuantumCircuit.append">[文档]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instruction</span><span class="p">,</span> <span class="n">qargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append one or more instructions to the end of the circuit, modifying</span>
<span class="sd">        the circuit in place. Expands qargs and cargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            instruction (qiskit.circuit.Instruction): Instruction instance to append</span>
<span class="sd">            qargs (list(argument)): qubits to attach instruction to</span>
<span class="sd">            cargs (list(argument)): clbits to attach instruction to</span>

<span class="sd">        Returns:</span>
<span class="sd">            qiskit.circuit.Instruction: a handle to the instruction that was just added</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: if object passed is a subclass of Instruction</span>
<span class="sd">            CircuitError: if object passed is neither subclass nor an instance of Instruction</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert input to instruction</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">Instruction</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="s2">&quot;to_instruction&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">Instruction</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                    <span class="s2">&quot;Object is a subclass of Instruction, please add () to &quot;</span>
                    <span class="s2">&quot;pass an instance of this object.&quot;</span>
                <span class="p">)</span>

            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;Object to append must be an Instruction or &quot;</span> <span class="s2">&quot;have a to_instruction() method.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">Instruction</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="s2">&quot;to_instruction&quot;</span><span class="p">):</span>
            <span class="n">instruction</span> <span class="o">=</span> <span class="n">instruction</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>

        <span class="c1"># Make copy of parameterized gate instances</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">):</span>
            <span class="n">is_parameter</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">instruction</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_parameter</span><span class="p">:</span>
                <span class="n">instruction</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>

        <span class="n">expanded_qargs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">qbit_argument_conversion</span><span class="p">(</span><span class="n">qarg</span><span class="p">)</span> <span class="k">for</span> <span class="n">qarg</span> <span class="ow">in</span> <span class="n">qargs</span> <span class="ow">or</span> <span class="p">[]]</span>
        <span class="n">expanded_cargs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cbit_argument_conversion</span><span class="p">(</span><span class="n">carg</span><span class="p">)</span> <span class="k">for</span> <span class="n">carg</span> <span class="ow">in</span> <span class="n">cargs</span> <span class="ow">or</span> <span class="p">[]]</span>

        <span class="n">instructions</span> <span class="o">=</span> <span class="n">InstructionSet</span><span class="p">()</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="n">carg</span><span class="p">)</span> <span class="ow">in</span> <span class="n">instruction</span><span class="o">.</span><span class="n">broadcast_arguments</span><span class="p">(</span><span class="n">expanded_qargs</span><span class="p">,</span> <span class="n">expanded_cargs</span><span class="p">):</span>
            <span class="n">instructions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">qarg</span><span class="p">,</span> <span class="n">carg</span><span class="p">),</span> <span class="n">qarg</span><span class="p">,</span> <span class="n">carg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instructions</span></div>

    <span class="k">def</span> <span class="nf">_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instruction</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append an instruction to the end of the circuit, modifying</span>
<span class="sd">        the circuit in place.</span>

<span class="sd">        Args:</span>
<span class="sd">            instruction (Instruction or Operator): Instruction instance to append</span>
<span class="sd">            qargs (list(tuple)): qubits to attach instruction to</span>
<span class="sd">            cargs (list(tuple)): clbits to attach instruction to</span>

<span class="sd">        Returns:</span>
<span class="sd">            Instruction: a handle to the instruction that was just added</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: if the gate is of a different shape than the wires</span>
<span class="sd">                it is being attached to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">Instruction</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;object is not an Instruction.&quot;</span><span class="p">)</span>

        <span class="c1"># do some compatibility checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_dups</span><span class="p">(</span><span class="n">qargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_qargs</span><span class="p">(</span><span class="n">qargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_cargs</span><span class="p">(</span><span class="n">cargs</span><span class="p">)</span>

        <span class="c1"># add the instruction onto the given wires</span>
        <span class="n">instruction_context</span> <span class="o">=</span> <span class="n">instruction</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instruction_context</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_parameter_table</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>

        <span class="c1"># mark as normal circuit if a new instruction is added</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;dt&quot;</span>

        <span class="k">return</span> <span class="n">instruction</span>

    <span class="k">def</span> <span class="nf">_update_parameter_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instruction</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">param_index</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instruction</span><span class="o">.</span><span class="n">params</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">):</span>
                <span class="n">current_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span>

                <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">param</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">current_parameters</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_dup_param_spec</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">parameter</span><span class="p">],</span> <span class="n">instruction</span><span class="p">,</span> <span class="n">param_index</span>
                        <span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">instruction</span><span class="p">,</span> <span class="n">param_index</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="o">.</span><span class="n">get_names</span><span class="p">():</span>
                            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;Name conflict on adding parameter: </span><span class="si">{</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">param_index</span><span class="p">)]</span>

                        <span class="c1"># clear cache if new parameter is added</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">instruction</span>

    <span class="k">def</span> <span class="nf">_check_dup_param_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_spec_list</span><span class="p">,</span> <span class="n">instruction</span><span class="p">,</span> <span class="n">param_index</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">parameter_spec_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">instruction</span> <span class="ow">and</span> <span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">param_index</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="QuantumCircuit.add_register"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.add_register.html#qiskit.circuit.QuantumCircuit.add_register">[文档]</a>    <span class="k">def</span> <span class="nf">add_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">regs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add registers.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">regs</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regs</span><span class="p">):</span>
            <span class="c1"># QuantumCircuit defined without registers</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">regs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="c1"># QuantumCircuit with anonymous quantum wires e.g. QuantumCircuit(2)</span>
                <span class="n">regs</span> <span class="o">=</span> <span class="p">(</span><span class="n">QuantumRegister</span><span class="p">(</span><span class="n">regs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;q&quot;</span><span class="p">),)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regs</span><span class="p">):</span>
                <span class="c1"># QuantumCircuit with anonymous wires e.g. QuantumCircuit(2, 3)</span>
                <span class="n">regs</span> <span class="o">=</span> <span class="p">(</span><span class="n">QuantumRegister</span><span class="p">(</span><span class="n">regs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;q&quot;</span><span class="p">),</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">regs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;c&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                    <span class="s2">&quot;QuantumCircuit parameters can be Registers or Integers.&quot;</span>
                    <span class="s2">&quot; If Integers, up to 2 arguments. QuantumCircuit was called&quot;</span>
                    <span class="s2">&quot; with </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">regs</span><span class="p">,)</span>
                <span class="p">)</span>

        <span class="k">for</span> <span class="n">register</span> <span class="ow">in</span> <span class="n">regs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">Register</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">register</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">reg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s1">&#39;register name &quot;</span><span class="si">%s</span><span class="s1">&quot; already exists&#39;</span> <span class="o">%</span> <span class="n">register</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">AncillaRegister</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ancillas</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">QuantumRegister</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
                <span class="n">new_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">bit</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">register</span> <span class="k">if</span> <span class="n">bit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qubit_set</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_bits</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qubit_set</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_bits</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">ClassicalRegister</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
                <span class="n">new_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">bit</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">register</span> <span class="k">if</span> <span class="n">bit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clbit_set</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clbits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_bits</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clbit_set</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_bits</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_bits</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;expected a register&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.add_bits"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.add_bits.html#qiskit.circuit.QuantumCircuit.add_bits">[文档]</a>    <span class="k">def</span> <span class="nf">add_bits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bits</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Bits to the circuit.&quot;&quot;&quot;</span>
        <span class="n">duplicate_bits</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">bits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">duplicate_bits</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                <span class="s2">&quot;Attempted to add bits found already in circuit: &quot;</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">duplicate_bits</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bits</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit</span><span class="p">,</span> <span class="n">AncillaQubit</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ancillas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit</span><span class="p">,</span> <span class="n">Qubit</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qubits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qubit_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit</span><span class="p">,</span> <span class="n">Clbit</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clbits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clbit_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                    <span class="s2">&quot;Expected an instance of Qubit, Clbit, or &quot;</span>
                    <span class="s2">&quot;AncillaQubit, but was passed </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>
                <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_dups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubits</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raise exception if list of qubits contains duplicates.&quot;&quot;&quot;</span>
        <span class="n">squbits</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">qubits</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">squbits</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qubits</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;duplicate qubit arguments&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_qargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raise exception if a qarg is not in this circuit or bad format.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Qubit</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">qargs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;qarg is not a Qubit&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">qargs</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_qubit_set</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;qargs not in this circuit&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_cargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raise exception if clbit is not in this circuit or bad format.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Clbit</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cargs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;carg is not a Clbit&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">cargs</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clbit_set</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span><span class="s2">&quot;cargs not in this circuit&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="QuantumCircuit.to_instruction"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.to_instruction.html#qiskit.circuit.QuantumCircuit.to_instruction">[文档]</a>    <span class="k">def</span> <span class="nf">to_instruction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an Instruction out of this circuit.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameter_map(dict): For parameterized circuits, a mapping from</span>
<span class="sd">               parameters in the circuit to parameters to be used in the</span>
<span class="sd">               instruction. If None, existing circuit parameters will also</span>
<span class="sd">               parameterize the instruction.</span>
<span class="sd">            label (str): Optional gate label.</span>

<span class="sd">        Returns:</span>
<span class="sd">            qiskit.circuit.Instruction: a composite instruction encapsulating this circuit</span>
<span class="sd">            (can be decomposed back)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">qiskit.converters.circuit_to_instruction</span> <span class="kn">import</span> <span class="n">circuit_to_instruction</span>

        <span class="k">return</span> <span class="n">circuit_to_instruction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_map</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.to_gate"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.to_gate.html#qiskit.circuit.QuantumCircuit.to_gate">[文档]</a>    <span class="k">def</span> <span class="nf">to_gate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Gate out of this circuit.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameter_map(dict): For parameterized circuits, a mapping from</span>
<span class="sd">               parameters in the circuit to parameters to be used in the</span>
<span class="sd">               gate. If None, existing circuit parameters will also</span>
<span class="sd">               parameterize the gate.</span>
<span class="sd">            label (str): Optional gate label.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Gate: a composite gate encapsulating this circuit</span>
<span class="sd">            (can be decomposed back)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">qiskit.converters.circuit_to_gate</span> <span class="kn">import</span> <span class="n">circuit_to_gate</span>

        <span class="k">return</span> <span class="n">circuit_to_gate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_map</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.decompose"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.decompose.html#qiskit.circuit.QuantumCircuit.decompose">[文档]</a>    <span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call a decomposition pass on this circuit,</span>
<span class="sd">        to decompose one level (shallow decompose).</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: a circuit one level decomposed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=cyclic-import</span>
        <span class="kn">from</span> <span class="nn">qiskit.transpiler.passes.basis.decompose</span> <span class="kn">import</span> <span class="n">Decompose</span>
        <span class="kn">from</span> <span class="nn">qiskit.converters.circuit_to_dag</span> <span class="kn">import</span> <span class="n">circuit_to_dag</span>
        <span class="kn">from</span> <span class="nn">qiskit.converters.dag_to_circuit</span> <span class="kn">import</span> <span class="n">dag_to_circuit</span>

        <span class="n">pass_</span> <span class="o">=</span> <span class="n">Decompose</span><span class="p">()</span>
        <span class="n">decomposed_dag</span> <span class="o">=</span> <span class="n">pass_</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circuit_to_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dag_to_circuit</span><span class="p">(</span><span class="n">decomposed_dag</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_compatible_regs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raise exception if the circuits are defined on incompatible registers&quot;&quot;&quot;</span>
        <span class="n">list1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span>
        <span class="n">list2</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">qregs</span> <span class="o">+</span> <span class="n">rhs</span><span class="o">.</span><span class="n">cregs</span>
        <span class="k">for</span> <span class="n">element1</span> <span class="ow">in</span> <span class="n">list1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">element2</span> <span class="ow">in</span> <span class="n">list2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">element2</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">element1</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">element1</span> <span class="o">!=</span> <span class="n">element2</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                            <span class="s2">&quot;circuits are not compatible:&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; registers </span><span class="si">{</span><span class="n">element1</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">element2</span><span class="si">}</span><span class="s2"> not compatible&quot;</span>
                        <span class="p">)</span>

<div class="viewcode-block" id="QuantumCircuit.qasm"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.qasm.html#qiskit.circuit.QuantumCircuit.qasm">[文档]</a>    <span class="k">def</span> <span class="nf">qasm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenQASM string.</span>

<span class="sd">        Args:</span>
<span class="sd">            formatted (bool): Return formatted Qasm string.</span>
<span class="sd">            filename (str): Save Qasm to file with name &#39;filename&#39;.</span>
<span class="sd">            encoding (str): Optionally specify the encoding to use for the</span>
<span class="sd">                output file if ``filename`` is specified. By default this is</span>
<span class="sd">                set to the system&#39;s default encoding (ie whatever</span>
<span class="sd">                ``locale.getpreferredencoding()`` returns) and can be set to</span>
<span class="sd">                any valid codec or alias from stdlib&#39;s</span>
<span class="sd">                `codec module &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`__</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: If formatted=False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            MissingOptionalLibraryError: If pygments is not installed and ``formatted`` is</span>
<span class="sd">                ``True``.</span>
<span class="sd">            QasmError: If circuit has free parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_parameters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">QasmError</span><span class="p">(</span><span class="s2">&quot;Cannot represent circuits with unbound parameters in OpenQASM 2.&quot;</span><span class="p">)</span>

        <span class="n">existing_gate_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;barrier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;reset&quot;</span><span class="p">,</span>
            <span class="s2">&quot;u3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;u2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;u1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">,</span>
            <span class="s2">&quot;u0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;u&quot;</span><span class="p">,</span>
            <span class="s2">&quot;p&quot;</span><span class="p">,</span>
            <span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="s2">&quot;y&quot;</span><span class="p">,</span>
            <span class="s2">&quot;z&quot;</span><span class="p">,</span>
            <span class="s2">&quot;h&quot;</span><span class="p">,</span>
            <span class="s2">&quot;s&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sdg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;t&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tdg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ry&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rz&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sxdg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cz&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cy&quot;</span><span class="p">,</span>
            <span class="s2">&quot;swap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ccx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cswap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;crx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cry&quot;</span><span class="p">,</span>
            <span class="s2">&quot;crz&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cu1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cu3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;csx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cu&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rxx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rzz&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rccx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rc3x&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c3x&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c3sx&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c4x&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">existing_composite_circuits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">string_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">string_temp</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_lib</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">register</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">:</span>
            <span class="n">string_temp</span> <span class="o">+=</span> <span class="n">register</span><span class="o">.</span><span class="n">qasm</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">register</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">:</span>
            <span class="n">string_temp</span> <span class="o">+=</span> <span class="n">register</span><span class="o">.</span><span class="n">qasm</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">qreg_bits</span> <span class="o">=</span> <span class="p">{</span><span class="n">bit</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">reg</span><span class="p">}</span>
        <span class="n">creg_bits</span> <span class="o">=</span> <span class="p">{</span><span class="n">bit</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">reg</span><span class="p">}</span>
        <span class="n">regless_qubits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">regless_clbits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span> <span class="o">!=</span> <span class="n">qreg_bits</span><span class="p">:</span>
            <span class="n">regless_qubits</span> <span class="o">=</span> <span class="p">[</span><span class="n">bit</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span> <span class="k">if</span> <span class="n">bit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">qreg_bits</span><span class="p">]</span>
            <span class="n">string_temp</span> <span class="o">+=</span> <span class="s2">&quot;qreg </span><span class="si">%s</span><span class="s2">[</span><span class="si">%d</span><span class="s2">];</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;regless&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regless_qubits</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span> <span class="o">!=</span> <span class="n">creg_bits</span><span class="p">:</span>
            <span class="n">regless_clbits</span> <span class="o">=</span> <span class="p">[</span><span class="n">bit</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span> <span class="k">if</span> <span class="n">bit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">creg_bits</span><span class="p">]</span>
            <span class="n">string_temp</span> <span class="o">+=</span> <span class="s2">&quot;creg </span><span class="si">%s</span><span class="s2">[</span><span class="si">%d</span><span class="s2">];</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;regless&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regless_clbits</span><span class="p">))</span>

        <span class="n">bit_labels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">bit</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">[</span><span class="si">%d</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">bit</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">bit_labels</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">bit</span><span class="p">:</span> <span class="s2">&quot;regless[</span><span class="si">%d</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">idx</span>
                <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="p">(</span><span class="n">regless_qubits</span><span class="p">,</span> <span class="n">regless_clbits</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">instruction</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">instruction</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span>
                <span class="n">qubit</span> <span class="o">=</span> <span class="n">qargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">clbit</span> <span class="o">=</span> <span class="n">cargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">string_temp</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">instruction</span><span class="o">.</span><span class="n">qasm</span><span class="p">(),</span>
                    <span class="n">bit_labels</span><span class="p">[</span><span class="n">qubit</span><span class="p">],</span>
                    <span class="n">bit_labels</span><span class="p">[</span><span class="n">clbit</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># decompose gate using definitions if they are not defined in OpenQASM2</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">instruction</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_gate_names</span>
                    <span class="ow">and</span> <span class="n">instruction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_composite_circuits</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="n">instruction</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span>
                        <span class="n">instruction</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">instruction</span> <span class="ow">in</span> <span class="n">existing_composite_circuits</span>
                    <span class="p">]:</span>
                        <span class="c1"># append instruction id to name to make it unique</span>
                        <span class="n">instruction</span><span class="o">.</span><span class="n">name</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

                    <span class="n">existing_composite_circuits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>
                    <span class="n">_add_sub_instruction_to_existing_composite_circuits</span><span class="p">(</span>
                        <span class="n">instruction</span><span class="p">,</span> <span class="n">existing_gate_names</span><span class="p">,</span> <span class="n">existing_composite_circuits</span>
                    <span class="p">)</span>

                <span class="c1"># Insert qasm representation of the original instruction</span>
                <span class="n">string_temp</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">instruction</span><span class="o">.</span><span class="n">qasm</span><span class="p">(),</span>
                    <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">bit_labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">qargs</span> <span class="o">+</span> <span class="n">cargs</span><span class="p">]),</span>
                <span class="p">)</span>

        <span class="c1"># insert gate definitions</span>
        <span class="n">string_temp</span> <span class="o">=</span> <span class="n">_insert_composite_gate_definition_qasm</span><span class="p">(</span>
            <span class="n">string_temp</span><span class="p">,</span> <span class="n">existing_composite_circuits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_lib</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string_temp</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">formatted</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">HAS_PYGMENTS</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MissingOptionalLibraryError</span><span class="p">(</span>
                    <span class="n">libname</span><span class="o">=</span><span class="s2">&quot;pygments&gt;2.4&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;formatted QASM output&quot;</span><span class="p">,</span>
                    <span class="n">pip_install</span><span class="o">=</span><span class="s2">&quot;pip install pygments&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">pygments</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span>
                <span class="n">string_temp</span><span class="p">,</span> <span class="n">OpenQASMLexer</span><span class="p">(),</span> <span class="n">Terminal256Formatter</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">QasmTerminalStyle</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string_temp</span></div>

<div class="viewcode-block" id="QuantumCircuit.draw"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.draw.html#qiskit.circuit.QuantumCircuit.draw">[文档]</a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot_barriers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">reverse_bits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">justify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vertical_compression</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
        <span class="n">idle_wires</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">cregbundle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw the quantum circuit. Use the output parameter to choose the drawing format:</span>

<span class="sd">        **text**: ASCII art TextDrawing that can be printed in the console.</span>

<span class="sd">        **matplotlib**: images with color rendered purely in Python.</span>

<span class="sd">        **latex**: high-quality images compiled via latex.</span>

<span class="sd">        **latex_source**: raw uncompiled latex output.</span>

<span class="sd">        Args:</span>
<span class="sd">            output (str): select the output method to use for drawing the circuit.</span>
<span class="sd">                Valid choices are ``text``, ``mpl``, ``latex``, ``latex_source``.</span>
<span class="sd">                By default the `text` drawer is used unless the user config file</span>
<span class="sd">                (usually ``~/.qiskit/settings.conf``) has an alternative backend set</span>
<span class="sd">                as the default. For example, ``circuit_drawer = latex``. If the output</span>
<span class="sd">                kwarg is set, that backend will always be used over the default in</span>
<span class="sd">                the user config file.</span>
<span class="sd">            scale (float): scale of image to draw (shrink if &lt; 1.0). Only used by</span>
<span class="sd">                the `mpl`, `latex` and `latex_source` outputs. Defaults to 1.0.</span>
<span class="sd">            filename (str): file path to save image to. Defaults to None.</span>
<span class="sd">            style (dict or str): dictionary of style or file name of style json file.</span>
<span class="sd">                This option is only used by the `mpl` or `latex` output type.</span>
<span class="sd">                If `style` is a str, it is used as the path to a json file</span>
<span class="sd">                which contains a style dict. The file will be opened, parsed, and</span>
<span class="sd">                then any style elements in the dict will replace the default values</span>
<span class="sd">                in the input dict. A file to be loaded must end in ``.json``, but</span>
<span class="sd">                the name entered here can omit ``.json``. For example,</span>
<span class="sd">                ``style=&#39;iqx.json&#39;`` or ``style=&#39;iqx&#39;``.</span>
<span class="sd">                If `style` is a dict and the ``&#39;name&#39;`` key is set, that name</span>
<span class="sd">                will be used to load a json file, followed by loading the other</span>
<span class="sd">                items in the style dict. For example, ``style={&#39;name&#39;: &#39;iqx&#39;}``.</span>
<span class="sd">                If `style` is not a str and `name` is not a key in the style dict,</span>
<span class="sd">                then the default value from the user config file (usually</span>
<span class="sd">                ``~/.qiskit/settings.conf``) will be used, for example,</span>
<span class="sd">                ``circuit_mpl_style = iqx``.</span>
<span class="sd">                If none of these are set, the `default` style will be used.</span>
<span class="sd">                The search path for style json files can be specified in the user</span>
<span class="sd">                config, for example,</span>
<span class="sd">                ``circuit_mpl_style_path = /home/user/styles:/home/user``.</span>
<span class="sd">                See: :class:`~qiskit.visualization.qcstyle.DefaultStyle` for more</span>
<span class="sd">                information on the contents.</span>
<span class="sd">            interactive (bool): when set to true, show the circuit in a new window</span>
<span class="sd">                (for `mpl` this depends on the matplotlib backend being used</span>
<span class="sd">                supporting this). Note when used with either the `text` or the</span>
<span class="sd">                `latex_source` output type this has no effect and will be silently</span>
<span class="sd">                ignored. Defaults to False.</span>
<span class="sd">            reverse_bits (bool): when set to True, reverse the bit order inside</span>
<span class="sd">                registers for the output visualization. Defaults to False.</span>
<span class="sd">            plot_barriers (bool): enable/disable drawing barriers in the output</span>
<span class="sd">                circuit. Defaults to True.</span>
<span class="sd">            justify (string): options are ``left``, ``right`` or ``none``. If</span>
<span class="sd">                anything else is supplied, it defaults to left justified. It refers</span>
<span class="sd">                to where gates should be placed in the output circuit if there is</span>
<span class="sd">                an option. ``none`` results in each gate being placed in its own</span>
<span class="sd">                column.</span>
<span class="sd">            vertical_compression (string): ``high``, ``medium`` or ``low``. It</span>
<span class="sd">                merges the lines generated by the `text` output so the drawing</span>
<span class="sd">                will take less vertical room.  Default is ``medium``. Only used by</span>
<span class="sd">                the `text` output, will be silently ignored otherwise.</span>
<span class="sd">            idle_wires (bool): include idle wires (wires with no circuit elements)</span>
<span class="sd">                in output visualization. Default is True.</span>
<span class="sd">            with_layout (bool): include layout information, with labels on the</span>
<span class="sd">                physical layout. Default is True.</span>
<span class="sd">            fold (int): sets pagination. It can be disabled using -1. In `text`,</span>
<span class="sd">                sets the length of the lines. This is useful when the drawing does</span>
<span class="sd">                not fit in the console. If None (default), it will try to guess the</span>
<span class="sd">                console width using ``shutil.get_terminal_size()``. However, if</span>
<span class="sd">                running in jupyter, the default line length is set to 80 characters.</span>
<span class="sd">                In `mpl`, it is the number of (visual) layers before folding.</span>
<span class="sd">                Default is 25.</span>
<span class="sd">            ax (matplotlib.axes.Axes): Only used by the `mpl` backend. An optional</span>
<span class="sd">                Axes object to be used for the visualization output. If none is</span>
<span class="sd">                specified, a new matplotlib Figure will be created and used.</span>
<span class="sd">                Additionally, if specified there will be no returned Figure since</span>
<span class="sd">                it is redundant.</span>
<span class="sd">            initial_state (bool): optional. Adds ``|0&gt;`` in the beginning of the wire.</span>
<span class="sd">                Default is False.</span>
<span class="sd">            cregbundle (bool): optional. If set True, bundle classical registers.</span>
<span class="sd">                Default is True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`TextDrawing` or :class:`matplotlib.figure` or :class:`PIL.Image` or</span>
<span class="sd">            :class:`str`:</span>

<span class="sd">            * `TextDrawing` (output=&#39;text&#39;)</span>
<span class="sd">                A drawing that can be printed as ascii art.</span>
<span class="sd">            * `matplotlib.figure.Figure` (output=&#39;mpl&#39;)</span>
<span class="sd">                A matplotlib figure object for the circuit diagram.</span>
<span class="sd">            * `PIL.Image` (output=&#39;latex&#39;)</span>
<span class="sd">                An in-memory representation of the image of the circuit diagram.</span>
<span class="sd">            * `str` (output=&#39;latex_source&#39;)</span>
<span class="sd">                The LaTeX source code for visualizing the circuit diagram.</span>

<span class="sd">        Raises:</span>
<span class="sd">            VisualizationError: when an invalid output method is selected</span>
<span class="sd">            ImportError: when the output methods requires non-installed libraries.</span>

<span class="sd">        Example:</span>
<span class="sd">            .. jupyter-execute::</span>

<span class="sd">                from qiskit import QuantumRegister, ClassicalRegister, QuantumCircuit</span>
<span class="sd">                from qiskit.tools.visualization import circuit_drawer</span>
<span class="sd">                q = QuantumRegister(1)</span>
<span class="sd">                c = ClassicalRegister(1)</span>
<span class="sd">                qc = QuantumCircuit(q, c)</span>
<span class="sd">                qc.h(q)</span>
<span class="sd">                qc.measure(q, c)</span>
<span class="sd">                qc.draw(output=&#39;mpl&#39;, style={&#39;backgroundcolor&#39;: &#39;#EEEEEE&#39;})</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># pylint: disable=cyclic-import</span>
        <span class="kn">from</span> <span class="nn">qiskit.visualization</span> <span class="kn">import</span> <span class="n">circuit_drawer</span>

        <span class="k">return</span> <span class="n">circuit_drawer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
            <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
            <span class="n">interactive</span><span class="o">=</span><span class="n">interactive</span><span class="p">,</span>
            <span class="n">plot_barriers</span><span class="o">=</span><span class="n">plot_barriers</span><span class="p">,</span>
            <span class="n">reverse_bits</span><span class="o">=</span><span class="n">reverse_bits</span><span class="p">,</span>
            <span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">,</span>
            <span class="n">vertical_compression</span><span class="o">=</span><span class="n">vertical_compression</span><span class="p">,</span>
            <span class="n">idle_wires</span><span class="o">=</span><span class="n">idle_wires</span><span class="p">,</span>
            <span class="n">with_layout</span><span class="o">=</span><span class="n">with_layout</span><span class="p">,</span>
            <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
            <span class="n">cregbundle</span><span class="o">=</span><span class="n">cregbundle</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.size"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.size.html#qiskit.circuit.QuantumCircuit.size">[文档]</a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns total number of gate operations in circuit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Total number of gate operations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gate_ops</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">instr</span><span class="o">.</span><span class="n">_directive</span><span class="p">:</span>
                <span class="n">gate_ops</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">gate_ops</span></div>

<div class="viewcode-block" id="QuantumCircuit.depth"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.depth.html#qiskit.circuit.QuantumCircuit.depth">[文档]</a>    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return circuit depth (i.e., length of critical path).</span>
<span class="sd">        This does not include compiler or simulator directives</span>
<span class="sd">        such as &#39;barrier&#39; or &#39;snapshot&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Depth of circuit.</span>

<span class="sd">        Notes:</span>
<span class="sd">            The circuit depth and the DAG depth need not be the</span>
<span class="sd">            same.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Assign each bit in the circuit a unique integer</span>
        <span class="c1"># to index into op_stack.</span>
        <span class="n">bit_indices</span> <span class="o">=</span> <span class="p">{</span><span class="n">bit</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)}</span>

        <span class="c1"># If no bits, return 0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bit_indices</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="c1"># A list that holds the height of each qubit</span>
        <span class="c1"># and classical bit.</span>
        <span class="n">op_stack</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">bit_indices</span><span class="p">)</span>

        <span class="c1"># Here we are playing a modified version of</span>
        <span class="c1"># Tetris where we stack gates, but multi-qubit</span>
        <span class="c1"># gates, or measurements have a block for each</span>
        <span class="c1"># qubit or cbit that are connected by a virtual</span>
        <span class="c1"># line so that they all stacked at the same depth.</span>
        <span class="c1"># Conditional gates act on all cbits in the register</span>
        <span class="c1"># they are conditioned on.</span>
        <span class="c1"># We treat barriers or snapshots different as</span>
        <span class="c1"># They are transpiler and simulator directives.</span>
        <span class="c1"># The max stack height is the circuit depth.</span>
        <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="n">levels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">reg_ints</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">reg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qargs</span> <span class="o">+</span> <span class="n">cargs</span><span class="p">):</span>
                <span class="c1"># Add to the stacks of the qubits and</span>
                <span class="c1"># cbits used in the gate.</span>
                <span class="n">reg_ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bit_indices</span><span class="p">[</span><span class="n">reg</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">instr</span><span class="o">.</span><span class="n">_directive</span><span class="p">:</span>
                    <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op_stack</span><span class="p">[</span><span class="n">reg_ints</span><span class="p">[</span><span class="n">ind</span><span class="p">]])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op_stack</span><span class="p">[</span><span class="n">reg_ints</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Assuming here that there is no conditional</span>
            <span class="c1"># snapshots or barriers ever.</span>
            <span class="k">if</span> <span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">:</span>
                <span class="c1"># Controls operate over all bits of a classical register</span>
                <span class="c1"># or over a single bit</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Clbit</span><span class="p">):</span>
                    <span class="n">condition_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition_bits</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">cbit</span> <span class="ow">in</span> <span class="n">condition_bits</span><span class="p">:</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">bit_indices</span><span class="p">[</span><span class="n">cbit</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reg_ints</span><span class="p">:</span>
                        <span class="n">reg_ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                        <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op_stack</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">max_level</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">reg_ints</span><span class="p">:</span>
                <span class="n">op_stack</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_level</span>

        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">op_stack</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.width"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.width.html#qiskit.circuit.QuantumCircuit.width">[文档]</a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return number of qubits plus clbits in circuit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Width of circuit.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_qubits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return number of qubits.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_ancillas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of ancilla qubits.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ancillas</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_clbits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return number of classical bits.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span>

<div class="viewcode-block" id="QuantumCircuit.count_ops"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.count_ops.html#qiskit.circuit.QuantumCircuit.count_ops">[文档]</a>    <span class="k">def</span> <span class="nf">count_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Count each operation kind in the circuit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            OrderedDict: a breakdown of how many operations of each kind, sorted by amount.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count_ops</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="n">count_ops</span><span class="p">[</span><span class="n">instr</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_ops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">count_ops</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span></div>

<div class="viewcode-block" id="QuantumCircuit.num_nonlocal_gates"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.num_nonlocal_gates.html#qiskit.circuit.QuantumCircuit.num_nonlocal_gates">[文档]</a>    <span class="k">def</span> <span class="nf">num_nonlocal_gates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return number of non-local gates (i.e. involving 2+ qubits).</span>

<span class="sd">        Conditional nonlocal gates are also included.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multi_qubit_gates</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">instr</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">instr</span><span class="o">.</span><span class="n">_directive</span><span class="p">:</span>
                <span class="n">multi_qubit_gates</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">multi_qubit_gates</span></div>

<div class="viewcode-block" id="QuantumCircuit.get_instructions"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.get_instructions.html#qiskit.circuit.QuantumCircuit.get_instructions">[文档]</a>    <span class="k">def</span> <span class="nf">get_instructions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get instructions matching name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of instruction to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list(tuple): list of (instruction, qargs, cargs).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">match</span> <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span></div>

<div class="viewcode-block" id="QuantumCircuit.num_connected_components"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.num_connected_components.html#qiskit.circuit.QuantumCircuit.num_connected_components">[文档]</a>    <span class="k">def</span> <span class="nf">num_connected_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitary_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;How many non-entangled subcircuits can the circuit be factored to.</span>

<span class="sd">        Args:</span>
<span class="sd">            unitary_only (bool): Compute only unitary part of graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of connected components in circuit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert registers to ints (as done in depth).</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span> <span class="k">if</span> <span class="n">unitary_only</span> <span class="k">else</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span>
        <span class="n">bit_indices</span> <span class="o">=</span> <span class="p">{</span><span class="n">bit</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bits</span><span class="p">)}</span>

        <span class="c1"># Start with each qubit or cbit being its own subgraph.</span>
        <span class="n">sub_graphs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">bit</span><span class="p">]</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bit_indices</span><span class="p">))]</span>

        <span class="n">num_sub_graphs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_graphs</span><span class="p">)</span>

        <span class="c1"># Here we are traversing the gates and looking to see</span>
        <span class="c1"># which of the sub_graphs the gate joins together.</span>
        <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">unitary_only</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">qargs</span>
                <span class="n">num_qargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">qargs</span> <span class="o">+</span> <span class="n">cargs</span>
                <span class="n">num_qargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">instr</span><span class="o">.</span><span class="n">condition</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">num_qargs</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">instr</span><span class="o">.</span><span class="n">_directive</span><span class="p">:</span>
                <span class="n">graphs_touched</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">num_touched</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="c1"># Controls necessarily join all the cbits in the</span>
                <span class="c1"># register that they use.</span>
                <span class="k">if</span> <span class="n">instr</span><span class="o">.</span><span class="n">condition</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">unitary_only</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Clbit</span><span class="p">):</span>
                        <span class="n">condition_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">condition_bits</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">condition_bits</span><span class="p">:</span>
                        <span class="n">idx</span> <span class="o">=</span> <span class="n">bit_indices</span><span class="p">[</span><span class="n">bit</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sub_graphs</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">sub_graphs</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                                <span class="n">graphs_touched</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                                <span class="k">break</span>

                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                    <span class="n">reg_int</span> <span class="o">=</span> <span class="n">bit_indices</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sub_graphs</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">reg_int</span> <span class="ow">in</span> <span class="n">sub_graphs</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graphs_touched</span><span class="p">:</span>
                                <span class="n">graphs_touched</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                                <span class="k">break</span>

                <span class="n">graphs_touched</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">graphs_touched</span><span class="p">))</span>
                <span class="n">num_touched</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">graphs_touched</span><span class="p">)</span>

                <span class="c1"># If the gate touches more than one subgraph</span>
                <span class="c1"># join those graphs together and return</span>
                <span class="c1"># reduced number of subgraphs</span>
                <span class="k">if</span> <span class="n">num_touched</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">connections</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">graphs_touched</span><span class="p">:</span>
                        <span class="n">connections</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sub_graphs</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                    <span class="n">_sub_graphs</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sub_graphs</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graphs_touched</span><span class="p">:</span>
                            <span class="n">_sub_graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_graphs</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                    <span class="n">_sub_graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">connections</span><span class="p">)</span>
                    <span class="n">sub_graphs</span> <span class="o">=</span> <span class="n">_sub_graphs</span>
                    <span class="n">num_sub_graphs</span> <span class="o">-=</span> <span class="n">num_touched</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="c1"># Cannot go lower than one so break</span>
            <span class="k">if</span> <span class="n">num_sub_graphs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">num_sub_graphs</span></div>

<div class="viewcode-block" id="QuantumCircuit.num_unitary_factors"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.num_unitary_factors.html#qiskit.circuit.QuantumCircuit.num_unitary_factors">[文档]</a>    <span class="k">def</span> <span class="nf">num_unitary_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of tensor factors in the unitary</span>
<span class="sd">        (quantum) part of the circuit only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_connected_components</span><span class="p">(</span><span class="n">unitary_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.num_tensor_factors"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.num_tensor_factors.html#qiskit.circuit.QuantumCircuit.num_tensor_factors">[文档]</a>    <span class="k">def</span> <span class="nf">num_tensor_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of tensor factors in the unitary</span>
<span class="sd">        (quantum) part of the circuit only.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This is here for backwards compatibility, and will be</span>
<span class="sd">            removed in a future release of Qiskit. You should call</span>
<span class="sd">            `num_unitary_factors` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_unitary_factors</span><span class="p">()</span></div>

<div class="viewcode-block" id="QuantumCircuit.copy"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.copy.html#qiskit.circuit.QuantumCircuit.copy">[文档]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the circuit.</span>

<span class="sd">        Args:</span>
<span class="sd">          name (str): name to be given to the copied circuit. If None, then the name stays the same</span>

<span class="sd">        Returns:</span>
<span class="sd">          QuantumCircuit: a deepcopy of the current circuit, with the specified name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cpy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># copy registers correctly, in copy.copy they are only copied via reference</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">qregs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">cregs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">_qubits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qubits</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">_clbits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clbits</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">_qubit_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qubit_set</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">_clbit_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clbit_set</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">instr_instances</span> <span class="o">=</span> <span class="p">{</span><span class="nb">id</span><span class="p">(</span><span class="n">instr</span><span class="p">):</span> <span class="n">instr</span> <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">}</span>

        <span class="n">instr_copies</span> <span class="o">=</span> <span class="p">{</span><span class="n">id_</span><span class="p">:</span> <span class="n">instr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">instr_instances</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">cpy</span><span class="o">.</span><span class="n">_parameter_table</span> <span class="o">=</span> <span class="n">ParameterTable</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">param</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">(</span><span class="n">instr_copies</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">instr</span><span class="p">)],</span> <span class="n">param_index</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">param_index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">cpy</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">instr_copies</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">inst</span><span class="p">)],</span> <span class="n">qargs</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">cargs</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">cargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
        <span class="p">]</span>

        <span class="n">cpy</span><span class="o">.</span><span class="n">_calibrations</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calibrations</span><span class="p">)</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">cpy</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">cpy</span></div>

    <span class="k">def</span> <span class="nf">_create_creg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a creg, checking if ClassicalRegister with same name exists&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">creg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">creg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cregs</span><span class="p">]:</span>
            <span class="n">save_prefix</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="o">.</span><span class="n">prefix</span>
            <span class="n">ClassicalRegister</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">name</span>
            <span class="n">new_creg</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
            <span class="n">ClassicalRegister</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">save_prefix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_creg</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_creg</span>

    <span class="k">def</span> <span class="nf">_create_qreg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a qreg, checking if QuantumRegister with same name exists&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">qreg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">qreg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qregs</span><span class="p">]:</span>
            <span class="n">save_prefix</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="o">.</span><span class="n">prefix</span>
            <span class="n">QuantumRegister</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">name</span>
            <span class="n">new_qreg</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
            <span class="n">QuantumRegister</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">save_prefix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_qreg</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_qreg</span>

<div class="viewcode-block" id="QuantumCircuit.measure_active"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.measure_active.html#qiskit.circuit.QuantumCircuit.measure_active">[文档]</a>    <span class="k">def</span> <span class="nf">measure_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds measurement to all non-idle qubits. Creates a new ClassicalRegister with</span>
<span class="sd">        a size equal to the number of non-idle qubits being measured.</span>

<span class="sd">        Returns a new circuit with measurements if `inplace=False`.</span>

<span class="sd">        Args:</span>
<span class="sd">            inplace (bool): All measurements inplace or return new circuit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: Returns circuit with measurements when `inplace = False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">qiskit.converters.circuit_to_dag</span> <span class="kn">import</span> <span class="n">circuit_to_dag</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">dag</span> <span class="o">=</span> <span class="n">circuit_to_dag</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
        <span class="n">qubits_to_measure</span> <span class="o">=</span> <span class="p">[</span><span class="n">qubit</span> <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="n">circ</span><span class="o">.</span><span class="n">qubits</span> <span class="k">if</span> <span class="n">qubit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dag</span><span class="o">.</span><span class="n">idle_wires</span><span class="p">()]</span>
        <span class="n">new_creg</span> <span class="o">=</span> <span class="n">circ</span><span class="o">.</span><span class="n">_create_creg</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qubits_to_measure</span><span class="p">),</span> <span class="s2">&quot;measure&quot;</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">new_creg</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qubits_to_measure</span><span class="p">,</span> <span class="n">new_creg</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">circ</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="QuantumCircuit.measure_all"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.measure_all.html#qiskit.circuit.QuantumCircuit.measure_all">[文档]</a>    <span class="k">def</span> <span class="nf">measure_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds measurement to all qubits. Creates a new ClassicalRegister with a</span>
<span class="sd">        size equal to the number of qubits being measured.</span>

<span class="sd">        Returns a new circuit with measurements if `inplace=False`.</span>

<span class="sd">        Args:</span>
<span class="sd">            inplace (bool): All measurements inplace or return new circuit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: Returns circuit with measurements when `inplace = False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">new_creg</span> <span class="o">=</span> <span class="n">circ</span><span class="o">.</span><span class="n">_create_creg</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">circ</span><span class="o">.</span><span class="n">qubits</span><span class="p">),</span> <span class="s2">&quot;meas&quot;</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">new_creg</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">circ</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="n">new_creg</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">circ</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="QuantumCircuit.remove_final_measurements"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.remove_final_measurements.html#qiskit.circuit.QuantumCircuit.remove_final_measurements">[文档]</a>    <span class="k">def</span> <span class="nf">remove_final_measurements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes final measurement on all qubits if they are present.</span>
<span class="sd">        Deletes the ClassicalRegister that was used to store the values from these measurements</span>
<span class="sd">        if it is idle.</span>

<span class="sd">        Returns a new circuit without measurements if `inplace=False`.</span>

<span class="sd">        Args:</span>
<span class="sd">            inplace (bool): All measurements removed inplace or return new circuit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: Returns circuit with measurements removed when `inplace = False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=cyclic-import</span>
        <span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">RemoveFinalMeasurements</span>
        <span class="kn">from</span> <span class="nn">qiskit.converters</span> <span class="kn">import</span> <span class="n">circuit_to_dag</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">dag</span> <span class="o">=</span> <span class="n">circuit_to_dag</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
        <span class="n">remove_final_meas</span> <span class="o">=</span> <span class="n">RemoveFinalMeasurements</span><span class="p">()</span>
        <span class="n">new_dag</span> <span class="o">=</span> <span class="n">remove_final_meas</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dag</span><span class="p">)</span>

        <span class="c1"># Set circ cregs and instructions to match the new DAGCircuit&#39;s</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">_parameter_table</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">cregs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_dag</span><span class="o">.</span><span class="n">cregs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">new_dag</span><span class="o">.</span><span class="n">topological_op_nodes</span><span class="p">():</span>
            <span class="c1"># Get arguments for classical condition (if any)</span>
            <span class="n">inst</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">circ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">qargs</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">cargs</span><span class="p">)</span>

        <span class="n">circ</span><span class="o">.</span><span class="n">clbits</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">circ</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="QuantumCircuit.from_qasm_file"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.from_qasm_file.html#qiskit.circuit.QuantumCircuit.from_qasm_file">[文档]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_qasm_file</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Take in a QASM file and generate a QuantumCircuit object.</span>

<span class="sd">        Args:</span>
<span class="sd">          path (str): Path to the file for a QASM program</span>
<span class="sd">        Return:</span>
<span class="sd">          QuantumCircuit: The QuantumCircuit object for the input QASM</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qasm</span> <span class="o">=</span> <span class="n">Qasm</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_circuit_from_qasm</span><span class="p">(</span><span class="n">qasm</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.from_qasm_str"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.from_qasm_str.html#qiskit.circuit.QuantumCircuit.from_qasm_str">[文档]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_qasm_str</span><span class="p">(</span><span class="n">qasm_str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Take in a QASM string and generate a QuantumCircuit object.</span>

<span class="sd">        Args:</span>
<span class="sd">          qasm_str (str): A QASM program string</span>
<span class="sd">        Return:</span>
<span class="sd">          QuantumCircuit: The QuantumCircuit object for the input QASM</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qasm</span> <span class="o">=</span> <span class="n">Qasm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">qasm_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_circuit_from_qasm</span><span class="p">(</span><span class="n">qasm</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">global_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the global phase of the circuit in radians.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_phase</span>

    <span class="nd">@global_phase</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">global_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the phase of the circuit.</span>

<span class="sd">        Args:</span>
<span class="sd">            angle (float, ParameterExpression): radians</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="n">angle</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_global_phase</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Set the phase to the [0, 2π) interval</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">angle</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_global_phase</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_global_phase</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convenience function to get the parameters defined in the parameter table.&quot;&quot;&quot;</span>
        <span class="c1"># parameters from gates</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unsorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unsorted_parameters</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">unsorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">cmp_to_key</span><span class="p">(</span><span class="n">_compare_parameters</span><span class="p">))</span>

        <span class="c1"># return as parameter view, which implements the set and list interface</span>
        <span class="k">return</span> <span class="n">ParameterView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convenience function to get the number of parameter objects in the circuit.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unsorted_parameters</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_unsorted_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Efficiently get all parameters in the circuit, without any sorting overhead.&quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">):</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">parameters</span>

<div class="viewcode-block" id="QuantumCircuit.assign_parameters"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.assign_parameters.html#qiskit.circuit.QuantumCircuit.assign_parameters">[文档]</a>    <span class="nd">@deprecate_arguments</span><span class="p">({</span><span class="s2">&quot;param_dict&quot;</span><span class="p">:</span> <span class="s2">&quot;parameters&quot;</span><span class="p">})</span>
    <span class="k">def</span> <span class="nf">assign_parameters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">param_dict</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>  <span class="c1"># pylint: disable=unused-argument</span>
        <span class="sd">&quot;&quot;&quot;Assign parameters to new parameters or values.</span>

<span class="sd">        The keys of the parameter dictionary must be Parameter instances in the current circuit. The</span>
<span class="sd">        values of the dictionary can either be numeric values or new parameter objects.</span>
<span class="sd">        The values can be assigned to the current circuit object or to a copy of it.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameters (dict or iterable): Either a dictionary or iterable specifying the new</span>
<span class="sd">                parameter values. If a dict, it specifies the mapping from ``current_parameter`` to</span>
<span class="sd">                ``new_parameter``, where ``new_parameter`` can be a new parameter object or a</span>
<span class="sd">                numeric value. If an iterable, the elements are assigned to the existing parameters</span>
<span class="sd">                in the order they were inserted. You can call ``QuantumCircuit.parameters`` to check</span>
<span class="sd">                this order.</span>
<span class="sd">            inplace (bool): If False, a copy of the circuit with the bound parameters is</span>
<span class="sd">                returned. If True the circuit instance itself is modified.</span>
<span class="sd">            param_dict (dict): Deprecated, use ``parameters`` instead.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: If parameters is a dict and contains parameters not present in the</span>
<span class="sd">                circuit.</span>
<span class="sd">            ValueError: If parameters is a list/array and the length mismatches the number of free</span>
<span class="sd">                parameters in the circuit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional(QuantumCircuit): A copy of the circuit with bound parameters, if</span>
<span class="sd">            ``inplace`` is False, otherwise None.</span>

<span class="sd">        Examples:</span>

<span class="sd">            Create a parameterized circuit and assign the parameters in-place.</span>

<span class="sd">            .. jupyter-execute::</span>

<span class="sd">                from qiskit.circuit import QuantumCircuit, Parameter</span>

<span class="sd">                circuit = QuantumCircuit(2)</span>
<span class="sd">                params = [Parameter(&#39;A&#39;), Parameter(&#39;B&#39;), Parameter(&#39;C&#39;)]</span>
<span class="sd">                circuit.ry(params[0], 0)</span>
<span class="sd">                circuit.crx(params[1], 0, 1)</span>

<span class="sd">                print(&#39;Original circuit:&#39;)</span>
<span class="sd">                print(circuit.draw())</span>

<span class="sd">                circuit.assign_parameters({params[0]: params[2]}, inplace=True)</span>

<span class="sd">                print(&#39;Assigned in-place:&#39;)</span>
<span class="sd">                print(circuit.draw())</span>

<span class="sd">            Bind the values out-of-place and get a copy of the original circuit.</span>

<span class="sd">            .. jupyter-execute::</span>

<span class="sd">                from qiskit.circuit import QuantumCircuit, ParameterVector</span>

<span class="sd">                circuit = QuantumCircuit(2)</span>
<span class="sd">                params = ParameterVector(&#39;P&#39;, 2)</span>
<span class="sd">                circuit.ry(params[0], 0)</span>
<span class="sd">                circuit.crx(params[1], 0, 1)</span>

<span class="sd">                bound_circuit = circuit.assign_parameters({params[0]: 1, params[1]: 2})</span>
<span class="sd">                print(&#39;Bound circuit:&#39;)</span>
<span class="sd">                print(bound_circuit.draw())</span>

<span class="sd">                print(&#39;The original circuit is unchanged:&#39;)</span>
<span class="sd">                print(circuit.draw())</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># replace in self or in a copy depending on the value of in_place</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">bound_circuit</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bound_circuit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_increment_instances</span><span class="p">()</span>
            <span class="n">bound_circuit</span><span class="o">.</span><span class="n">_name_update</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># unroll the parameter dictionary (needed if e.g. it contains a ParameterVector)</span>
            <span class="n">unrolled_param_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unroll_param_dict</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
            <span class="n">unsorted_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unsorted_parameters</span><span class="p">()</span>

            <span class="c1"># check that all param_dict items are in the _parameter_table for this circuit</span>
            <span class="n">params_not_in_circuit</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">param_key</span>
                <span class="k">for</span> <span class="n">param_key</span> <span class="ow">in</span> <span class="n">unrolled_param_dict</span>
                <span class="k">if</span> <span class="n">param_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unsorted_parameters</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params_not_in_circuit</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot bind parameters (</span><span class="si">{}</span><span class="s2">) not present in the circuit.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">params_not_in_circuit</span><span class="p">))</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="c1"># replace the parameters with a new Parameter (&quot;substitute&quot;) or numeric value (&quot;bind&quot;)</span>
            <span class="k">for</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unrolled_param_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">bound_circuit</span><span class="o">.</span><span class="n">_assign_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_parameters</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Mismatching number of values and parameters. For partial binding &quot;</span>
                    <span class="s2">&quot;please pass a dictionary of {parameter: value} pairs.&quot;</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
                <span class="n">bound_circuit</span><span class="o">.</span><span class="n">_assign_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="n">bound_circuit</span></div>

<div class="viewcode-block" id="QuantumCircuit.bind_parameters"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.bind_parameters.html#qiskit.circuit.QuantumCircuit.bind_parameters">[文档]</a>    <span class="nd">@deprecate_arguments</span><span class="p">({</span><span class="s2">&quot;value_dict&quot;</span><span class="p">:</span> <span class="s2">&quot;values&quot;</span><span class="p">})</span>
    <span class="k">def</span> <span class="nf">bind_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">value_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># pylint: disable=unused-argument</span>
        <span class="sd">&quot;&quot;&quot;Assign numeric parameters to values yielding a new circuit.</span>

<span class="sd">        To assign new Parameter objects or bind the values in-place, without yielding a new</span>
<span class="sd">        circuit, use the :meth:`assign_parameters` method.</span>

<span class="sd">        Args:</span>
<span class="sd">            values (dict or iterable): {parameter: value, ...} or [value1, value2, ...]</span>
<span class="sd">            value_dict (dict): Deprecated, use ``values`` instead.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: If values is a dict and contains parameters not present in the circuit.</span>
<span class="sd">            TypeError: If values contains a ParameterExpression.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuantumCircuit: copy of self with assignment substitution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;Found ParameterExpression in values; use assign_parameters() instead.&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;Found ParameterExpression in values; use assign_parameters() instead.&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">(</span><span class="n">values</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_unroll_param_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_dict</span><span class="p">):</span>
        <span class="n">unrolled_value_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">value_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">ParameterVector</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                        <span class="s2">&quot;ParameterVector </span><span class="si">{}</span><span class="s2"> has length </span><span class="si">{}</span><span class="s2">, which &quot;</span>
                        <span class="s2">&quot;differs from value list </span><span class="si">{}</span><span class="s2"> of &quot;</span>
                        <span class="s2">&quot;len </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                    <span class="p">)</span>
                <span class="n">unrolled_value_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="c1"># pass anything else except number through. error checking is done in assign_parameter</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="p">(</span><span class="n">ParameterExpression</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span> <span class="ow">or</span> <span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">unrolled_value_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">unrolled_value_dict</span>

    <span class="k">def</span> <span class="nf">_assign_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update this circuit where instances of ``parameter`` are replaced by ``value``, which</span>
<span class="sd">        can be either a numeric value or a new parameter expression.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameter (ParameterExpression): Parameter to be bound</span>
<span class="sd">            value (Union(ParameterExpression, float, int)): A numeric or parametric expression to</span>
<span class="sd">                replace instances of ``parameter``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># parameter might be in global phase only</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">instr</span><span class="p">,</span> <span class="n">param_index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">parameter</span><span class="p">]:</span>
                <span class="n">new_param</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param_index</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="c1"># if fully bound, validate</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_param</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">instr</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">validate_parameter</span><span class="p">(</span><span class="n">new_param</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">instr</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_param</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_rebind_definition</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">):</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">new_parameter</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">new_parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">new_parameter</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">new_parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_table</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>  <span class="c1"># clear evaluated expressions</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="o">.</span><span class="n">parameters</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># clear parameter cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assign_calibration_parameters</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_assign_calibration_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update parameterized pulse gate calibrations, if there are any which contain</span>
<span class="sd">        ``parameter``. This updates the calibration mapping as well as the gate definition</span>
<span class="sd">        ``Schedule``s, which also may contain ``parameter``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">cals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">cal_params</span><span class="p">),</span> <span class="n">schedule</span> <span class="ow">in</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">cals</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">parameters</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">cal_params</span>
                <span class="p">):</span>
                    <span class="k">del</span> <span class="n">cals</span><span class="p">[(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">cal_params</span><span class="p">)]</span>
                    <span class="n">new_cal_params</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">cal_params</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                            <span class="n">new_param</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">new_param</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                                <span class="n">new_param</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_param</span><span class="p">)</span>
                            <span class="n">new_cal_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_param</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">new_cal_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="n">schedule</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">({</span><span class="n">parameter</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
                    <span class="n">cals</span><span class="p">[(</span><span class="n">qubit</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_cal_params</span><span class="p">))]</span> <span class="o">=</span> <span class="n">schedule</span>

    <span class="k">def</span> <span class="nf">_rebind_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instruction</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instruction</span><span class="o">.</span><span class="n">_definition</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">op</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">instruction</span><span class="o">.</span><span class="n">_definition</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">params</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">param</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ParameterExpression</span><span class="p">):</span>
                            <span class="n">op</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">parameter</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">op</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">bind</span><span class="p">({</span><span class="n">parameter</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_rebind_definition</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="QuantumCircuit.barrier"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.barrier.html#qiskit.circuit.QuantumCircuit.barrier">[文档]</a>    <span class="k">def</span> <span class="nf">barrier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">qargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.Barrier`. If qargs is None, applies to all.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.barrier</span> <span class="kn">import</span> <span class="n">Barrier</span>

        <span class="n">qubits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">qargs</span><span class="p">:</span>  <span class="c1"># None</span>
            <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">qarg</span> <span class="ow">in</span> <span class="n">qargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="n">QuantumRegister</span><span class="p">):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">qarg</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qarg</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">qarg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="nb">range</span><span class="p">):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">qarg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="n">qarg</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qarg</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Barrier</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qubits</span><span class="p">)),</span> <span class="n">qubits</span><span class="p">,</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.delay"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.delay.html#qiskit.circuit.QuantumCircuit.delay">[文档]</a>    <span class="k">def</span> <span class="nf">delay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">qarg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;dt&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.Delay`. If qarg is None, applies to all qubits.</span>
<span class="sd">        When applying to multiple qubits, delays with the same duration will be created.</span>

<span class="sd">        Args:</span>
<span class="sd">            duration (int or float or ParameterExpression): duration of the delay.</span>
<span class="sd">            qarg (Object): qubit argument to apply this delay.</span>
<span class="sd">            unit (str): unit of the duration. Supported units: &#39;s&#39;, &#39;ms&#39;, &#39;us&#39;, &#39;ns&#39;, &#39;ps&#39;, &#39;dt&#39;.</span>
<span class="sd">                Default is ``dt``, i.e. integer time unit depending on the target backend.</span>

<span class="sd">        Returns:</span>
<span class="sd">            qiskit.Instruction: the attached delay instruction.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: if arguments have bad format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qubits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">qarg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># -&gt; apply delays to all qubits</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">:</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="n">QuantumRegister</span><span class="p">):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">qarg</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qarg</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">qarg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">qarg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarg</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="n">qarg</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">qubits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qarg</span><span class="p">)</span>

        <span class="n">instructions</span> <span class="o">=</span> <span class="n">InstructionSet</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">:</span>
            <span class="n">inst</span> <span class="o">=</span> <span class="p">(</span><span class="n">Delay</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">unit</span><span class="p">),</span> <span class="p">[</span><span class="n">q</span><span class="p">],</span> <span class="p">[])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">*</span><span class="n">inst</span><span class="p">)</span>
            <span class="n">instructions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">inst</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instructions</span></div>

<div class="viewcode-block" id="QuantumCircuit.h"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.h.html#qiskit.circuit.QuantumCircuit.h">[文档]</a>    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.HGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.h</span> <span class="kn">import</span> <span class="n">HGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.ch"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.ch.html#qiskit.circuit.QuantumCircuit.ch">[文档]</a>    <span class="k">def</span> <span class="nf">ch</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control_qubit</span><span class="p">,</span>
        <span class="n">target_qubit</span><span class="p">,</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CHGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.h</span> <span class="kn">import</span> <span class="n">CHGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CHGate</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.i"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.i.html#qiskit.circuit.QuantumCircuit.i">[文档]</a>    <span class="k">def</span> <span class="nf">i</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.IGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.i</span> <span class="kn">import</span> <span class="n">IGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.id"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.id.html#qiskit.circuit.QuantumCircuit.id">[文档]</a>    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.IGate`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">qubit</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.ms"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.ms.html#qiskit.circuit.QuantumCircuit.ms">[文档]</a>    <span class="k">def</span> <span class="nf">ms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubits</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.MSGate`.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=cyclic-import</span>
        <span class="kn">from</span> <span class="nn">.library.generalized_gates.gms</span> <span class="kn">import</span> <span class="n">MSGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MSGate</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qubits</span><span class="p">),</span> <span class="n">theta</span><span class="p">),</span> <span class="n">qubits</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.p"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.p.html#qiskit.circuit.QuantumCircuit.p">[文档]</a>    <span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.PhaseGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.p</span> <span class="kn">import</span> <span class="n">PhaseGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PhaseGate</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cp"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cp.html#qiskit.circuit.QuantumCircuit.cp">[文档]</a>    <span class="k">def</span> <span class="nf">cp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CPhaseGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.p</span> <span class="kn">import</span> <span class="n">CPhaseGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CPhaseGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.mcp"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.mcp.html#qiskit.circuit.QuantumCircuit.mcp">[文档]</a>    <span class="k">def</span> <span class="nf">mcp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">control_qubits</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.MCPhaseGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.p</span> <span class="kn">import</span> <span class="n">MCPhaseGate</span>

        <span class="n">num_ctrl_qubits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_qubits</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">MCPhaseGate</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">num_ctrl_qubits</span><span class="p">),</span> <span class="n">control_qubits</span><span class="p">[:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.r"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.r.html#qiskit.circuit.QuantumCircuit.r">[文档]</a>    <span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.r</span> <span class="kn">import</span> <span class="n">RGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.rv"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rv.html#qiskit.circuit.QuantumCircuit.rv">[文档]</a>    <span class="k">def</span> <span class="nf">rv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RVGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.generalized_gates.rv</span> <span class="kn">import</span> <span class="n">RVGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RVGate</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.rccx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rccx.html#qiskit.circuit.QuantumCircuit.rccx">[文档]</a>    <span class="k">def</span> <span class="nf">rccx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit1</span><span class="p">,</span> <span class="n">control_qubit2</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RCCXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.x</span> <span class="kn">import</span> <span class="n">RCCXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RCCXGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">control_qubit1</span><span class="p">,</span> <span class="n">control_qubit2</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.rcccx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rcccx.html#qiskit.circuit.QuantumCircuit.rcccx">[文档]</a>    <span class="k">def</span> <span class="nf">rcccx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit1</span><span class="p">,</span> <span class="n">control_qubit2</span><span class="p">,</span> <span class="n">control_qubit3</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RC3XGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.x</span> <span class="kn">import</span> <span class="n">RC3XGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">RC3XGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">control_qubit1</span><span class="p">,</span> <span class="n">control_qubit2</span><span class="p">,</span> <span class="n">control_qubit3</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.rx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rx.html#qiskit.circuit.QuantumCircuit.rx">[文档]</a>    <span class="k">def</span> <span class="nf">rx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.rx</span> <span class="kn">import</span> <span class="n">RXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RXGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.crx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.crx.html#qiskit.circuit.QuantumCircuit.crx">[文档]</a>    <span class="k">def</span> <span class="nf">crx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CRXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.rx</span> <span class="kn">import</span> <span class="n">CRXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CRXGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.rxx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rxx.html#qiskit.circuit.QuantumCircuit.rxx">[文档]</a>    <span class="k">def</span> <span class="nf">rxx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RXXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.rxx</span> <span class="kn">import</span> <span class="n">RXXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RXXGate</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.ry"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.ry.html#qiskit.circuit.QuantumCircuit.ry">[文档]</a>    <span class="k">def</span> <span class="nf">ry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RYGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.ry</span> <span class="kn">import</span> <span class="n">RYGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RYGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cry"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cry.html#qiskit.circuit.QuantumCircuit.cry">[文档]</a>    <span class="k">def</span> <span class="nf">cry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CRYGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.ry</span> <span class="kn">import</span> <span class="n">CRYGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CRYGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.ryy"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.ryy.html#qiskit.circuit.QuantumCircuit.ryy">[文档]</a>    <span class="k">def</span> <span class="nf">ryy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RYYGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.ryy</span> <span class="kn">import</span> <span class="n">RYYGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RYYGate</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.rz"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rz.html#qiskit.circuit.QuantumCircuit.rz">[文档]</a>    <span class="k">def</span> <span class="nf">rz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RZGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.rz</span> <span class="kn">import</span> <span class="n">RZGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RZGate</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.crz"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.crz.html#qiskit.circuit.QuantumCircuit.crz">[文档]</a>    <span class="k">def</span> <span class="nf">crz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CRZGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.rz</span> <span class="kn">import</span> <span class="n">CRZGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CRZGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.rzx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rzx.html#qiskit.circuit.QuantumCircuit.rzx">[文档]</a>    <span class="k">def</span> <span class="nf">rzx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RZXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.rzx</span> <span class="kn">import</span> <span class="n">RZXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RZXGate</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.rzz"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.rzz.html#qiskit.circuit.QuantumCircuit.rzz">[文档]</a>    <span class="k">def</span> <span class="nf">rzz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.RZZGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.rzz</span> <span class="kn">import</span> <span class="n">RZZGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RZZGate</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.ecr"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.ecr.html#qiskit.circuit.QuantumCircuit.ecr">[文档]</a>    <span class="k">def</span> <span class="nf">ecr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.ECRGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.ecr</span> <span class="kn">import</span> <span class="n">ECRGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ECRGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.s"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.s.html#qiskit.circuit.QuantumCircuit.s">[文档]</a>    <span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.SGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.s</span> <span class="kn">import</span> <span class="n">SGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.sdg"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.sdg.html#qiskit.circuit.QuantumCircuit.sdg">[文档]</a>    <span class="k">def</span> <span class="nf">sdg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.SdgGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.s</span> <span class="kn">import</span> <span class="n">SdgGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SdgGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.swap"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.swap.html#qiskit.circuit.QuantumCircuit.swap">[文档]</a>    <span class="k">def</span> <span class="nf">swap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.SwapGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.swap</span> <span class="kn">import</span> <span class="n">SwapGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SwapGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.iswap"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.iswap.html#qiskit.circuit.QuantumCircuit.iswap">[文档]</a>    <span class="k">def</span> <span class="nf">iswap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.iSwapGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.iswap</span> <span class="kn">import</span> <span class="n">iSwapGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iSwapGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cswap"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cswap.html#qiskit.circuit.QuantumCircuit.cswap">[文档]</a>    <span class="k">def</span> <span class="nf">cswap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit1</span><span class="p">,</span> <span class="n">target_qubit2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CSwapGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.swap</span> <span class="kn">import</span> <span class="n">CSwapGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CSwapGate</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span>
            <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit1</span><span class="p">,</span> <span class="n">target_qubit2</span><span class="p">],</span>
            <span class="p">[],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.fredkin"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.fredkin.html#qiskit.circuit.QuantumCircuit.fredkin">[文档]</a>    <span class="k">def</span> <span class="nf">fredkin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit1</span><span class="p">,</span> <span class="n">target_qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CSwapGate`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cswap</span><span class="p">(</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit1</span><span class="p">,</span> <span class="n">target_qubit2</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.sx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.sx.html#qiskit.circuit.QuantumCircuit.sx">[文档]</a>    <span class="k">def</span> <span class="nf">sx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.SXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.sx</span> <span class="kn">import</span> <span class="n">SXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SXGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.sxdg"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.sxdg.html#qiskit.circuit.QuantumCircuit.sxdg">[文档]</a>    <span class="k">def</span> <span class="nf">sxdg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.SXdgGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.sx</span> <span class="kn">import</span> <span class="n">SXdgGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SXdgGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.csx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.csx.html#qiskit.circuit.QuantumCircuit.csx">[文档]</a>    <span class="k">def</span> <span class="nf">csx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CSXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.sx</span> <span class="kn">import</span> <span class="n">CSXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CSXGate</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span>
            <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span>
            <span class="p">[],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.t"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.t.html#qiskit.circuit.QuantumCircuit.t">[文档]</a>    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.TGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.t</span> <span class="kn">import</span> <span class="n">TGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.tdg"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.tdg.html#qiskit.circuit.QuantumCircuit.tdg">[文档]</a>    <span class="k">def</span> <span class="nf">tdg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.TdgGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.t</span> <span class="kn">import</span> <span class="n">TdgGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TdgGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.u"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.u.html#qiskit.circuit.QuantumCircuit.u">[文档]</a>    <span class="k">def</span> <span class="nf">u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.UGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u</span> <span class="kn">import</span> <span class="n">UGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">UGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cu"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cu.html#qiskit.circuit.QuantumCircuit.cu">[文档]</a>    <span class="k">def</span> <span class="nf">cu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CUGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u</span> <span class="kn">import</span> <span class="n">CUGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CUGate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span>
            <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span>
            <span class="p">[],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.u1"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.u1.html#qiskit.circuit.QuantumCircuit.u1">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.u1 method is deprecated as of &quot;</span>
        <span class="s2">&quot;0.16.0. It will be removed no earlier than 3 months &quot;</span>
        <span class="s2">&quot;after the release date. You should use the &quot;</span>
        <span class="s2">&quot;QuantumCircuit.p method instead, which acts &quot;</span>
        <span class="s2">&quot;identically.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">u1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.U1Gate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u1</span> <span class="kn">import</span> <span class="n">U1Gate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U1Gate</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cu1"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cu1.html#qiskit.circuit.QuantumCircuit.cu1">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.cu1 method is deprecated as of &quot;</span>
        <span class="s2">&quot;0.16.0. It will be removed no earlier than 3 months &quot;</span>
        <span class="s2">&quot;after the release date. You should use the &quot;</span>
        <span class="s2">&quot;QuantumCircuit.cp method instead, which acts &quot;</span>
        <span class="s2">&quot;identically.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">cu1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CU1Gate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u1</span> <span class="kn">import</span> <span class="n">CU1Gate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CU1Gate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.mcu1"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.mcu1.html#qiskit.circuit.QuantumCircuit.mcu1">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.mcu1 method is deprecated as of &quot;</span>
        <span class="s2">&quot;0.16.0. It will be removed no earlier than 3 months &quot;</span>
        <span class="s2">&quot;after the release date. You should use the &quot;</span>
        <span class="s2">&quot;QuantumCircuit.mcp method instead, which acts &quot;</span>
        <span class="s2">&quot;identically.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">mcu1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">control_qubits</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.MCU1Gate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u1</span> <span class="kn">import</span> <span class="n">MCU1Gate</span>

        <span class="n">num_ctrl_qubits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_qubits</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MCU1Gate</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">num_ctrl_qubits</span><span class="p">),</span> <span class="n">control_qubits</span><span class="p">[:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">target_qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.u2"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.u2.html#qiskit.circuit.QuantumCircuit.u2">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.u2 method is deprecated as of &quot;</span>
        <span class="s2">&quot;0.16.0. It will be removed no earlier than 3 months &quot;</span>
        <span class="s2">&quot;after the release date. You can use the general 1-&quot;</span>
        <span class="s2">&quot;qubit gate QuantumCircuit.u instead: u2(φ,λ) = &quot;</span>
        <span class="s2">&quot;u(π/2, φ, λ). Alternatively, you can decompose it in&quot;</span>
        <span class="s2">&quot;terms of QuantumCircuit.p and QuantumCircuit.sx: &quot;</span>
        <span class="s2">&quot;u2(φ,λ) = p(π/2+φ) sx p(λ-π/2) (1 pulse on hardware).&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">u2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.U2Gate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u2</span> <span class="kn">import</span> <span class="n">U2Gate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U2Gate</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.u3"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.u3.html#qiskit.circuit.QuantumCircuit.u3">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.u3 method is deprecated as of 0.16.0. It will be &quot;</span>
        <span class="s2">&quot;removed no earlier than 3 months after the release date. You should use &quot;</span>
        <span class="s2">&quot;QuantumCircuit.u instead, which acts identically. Alternatively, you can &quot;</span>
        <span class="s2">&quot;decompose u3 in terms of QuantumCircuit.p and QuantumCircuit.sx: &quot;</span>
        <span class="s2">&quot;u3(ϴ,φ,λ) = p(φ+π) sx p(ϴ+π) sx p(λ) (2 pulses on hardware).&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">u3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.U3Gate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u3</span> <span class="kn">import</span> <span class="n">U3Gate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U3Gate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cu3"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cu3.html#qiskit.circuit.QuantumCircuit.cu3">[文档]</a>    <span class="nd">@deprecate_function</span><span class="p">(</span>
        <span class="s2">&quot;The QuantumCircuit.cu3 method is deprecated as of 0.16.0. It will be &quot;</span>
        <span class="s2">&quot;removed no earlier than 3 months after the release date. You should &quot;</span>
        <span class="s2">&quot;use the QuantumCircuit.cu method instead, where &quot;</span>
        <span class="s2">&quot;cu3(ϴ,φ,λ) = cu(ϴ,φ,λ,0).&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">cu3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CU3Gate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.u3</span> <span class="kn">import</span> <span class="n">CU3Gate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CU3Gate</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span>
            <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span>
            <span class="p">[],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.x"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.x.html#qiskit.circuit.QuantumCircuit.x">[文档]</a>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.XGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.x</span> <span class="kn">import</span> <span class="n">XGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XGate</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cx.html#qiskit.circuit.QuantumCircuit.cx">[文档]</a>    <span class="k">def</span> <span class="nf">cx</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control_qubit</span><span class="p">,</span>
        <span class="n">target_qubit</span><span class="p">,</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.x</span> <span class="kn">import</span> <span class="n">CXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CXGate</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.cnot"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cnot.html#qiskit.circuit.QuantumCircuit.cnot">[文档]</a>    <span class="k">def</span> <span class="nf">cnot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CXGate`.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.dcx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.dcx.html#qiskit.circuit.QuantumCircuit.dcx">[文档]</a>    <span class="k">def</span> <span class="nf">dcx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.DCXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.dcx</span> <span class="kn">import</span> <span class="n">DCXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DCXGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit1</span><span class="p">,</span> <span class="n">qubit2</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.ccx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.ccx.html#qiskit.circuit.QuantumCircuit.ccx">[文档]</a>    <span class="k">def</span> <span class="nf">ccx</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control_qubit1</span><span class="p">,</span>
        <span class="n">control_qubit2</span><span class="p">,</span>
        <span class="n">target_qubit</span><span class="p">,</span>
        <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CCXGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.x</span> <span class="kn">import</span> <span class="n">CCXGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CCXGate</span><span class="p">(</span><span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span>
            <span class="p">[</span><span class="n">control_qubit1</span><span class="p">,</span> <span class="n">control_qubit2</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span>
            <span class="p">[],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.toffoli"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.toffoli.html#qiskit.circuit.QuantumCircuit.toffoli">[文档]</a>    <span class="k">def</span> <span class="nf">toffoli</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit1</span><span class="p">,</span> <span class="n">control_qubit2</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CCXGate`.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ccx</span><span class="p">(</span><span class="n">control_qubit1</span><span class="p">,</span> <span class="n">control_qubit2</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.mcx"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.mcx.html#qiskit.circuit.QuantumCircuit.mcx">[文档]</a>    <span class="k">def</span> <span class="nf">mcx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubits</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">ancilla_qubits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;noancilla&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.MCXGate`.</span>

<span class="sd">        The multi-cX gate can be implemented using different techniques, which use different numbers</span>
<span class="sd">        of ancilla qubits and have varying circuit depth. These modes are:</span>
<span class="sd">        - &#39;noancilla&#39;: Requires 0 ancilla qubits.</span>
<span class="sd">        - &#39;recursion&#39;: Requires 1 ancilla qubit if more than 4 controls are used, otherwise 0.</span>
<span class="sd">        - &#39;v-chain&#39;: Requires 2 less ancillas than the number of control qubits.</span>
<span class="sd">        - &#39;v-chain-dirty&#39;: Same as for the clean ancillas (but the circuit will be longer).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.x</span> <span class="kn">import</span> <span class="n">MCXGrayCode</span><span class="p">,</span> <span class="n">MCXRecursive</span><span class="p">,</span> <span class="n">MCXVChain</span>

        <span class="n">num_ctrl_qubits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_qubits</span><span class="p">)</span>

        <span class="n">available_implementations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;noancilla&quot;</span><span class="p">:</span> <span class="n">MCXGrayCode</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">),</span>
            <span class="s2">&quot;recursion&quot;</span><span class="p">:</span> <span class="n">MCXRecursive</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">),</span>
            <span class="s2">&quot;v-chain&quot;</span><span class="p">:</span> <span class="n">MCXVChain</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;v-chain-dirty&quot;</span><span class="p">:</span> <span class="n">MCXVChain</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">,</span> <span class="n">dirty_ancillas</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="c1"># outdated, previous names</span>
            <span class="s2">&quot;advanced&quot;</span><span class="p">:</span> <span class="n">MCXRecursive</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">),</span>
            <span class="s2">&quot;basic&quot;</span><span class="p">:</span> <span class="n">MCXVChain</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">,</span> <span class="n">dirty_ancillas</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;basic-dirty-ancilla&quot;</span><span class="p">:</span> <span class="n">MCXVChain</span><span class="p">(</span><span class="n">num_ctrl_qubits</span><span class="p">,</span> <span class="n">dirty_ancillas</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="c1"># check ancilla input</span>
        <span class="k">if</span> <span class="n">ancilla_qubits</span><span class="p">:</span>
            <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qbit_argument_conversion</span><span class="p">(</span><span class="n">ancilla_qubits</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">gate</span> <span class="o">=</span> <span class="n">available_implementations</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">all_modes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">available_implementations</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported mode (</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">) selected, choose one of </span><span class="si">{</span><span class="n">all_modes</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span> <span class="s2">&quot;num_ancilla_qubits&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">gate</span><span class="o">.</span><span class="n">num_ancilla_qubits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">required</span> <span class="o">=</span> <span class="n">gate</span><span class="o">.</span><span class="n">num_ancilla_qubits</span>
            <span class="k">if</span> <span class="n">ancilla_qubits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No ancillas provided, but </span><span class="si">{</span><span class="n">required</span><span class="si">}</span><span class="s2"> are needed!&quot;</span><span class="p">)</span>

            <span class="c1"># convert ancilla qubits to a list if they were passed as int or qubit</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ancilla_qubits</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
                <span class="n">ancilla_qubits</span> <span class="o">=</span> <span class="p">[</span><span class="n">ancilla_qubits</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ancilla_qubits</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">required</span><span class="p">:</span>
                <span class="n">actually</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ancilla_qubits</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;At least </span><span class="si">{</span><span class="n">required</span><span class="si">}</span><span class="s2"> ancillas required, but </span><span class="si">{</span><span class="n">actually</span><span class="si">}</span><span class="s2"> given.&quot;</span><span class="p">)</span>
            <span class="c1"># size down if too many ancillas were provided</span>
            <span class="n">ancilla_qubits</span> <span class="o">=</span> <span class="n">ancilla_qubits</span><span class="p">[:</span><span class="n">required</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ancilla_qubits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span> <span class="n">control_qubits</span><span class="p">[:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">target_qubit</span><span class="p">]</span> <span class="o">+</span> <span class="n">ancilla_qubits</span><span class="p">[:],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.mct"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.mct.html#qiskit.circuit.QuantumCircuit.mct">[文档]</a>    <span class="k">def</span> <span class="nf">mct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubits</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">ancilla_qubits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;noancilla&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.MCXGate`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcx</span><span class="p">(</span><span class="n">control_qubits</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">ancilla_qubits</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.y"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.y.html#qiskit.circuit.QuantumCircuit.y">[文档]</a>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.YGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.y</span> <span class="kn">import</span> <span class="n">YGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">YGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cy"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cy.html#qiskit.circuit.QuantumCircuit.cy">[文档]</a>    <span class="k">def</span> <span class="nf">cy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control_qubit</span><span class="p">,</span>
        <span class="n">target_qubit</span><span class="p">,</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CYGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.y</span> <span class="kn">import</span> <span class="n">CYGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CYGate</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.z"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.z.html#qiskit.circuit.QuantumCircuit.z">[文档]</a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.ZGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.z</span> <span class="kn">import</span> <span class="n">ZGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ZGate</span><span class="p">(),</span> <span class="p">[</span><span class="n">qubit</span><span class="p">],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.cz"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.cz.html#qiskit.circuit.QuantumCircuit.cz">[文档]</a>    <span class="k">def</span> <span class="nf">cz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.CZGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.library.standard_gates.z</span> <span class="kn">import</span> <span class="n">CZGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">CZGate</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ctrl_state</span><span class="o">=</span><span class="n">ctrl_state</span><span class="p">),</span> <span class="p">[</span><span class="n">control_qubit</span><span class="p">,</span> <span class="n">target_qubit</span><span class="p">],</span> <span class="p">[]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.pauli"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.pauli.html#qiskit.circuit.QuantumCircuit.pauli">[文档]</a>    <span class="k">def</span> <span class="nf">pauli</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pauli_string</span><span class="p">,</span> <span class="n">qubits</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply :class:`~qiskit.circuit.library.PauliGate`.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">qiskit.circuit.library.generalized_gates.pauli</span> <span class="kn">import</span> <span class="n">PauliGate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PauliGate</span><span class="p">(</span><span class="n">pauli_string</span><span class="p">),</span> <span class="n">qubits</span><span class="p">,</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="QuantumCircuit.add_calibration"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.add_calibration.html#qiskit.circuit.QuantumCircuit.add_calibration">[文档]</a>    <span class="k">def</span> <span class="nf">add_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gate</span><span class="p">,</span> <span class="n">qubits</span><span class="p">,</span> <span class="n">schedule</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Register a low-level, custom pulse definition for the given gate.</span>

<span class="sd">        Args:</span>
<span class="sd">            gate (Union[Gate, str]): Gate information.</span>
<span class="sd">            qubits (Union[int, Tuple[int]]): List of qubits to be measured.</span>
<span class="sd">            schedule (Schedule): Schedule information.</span>
<span class="sd">            params (Optional[List[Union[float, Parameter]]]): A list of parameters.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: if the gate is of type string and params is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span> <span class="n">Gate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calibrations</span><span class="p">[</span><span class="n">gate</span><span class="o">.</span><span class="n">name</span><span class="p">][(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">qubits</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">gate</span><span class="o">.</span><span class="n">params</span><span class="p">))]</span> <span class="o">=</span> <span class="n">schedule</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calibrations</span><span class="p">[</span><span class="n">gate</span><span class="p">][(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">qubits</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">params</span> <span class="ow">or</span> <span class="p">[]))]</span> <span class="o">=</span> <span class="n">schedule</span></div>

    <span class="c1"># Functions only for scheduled circuits</span>
<div class="viewcode-block" id="QuantumCircuit.qubit_duration"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.qubit_duration.html#qiskit.circuit.QuantumCircuit.qubit_duration">[文档]</a>    <span class="k">def</span> <span class="nf">qubit_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">qubits</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Qubit</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the duration between the start and stop time of the first and last instructions,</span>
<span class="sd">        excluding delays, over the supplied qubits. Its time unit is ``self.unit``.</span>

<span class="sd">        Args:</span>
<span class="sd">            *qubits: Qubits within ``self`` to include.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return the duration between the first start and last stop time of non-delay instructions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubit_stop_time</span><span class="p">(</span><span class="o">*</span><span class="n">qubits</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubit_start_time</span><span class="p">(</span><span class="o">*</span><span class="n">qubits</span><span class="p">)</span></div>

<div class="viewcode-block" id="QuantumCircuit.qubit_start_time"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.qubit_start_time.html#qiskit.circuit.QuantumCircuit.qubit_start_time">[文档]</a>    <span class="k">def</span> <span class="nf">qubit_start_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">qubits</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Qubit</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the start time of the first instruction, excluding delays,</span>
<span class="sd">        over the supplied qubits. Its time unit is ``self.unit``.</span>

<span class="sd">        Return 0 if there are no instructions over qubits</span>

<span class="sd">        Args:</span>
<span class="sd">            *qubits: Qubits within ``self`` to include. Integers are allowed for qubits, indicating</span>
<span class="sd">            indices of ``self.qubits``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return the start time of the first instruction, excluding delays, over the qubits</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: if ``self`` is a not-yet scheduled circuit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># circuit has only delays, this is kind of scheduled</span>
            <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">Delay</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                        <span class="s2">&quot;qubit_start_time undefined. &quot;</span> <span class="s2">&quot;Circuit must be scheduled first.&quot;</span>
                    <span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="n">qubits</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">q</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">]</span>

        <span class="n">starts</span> <span class="o">=</span> <span class="p">{</span><span class="n">q</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">}</span>
        <span class="n">dones</span> <span class="o">=</span> <span class="p">{</span><span class="n">q</span><span class="p">:</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qargs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">Delay</span><span class="p">):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">dones</span><span class="p">[</span><span class="n">q</span><span class="p">]:</span>
                            <span class="n">starts</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">+=</span> <span class="n">inst</span><span class="o">.</span><span class="n">duration</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dones</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qubits</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">([</span><span class="n">done</span> <span class="k">for</span> <span class="n">done</span> <span class="ow">in</span> <span class="n">dones</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">done</span><span class="p">]):</span>  <span class="c1"># all done</span>
                <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">start</span> <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">starts</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># If there are no instructions over bits</span></div>

<div class="viewcode-block" id="QuantumCircuit.qubit_stop_time"><a class="viewcode-back" href="../../../stubs/qiskit.circuit.QuantumCircuit.qubit_stop_time.html#qiskit.circuit.QuantumCircuit.qubit_stop_time">[文档]</a>    <span class="k">def</span> <span class="nf">qubit_stop_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">qubits</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Qubit</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the stop time of the last instruction, excluding delays, over the supplied qubits.</span>
<span class="sd">        Its time unit is ``self.unit``.</span>

<span class="sd">        Return 0 if there are no instructions over qubits</span>

<span class="sd">        Args:</span>
<span class="sd">            *qubits: Qubits within ``self`` to include. Integers are allowed for qubits, indicating</span>
<span class="sd">            indices of ``self.qubits``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return the stop time of the last instruction, excluding delays, over the qubits</span>

<span class="sd">        Raises:</span>
<span class="sd">            CircuitError: if ``self`` is a not-yet scheduled circuit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># circuit has only delays, this is kind of scheduled</span>
            <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">Delay</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">CircuitError</span><span class="p">(</span>
                        <span class="s2">&quot;qubit_stop_time undefined. &quot;</span> <span class="s2">&quot;Circuit must be scheduled first.&quot;</span>
                    <span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="n">qubits</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">q</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">]</span>

        <span class="n">stops</span> <span class="o">=</span> <span class="p">{</span><span class="n">q</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">}</span>
        <span class="n">dones</span> <span class="o">=</span> <span class="p">{</span><span class="n">q</span><span class="p">:</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qubits</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qargs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">Delay</span><span class="p">):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">dones</span><span class="p">[</span><span class="n">q</span><span class="p">]:</span>
                            <span class="n">stops</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">-=</span> <span class="n">inst</span><span class="o">.</span><span class="n">duration</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dones</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qubits</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">([</span><span class="n">done</span> <span class="k">for</span> <span class="n">done</span> <span class="ow">in</span> <span class="n">dones</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">done</span><span class="p">]):</span>  <span class="c1"># all done</span>
                <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">stop</span> <span class="k">for</span> <span class="n">stop</span> <span class="ow">in</span> <span class="n">stops</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># If there are no instructions over bits</span></div></div>


<span class="k">def</span> <span class="nf">_circuit_from_qasm</span><span class="p">(</span><span class="n">qasm</span><span class="p">):</span>
    <span class="c1"># pylint: disable=cyclic-import</span>
    <span class="kn">from</span> <span class="nn">qiskit.converters</span> <span class="kn">import</span> <span class="n">ast_to_dag</span>
    <span class="kn">from</span> <span class="nn">qiskit.converters</span> <span class="kn">import</span> <span class="n">dag_to_circuit</span>

    <span class="n">ast</span> <span class="o">=</span> <span class="n">qasm</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
    <span class="n">dag</span> <span class="o">=</span> <span class="n">ast_to_dag</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dag_to_circuit</span><span class="p">(</span><span class="n">dag</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_standard_compare</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value1</span> <span class="o">&lt;</span> <span class="n">value2</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">value1</span> <span class="o">&gt;</span> <span class="n">value2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">_compare_parameters</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">ParameterVectorElement</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param2</span><span class="p">,</span> <span class="n">ParameterVectorElement</span><span class="p">):</span>
        <span class="c1"># if they belong to a vector with the same name, sort by index</span>
        <span class="k">if</span> <span class="n">param1</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">param2</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_standard_compare</span><span class="p">(</span><span class="n">param1</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">param2</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># else sort by name</span>
    <span class="k">return</span> <span class="n">_standard_compare</span><span class="p">(</span><span class="n">param1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">param2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_add_sub_instruction_to_existing_composite_circuits</span><span class="p">(</span>
    <span class="n">instruction</span><span class="p">,</span> <span class="n">existing_gate_names</span><span class="p">,</span> <span class="n">existing_composite_circuits</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Recursively add undefined sub-instructions in the definition of the given</span>
<span class="sd">    instruction to existing_composite_circuit list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sub_instruction</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">instruction</span><span class="o">.</span><span class="n">definition</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">sub_instruction</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_gate_names</span>
            <span class="ow">and</span> <span class="n">sub_instruction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_composite_circuits</span>
        <span class="p">):</span>
            <span class="n">existing_composite_circuits</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sub_instruction</span><span class="p">)</span>
            <span class="n">_add_sub_instruction_to_existing_composite_circuits</span><span class="p">(</span>
                <span class="n">sub_instruction</span><span class="p">,</span> <span class="n">existing_gate_names</span><span class="p">,</span> <span class="n">existing_composite_circuits</span>
            <span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_composite_circuit_qasm_from_instruction</span><span class="p">(</span><span class="n">instruction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns OpenQASM string composite circuit given an instruction.</span>
<span class="sd">    The given instruction should be the result of composite_circuit.to_instruction().&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">instruction</span><span class="o">.</span><span class="n">definition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Instruction &quot;</span><span class="si">{</span><span class="n">instruction</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; is not defined.&#39;</span><span class="p">)</span>

    <span class="n">gate_parameters</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;param</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">instruction</span><span class="o">.</span><span class="n">params</span><span class="p">))])</span>
    <span class="n">qubit_parameters</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;q</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">instruction</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)])</span>
    <span class="n">composite_circuit_gates</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">definition</span> <span class="o">=</span> <span class="n">instruction</span><span class="o">.</span><span class="n">definition</span>
    <span class="n">definition_bit_labels</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">bit</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">bits</span> <span class="ow">in</span> <span class="p">(</span><span class="n">definition</span><span class="o">.</span><span class="n">qubits</span><span class="p">,</span> <span class="n">definition</span><span class="o">.</span><span class="n">clbits</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bits</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">sub_instruction</span><span class="p">,</span> <span class="n">qargs</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">definition</span><span class="p">:</span>
        <span class="n">gate_qargs</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;q</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="p">[</span><span class="n">definition_bit_labels</span><span class="p">[</span><span class="n">qubit</span><span class="p">]</span> <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="n">qargs</span><span class="p">]]</span>
        <span class="p">)</span>
        <span class="n">composite_circuit_gates</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">; &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sub_instruction</span><span class="o">.</span><span class="n">qasm</span><span class="p">(),</span> <span class="n">gate_qargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">composite_circuit_gates</span><span class="p">:</span>
        <span class="n">composite_circuit_gates</span> <span class="o">=</span> <span class="n">composite_circuit_gates</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gate_parameters</span><span class="p">:</span>
        <span class="n">qasm_string</span> <span class="o">=</span> <span class="s2">&quot;gate </span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">) </span><span class="si">%s</span><span class="s2"> { </span><span class="si">%s</span><span class="s2"> }&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">instruction</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">gate_parameters</span><span class="p">,</span>
            <span class="n">qubit_parameters</span><span class="p">,</span>
            <span class="n">composite_circuit_gates</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">qasm_string</span> <span class="o">=</span> <span class="s2">&quot;gate </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> { </span><span class="si">%s</span><span class="s2"> }&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">instruction</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">qubit_parameters</span><span class="p">,</span>
            <span class="n">composite_circuit_gates</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">qasm_string</span>


<span class="k">def</span> <span class="nf">_insert_composite_gate_definition_qasm</span><span class="p">(</span><span class="n">string_temp</span><span class="p">,</span> <span class="n">existing_composite_circuits</span><span class="p">,</span> <span class="n">extension_lib</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Insert composite gate definition QASM code right after extension library in the header&quot;&quot;&quot;</span>

    <span class="n">gate_definition_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># Generate gate definition string</span>
    <span class="k">for</span> <span class="n">instruction</span> <span class="ow">in</span> <span class="n">existing_composite_circuits</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="s2">&quot;_qasm_definition&quot;</span><span class="p">):</span>
            <span class="n">qasm_string</span> <span class="o">=</span> <span class="n">instruction</span><span class="o">.</span><span class="n">_qasm_definition</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qasm_string</span> <span class="o">=</span> <span class="n">_get_composite_circuit_qasm_from_instruction</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>
        <span class="n">gate_definition_string</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">qasm_string</span>

    <span class="n">string_temp</span> <span class="o">=</span> <span class="n">string_temp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="n">extension_lib</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">extension_lib</span><span class="p">,</span> <span class="n">gate_definition_string</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">string_temp</span>
</pre></div>

             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Qiskit Development Team.
      最后更新于 2021/10/02.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
         <script src="../../../_static/jquery.js"></script>
         <script src="../../../_static/underscore.js"></script>
         <script src="../../../_static/doctools.js"></script>
         <script src="../../../_static/language_data.js"></script>
         <script src="../../../_static/thebelab-helper.js"></script>
         <script src="../../../_static/translations.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
         <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
     

  

  <script type="text/javascript" src="../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="../../../getting_started.html">Getting Started</a>
          </li>
          <li>
            <a href="../../../tutorials.html">Tutorials</a>
          </li>
          <li>
            <a href="https://qiskit.org/documentation/partners/">Partners</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Applications
          </li>
          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.org/documentation/machine-learning/">Machine learning</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/nature/">Nature</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/finance/">Finance</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/optimization/">Optimization</a>
            </li>
          </ul>
          <br>
          <li>
            <a href="https://qiskit.org/documentation/experiments/">Experiments</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.slack.com">Slack support</a>
            </li>
          </ul>
          <br>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>