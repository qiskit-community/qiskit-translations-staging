


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="it-IT" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="it-IT" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Entanglement Verification &mdash; Qiskit 0.30.1 documentazione</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
    <link rel="index" title="Indice" href="../../genindex.html" />
    <link rel="search" title="Cerca" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting started</a>
          </li>

          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/partners/" target="_blank">Partners</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Applications
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/machine-learning/">
                  <span class="dropdown-title">Machine learning</span>
                  <p>QSVM, VQC (Variational Quantum Classifier), and QGAN (Quantum Generative
                    Adversarial Network) algorithms.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/nature/">
                  <span class="dropdown-title">Nature</span>
                  <p>Quantum applications in chemistry, physics, and biology.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/finance/">
                  <span class="dropdown-title">Finance</span>
                  <p>Uncertainty components for stock/securities problems, Ising translators for
                    portfolio optimizations and data providers to source real or random data.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/optimization/">
                  <span class="dropdown-title">Optimization</span>
                  <p>High-level optimization problems that are ready to
                    run on simulators and real quantum devices</p>
                </a>
              </div>
          </li>
          <li>
              <a href=="https://qiskit.org/documentation/experiments/" target="_blank">Experiments</a>
          </li>
          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.slack.com">
                  <span class="dropdown-title">Slack support</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/textbook">
                  <span class="dropdown-title">Qiskit Textbook</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/events">
                  <span class="dropdown-title">Qiskit events</span>
                  <p></p>
                </a>
            </div>
          </li>
          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">it_IT</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Linguaggi</dt>
      
        <dd><a class="version" href="/documentation/tutorials/noise/9_entanglement_verification.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/tutorials/noise/9_entanglement_verification.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/tutorials/noise/9_entanglement_verification.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/tutorials/noise/9_entanglement_verification.html">Korean</a></dd>
      
        <dd><a class="version" href="/documentation/locale/pt_BR/tutorials/noise/9_entanglement_verification.html">Portuguese, Brazilian</a></dd>
      
        <dd><a class="version" href="/documentation/locale/fr_FR/tutorials/noise/9_entanglement_verification.html">French</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ta_IN/tutorials/noise/9_entanglement_verification.html">Tamil</a></dd>
      
    </dl>
    
    <dl>
      <dt>Previous Releases</dt>
      
        <dd><a class="version" href="/documentation/stable/0.19/index.html">0.19</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.24/index.html">0.24</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.25/index.html">0.25</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.26/index.html">0.26</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.27/index.html">0.27</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.28/index.html">0.28</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.29/index.html">0.29</a></dd>
      
    </dl>
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Documentation Homepage</a></li>
</ul>
<p><span class="caption-text">Prefazione</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../qc_intro.html">Computazione quantistica «in a nutshell»</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_tutorial1.html">Introduction to Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_to_qiskit.html">Contribuire a Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Local Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Domande Frequenti</a></li>
</ul>
<p><span class="caption-text">Librerie</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/circuit_library.html">Circuit Library</a></li>
</ul>
<p><span class="caption-text">Riferimenti API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/terra.html">Qiskit Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aer.html">Qiskit Aer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ignis.html">Qiskit Ignis (deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aqua.html">Qiskit Aqua (deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ibmq-provider.html">Qiskit IBM Quantum Provider</a></li>
</ul>
<p><span class="caption-text">Qiskit Aqua Migration Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aqua_migration.html">Qiskit Aqua Migration Guide</a></li>
</ul>
<p><span class="caption-text">Risoluzione Dei Problemi</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/lab/docs/iql/manage/errors">Codici di Errore dell' API IBM Quantum</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Entanglement Verification</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/noise/9_entanglement_verification.ipynb" rel="nofollow"><img src="../../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content style-external-links">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>This page was generated from <a class="reference external" href="https://github.com/Qiskit/qiskit-tutorials/blob/master/tutorials/noise/9_entanglement_verification.ipynb">tutorials/noise/9_entanglement_verification.ipynb</a>.</p>
</div>
<section id="Entanglement-Verification">
<h1>Entanglement Verification<a class="headerlink" href="#Entanglement-Verification" title="Link a questa intestazione">¶</a></h1>
<section id="Introduction-to-the-GHZ-state">
<h2>Introduction to the GHZ state<a class="headerlink" href="#Introduction-to-the-GHZ-state" title="Link a questa intestazione">¶</a></h2>
<p><strong>The Greenberger-Horne-Zeilinger (GHZ)</strong> State is a <span class="math notranslate nohighlight">\(n\)</span>-qubit entangled state best defined by the following state vector:</p>
<div class="math notranslate nohighlight">
\[|{\rm GHZ} \rangle = \frac{|0 \rangle ^{\otimes n} + |1 \rangle ^{\otimes n}}{\sqrt{2}} , n &gt; 2\]</div>
<p>Characterization of the GHZ state is very useful in assessing multi-qubit interactions, whose robustness is key to developing large scale quantum computers.</p>
</section>
<section id="Characterizing-a-quantum-state">
<h2>Characterizing a quantum state<a class="headerlink" href="#Characterizing-a-quantum-state" title="Link a questa intestazione">¶</a></h2>
<p>Any mixed quantum state can be identified by a density matrix, defined as <span class="math notranslate nohighlight">\(\rho = \sum_{i} p_i |\psi_{i} \rangle \langle \psi_{i}|\)</span>, where <span class="math notranslate nohighlight">\(|\psi_{i} \rangle\)</span> are the pure quantum states forming the mixture and <span class="math notranslate nohighlight">\(0 &lt; p_i \le 1\)</span>, <span class="math notranslate nohighlight">\(\sum_{i} p_i = 1\)</span> are the classical probabilities to be in state <span class="math notranslate nohighlight">\(|\psi_{i} \rangle\)</span>. We denote the pure density matrix of an ideal GHZ State by <span class="math notranslate nohighlight">\(\rho_{p} \equiv |{\rm GHZ} \rangle \langle {\rm GHZ}|\)</span>. We want to see how close this
matrix is to the density matrix of a GHZ State as produced in an experiment, <span class="math notranslate nohighlight">\(\rho_{T}\)</span>. One method to quantify this similarity is to calculate the fidelity between the states, <span class="math notranslate nohighlight">\(F(\rho_{p},\rho_{T})\)</span></p>
<div class="math notranslate nohighlight">
\[F = \Big[ Tr \sqrt{\sqrt{\rho_{p}}\rho_{T}\sqrt{\rho_{p}}} \Big] ^{2}\]</div>
<p>The aim of this tutorial is two-fold: we will explore ways in which we can characterize the GHZ state, and ways in which we can use Ignis’ error mitigation tools to increase readout fidelity, regardless of characterization method</p>
<p>Before we go further, let us import everything we will need from basic Qiskit:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">IBMQ</span><span class="p">,</span> <span class="n">execute</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">QuantumRegister</span>
<span class="kn">from</span> <span class="nn">qiskit.tools.monitor</span> <span class="kn">import</span> <span class="n">job_monitor</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">Parameter</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">noise</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">quantum_info</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">visualization</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


</pre></div>
</div>
</div>
<p>The next two functions are from ignis. The first is for the general error mitigation technique, and the second is specifically for quantum tomography</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.mitigation.measurement</span> <span class="kn">import</span> <span class="p">(</span><span class="n">complete_meas_cal</span><span class="p">,</span> <span class="n">tensored_meas_cal</span><span class="p">,</span>
                                                 <span class="n">CompleteMeasFitter</span><span class="p">,</span> <span class="n">TensoredMeasFitter</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">state_tomography_circuits</span><span class="p">,</span> <span class="n">StateTomographyFitter</span>
</pre></div>
</div>
</div>
<p>The following import from the <code class="docutils literal notranslate"><span class="pre">entanglement</span></code> package contains information needed to create, parallelize and analyze GHZ State circuits</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.parallelize</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.linear</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.analysis</span> <span class="kn">import</span> <span class="n">Plotter</span>
</pre></div>
</div>
</div>
</section>
<section id="Preparing-a-GHZ-State">
<h2>Preparing a GHZ State<a class="headerlink" href="#Preparing-a-GHZ-State" title="Link a questa intestazione">¶</a></h2>
<p>Let us first go over how to prepare a GHZ State:</p>
<p>Say we have a system of <span class="math notranslate nohighlight">\(n\)</span> qubits, all prepared in the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state:</p>
<div class="math notranslate nohighlight">
\[|\psi \rangle = |00...0\rangle\]</div>
<p>We apply a Hadamard gate to the first qubit: <span class="math notranslate nohighlight">\(|0\rangle \longrightarrow \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle)\)</span>. Our state now looks like:</p>
<div class="math notranslate nohighlight">
\[|\psi \rangle = \frac{|00...0\rangle + |10...0\rangle}{\sqrt{2}}\]</div>
<p>Applying on this state a sequence of <span class="math notranslate nohighlight">\(n-1\)</span> CNOT gate between the <span class="math notranslate nohighlight">\(n^{th}\)</span> and <span class="math notranslate nohighlight">\((n+1)^{th}\)</span> qubits for <span class="math notranslate nohighlight">\(n = 0 \ldots n-1\)</span> leaves the <span class="math notranslate nohighlight">\(n+1\)</span> qubit at <span class="math notranslate nohighlight">\(|0\rangle\)</span> if the <span class="math notranslate nohighlight">\(n^{th}\)</span> is in <span class="math notranslate nohighlight">\(|0\rangle\)</span>, and at <span class="math notranslate nohighlight">\(|1\rangle\)</span> if the <span class="math notranslate nohighlight">\(n^{th}\)</span> is in <span class="math notranslate nohighlight">\(|1\rangle\)</span>, thus creating the GHZ State:</p>
<div class="math notranslate nohighlight">
\[|GHZ \rangle = \frac{|00...0\rangle + |11...1\rangle}{\sqrt{2}} \equiv \frac{|0 \rangle ^{\otimes n} + |1 \rangle ^{\otimes n}}{\sqrt{2}}\]</div>
<p>The following function creates this “linear” circuit that can measure the GHZ state:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#creating a 5 qubit GHZ state</span>
<span class="n">circ_simple</span> <span class="o">=</span> <span class="n">get_ghz_simple</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">measure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/computertreker/git/qiskit/qiskit-tutorial/release/lib/python3.9/site-packages/qiskit/ignis/verification/entanglement/linear.py:84: DeprecationWarning: The QuantumCircuit.__add__() method is being deprecated.Use the compose() method which is more flexible w.r.t circuit register compatibility.
  circ = circ + meas
/home/computertreker/git/qiskit/qiskit-tutorial/release/lib/python3.9/site-packages/qiskit/circuit/quantumcircuit.py:869: DeprecationWarning: The QuantumCircuit.combine() method is being deprecated. Use the compose() method which is more flexible w.r.t circuit register compatibility.
  return self.combine(rhs)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_simple</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_8_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_8_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_8_1.png" src="../../_images/tutorials_noise_9_entanglement_verification_8_1.png" />
</div>
</div>
</section>
<section id="Characterization,-Part-I">
<h2>Characterization, Part I<a class="headerlink" href="#Characterization,-Part-I" title="Link a questa intestazione">¶</a></h2>
<section id="Multiple-Quantum-Coherence-(MQC)">
<h3>Multiple Quantum Coherence (MQC)<a class="headerlink" href="#Multiple-Quantum-Coherence-(MQC)" title="Link a questa intestazione">¶</a></h3>
<p>Multiple Quantum Coherence (MQC) works by taking the preliminary preparation of an <span class="math notranslate nohighlight">\(n\)</span> qubit GHZ State, and rotating each of the qubit states around the z axis by a phase <span class="math notranslate nohighlight">\(\phi\)</span>. After that, we apply a X gate, i.e., a <span class="math notranslate nohighlight">\(\pi\)</span> pulse around the x axis. Then, we apply the inverse of the operations we originally applied to get the GHZ state. In an ideal situation the final state is <span class="math notranslate nohighlight">\(|\psi \rangle = \frac{|0 \rangle ^{\otimes n} + e^{i n \phi}|1 \rangle ^{\otimes n}}{\sqrt{2}}\)</span>.
We can ideally observe the phase collected by projecting <span class="math notranslate nohighlight">\(|\psi \rangle\)</span> onto the state <span class="math notranslate nohighlight">\(|0 \rangle ^{\otimes n}\)</span>. This technique is reminiscent of an echo sequence, and has been shown to substantially improve the fidelity during readout.</p>
<p>The function below creates a linear MQC circuit. As with every circuit from here on, you can change the <code class="docutils literal notranslate"><span class="pre">full_measurement</span></code> argument to toggle between full measurement of all qubits or measurement of only the control qubit. Full measurement yields the most accurate results, but for more than 7 qubits, it is recommended to set it to false, and observe only the oscillations between the <code class="docutils literal notranslate"><span class="pre">'0'</span></code> and <code class="docutils literal notranslate"><span class="pre">'1'</span></code> states.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_mqc</span> <span class="o">=</span> <span class="n">get_ghz_mqc_para</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span> <span class="n">full_measurement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/computertreker/git/qiskit/qiskit-tutorial/release/lib/python3.9/site-packages/qiskit/ignis/verification/entanglement/linear.py:142: DeprecationWarning: The QuantumCircuit.__iadd__() method is being deprecated. Use the compose() (potentially with the inplace=True argument) and tensor() methods which are more flexible w.r.t circuit register compatibility.
  circ += circinv
/home/computertreker/git/qiskit/qiskit-tutorial/release/lib/python3.9/site-packages/qiskit/circuit/quantumcircuit.py:876: DeprecationWarning: The QuantumCircuit.extend() method is being deprecated. Use the compose() (potentially with the inplace=True argument) and tensor() methods which are more flexible w.r.t circuit register compatibility.
  return self.extend(rhs)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_mqc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_11_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_11_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_11_1.png" src="../../_images/tutorials_noise_9_entanglement_verification_11_1.png" />
</div>
</div>
<p>After running experiments on this MQC circuit, we can pick a state to observe oscillations as we sweep <span class="math notranslate nohighlight">\(\phi\)</span> from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(2 \pi\)</span>. Our signal in theory should follow <span class="math notranslate nohighlight">\(S(\phi) = \frac{1}{2}(1+\cos(n \phi))\)</span>. We then perform a Discrete Fourier Transform (DFT: <span class="math notranslate nohighlight">\(I_{v}=(1/N)|\sum_{\phi}e^{iv\phi}S(\phi)\)</span>) to extract the Fidelity of the state, defined by the bounds <span class="math notranslate nohighlight">\(2\sqrt{I_{n}} \leq F \leq \sqrt{I_{0}/2}+ \sqrt{I_{n}}\)</span>; if desired, an actual value for the fidelity
can be obtained: <span class="math notranslate nohighlight">\(F = \frac{1}{2}(P_{00...0}+P_{11...1})+\sqrt{I_{n}})\)</span> (arXiv:1905.05720).</p>
</section>
<section id="Parity-Oscillations">
<h3>Parity Oscillations<a class="headerlink" href="#Parity-Oscillations" title="Link a questa intestazione">¶</a></h3>
<p>The next method we use to characterize the GHZ state is parity oscillations. After preparing a GHZ state, we apply a combination of rotations about the x and y axes to create various superposition states as a function of <span class="math notranslate nohighlight">\(\phi\)</span>: <span class="math notranslate nohighlight">\(U(\phi) = \otimes_{j}^{N} e^{i\frac{\pi}{4}(\cos(\phi)\sigma_{x}^{j}+\sin(\phi)\sigma_{y}^{j})}\)</span>. We then measure the expectation value <span class="math notranslate nohighlight">\(\langle \otimes_{j}^{N} \sigma_{z}^{j} \rangle_{\phi}\)</span> as a function of <span class="math notranslate nohighlight">\(\phi\)</span>, which in theory should lead
to parity oscillations between 1 and -1.</p>
<p>The following function generates a circuit which is the Parity Oscillation equivalent of the MQC circuit given above</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_po</span> <span class="o">=</span> <span class="n">get_ghz_po_para</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_po</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_15_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_15_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_15_1.png" src="../../_images/tutorials_noise_9_entanglement_verification_15_1.png" />
</div>
</div>
<p>We can obtain fidelity for parity oscillations <span class="math notranslate nohighlight">\(S_{\phi}\)</span> from <span class="math notranslate nohighlight">\(F = \frac{1}{2}(P_{00...0}+P_{11...1}+C)\)</span>, where <span class="math notranslate nohighlight">\(C\)</span>, the coherence is defined as <span class="math notranslate nohighlight">\(2\sqrt{I_{n}}\)</span>, following the same convention for the DFT as with the MQC method.</p>
</section>
<section id="Tomography">
<h3>Tomography<a class="headerlink" href="#Tomography" title="Link a questa intestazione">¶</a></h3>
<p>Tomography measures the density matrix by producing many nominally identical states and measuring the state instances in different bases. The ideal result of a GHZ state is four equal density matrix elements at the 4 corners of the tensor-product basis, with all other elements vanishing. Although the fidelity can be readily calculated by this method, the method is slow (requires exponential number of measurements in n), and takes prohibitively long times if n is larger than 7 or so.
Nevertheless, we will show below how to perform this method as it is relevant for small numbers of qubits.</p>
</section>
</section>
</section>
<section id="Parallelizing-circuits">
<h1>Parallelizing circuits<a class="headerlink" href="#Parallelizing-circuits" title="Link a questa intestazione">¶</a></h1>
<p>The above “linear” circuits are good to perform simulations, but what do we do when we use real devices, where the system can have an arbitrary topology and various errors? We are specifically targeting real hardware here, not just Aer simulation. One technique to reduce real-hardware effects is to parallelize the CNOT gates and thus create a shorter-depth circuit. This can be hugely beneficial efficiency wise, and fidelity wise. The class <code class="docutils literal notranslate"><span class="pre">BConfig</span></code> from the module <code class="docutils literal notranslate"><span class="pre">parallelize</span></code> does exactly
this.</p>
<p>First we must configure the optimal backend we want to use. We will consider a simulation backend, <code class="docutils literal notranslate"><span class="pre">'ibmq_qasm_simulator'</span></code>, disguised as a real device, <code class="docutils literal notranslate"><span class="pre">'ibmq_16_melbourne'</span></code> by using a the mock backend <code class="docutils literal notranslate"><span class="pre">'FakeMelbourne'</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">QasmSimulator</span>
<span class="kn">from</span> <span class="nn">qiskit.test.mock</span> <span class="kn">import</span> <span class="n">FakeMelbourne</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">QasmSimulator</span><span class="p">()</span>
<span class="n">backend_hardware</span> <span class="o">=</span> <span class="n">FakeMelbourne</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">noise</span></code> module, we can now define a noise model from <code class="docutils literal notranslate"><span class="pre">'ibmq_16_melbourne'</span></code> to “assign” to <code class="docutils literal notranslate"><span class="pre">'ibmq_qasm_simulator'</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">noise_model</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">NoiseModel</span><span class="o">.</span><span class="n">from_backend</span><span class="p">(</span><span class="n">backend_hardware</span><span class="p">)</span>
<span class="n">coupling_map</span> <span class="o">=</span> <span class="n">backend_hardware</span><span class="o">.</span><span class="n">_configuration</span><span class="o">.</span><span class="n">coupling_map</span>
<span class="n">basis_gates</span><span class="o">=</span><span class="n">noise_model</span><span class="o">.</span><span class="n">basis_gates</span>
</pre></div>
</div>
</div>
<p>And there we have it. From now on, in the tutorial, when using a real device, not a simulation, just take out every mention and assignment of <code class="docutils literal notranslate"><span class="pre">noise_model</span></code> and <code class="docutils literal notranslate"><span class="pre">coupling_map</span></code>, and assign the real device to <code class="docutils literal notranslate"><span class="pre">backend</span></code>. The simulator used from now on is no substitute for running a real device.</p>
<p><code class="docutils literal notranslate"><span class="pre">BConfig</span></code> lays the blueprint for creating parallelized circuits. Let us initialize an object taking in the real device we just defined, and name it <code class="docutils literal notranslate"><span class="pre">protocirc</span></code>. All of our experiments will use it:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">protocirc</span> <span class="o">=</span> <span class="n">BConfig</span><span class="p">(</span><span class="n">backend_hardware</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Error-Mitigation">
<h1>Error Mitigation<a class="headerlink" href="#Error-Mitigation" title="Link a questa intestazione">¶</a></h1>
<p>Qiskit Ignis provides very accurate tools to take raw data and return calibrated data. This is done by getting the raw data, in the form of a vector <span class="math notranslate nohighlight">\(v_{raw}\)</span> and getting a calibration matrix <span class="math notranslate nohighlight">\(A\)</span>. The output is then the solution to the optimization problem: <span class="math notranslate nohighlight">\(argmin_{v_{cal}} ||Av_{cal}-v_{raw}||^{2}\)</span></p>
</section>
<section id="Experiment-Time">
<h1>Experiment Time<a class="headerlink" href="#Experiment-Time" title="Link a questa intestazione">¶</a></h1>
<section id="Preliminary-Steps">
<h2>Preliminary Steps<a class="headerlink" href="#Preliminary-Steps" title="Link a questa intestazione">¶</a></h2>
<p>The probabilities of measuring <span class="math notranslate nohighlight">\(|0\rangle ^{\otimes n}\)</span> and <span class="math notranslate nohighlight">\(|1\rangle^{\otimes n}\)</span> in the GHZ state are important in calculating fidelity. For this, we need to run the following test</p>
<p>We begin by defining standard execution parameters:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span> <span class="c1">#numbers of shots in a given experiment</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#number of credits</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#number of qubits</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span> <span class="c1">#will help us easily define the state |00...00&gt;</span>
<span class="n">onecode</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="n">qn</span> <span class="c1">#will help us easily define the state |11...11&gt;</span>
<span class="n">sweep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="c1">#standard list of phase values we will sweep</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_simple</span><span class="p">,</span> <span class="n">qr</span><span class="p">,</span> <span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_simple</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">initial_layout</span><span class="p">)</span>
<span class="n">circ_simple</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{Qubit(QuantumRegister(5, &#39;q&#39;), 0): 1, Qubit(QuantumRegister(5, &#39;q&#39;), 1): 2, Qubit(QuantumRegister(5, &#39;q&#39;), 2): 0, Qubit(QuantumRegister(5, &#39;q&#39;), 3): 3, Qubit(QuantumRegister(5, &#39;q&#39;), 4): 13}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<pre style="word-wrap: normal;white-space: pre;background: #fff0;line-height: 1.1;font-family: &quot;Courier New&quot;,Courier,monospace">                       ░ ┌───┐ ░                             ░  ░       ┌─┐   »
 q_0: ─────────────────░─┤ X ├─░─────────────────────────────░──░───────┤M├───»
      ┌─────────┐      ░ └─┬─┘ ░ ┌─────────┐┌───┐┌─────────┐ ░  ░ ┌─┐   └╥┘   »
 q_1: ┤ U2(0,π) ├──■───░───■───░─┤ U2(0,π) ├┤ X ├┤ U2(0,π) ├─░──░─┤M├────╫────»
      └─────────┘┌─┴─┐ ░       ░ └─────────┘└─┬─┘└─────────┘ ░  ░ └╥┘┌─┐ ║    »
 q_2: ───────────┤ X ├─░───■───░──────────────┼──────────────░──░──╫─┤M├─╫────»
                 └───┘ ░ ┌─┴─┐ ░              │              ░  ░  ║ └╥┘ ║ ┌─┐»
 q_3: ─────────────────░─┤ X ├─░──────────────┼──────────────░──░──╫──╫──╫─┤M├»
                       ░ └───┘ ░              │              ░  ░  ║  ║  ║ └╥┘»
 q_4: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
 q_5: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
 q_6: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
 q_7: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
 q_8: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
 q_9: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
q_10: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
q_11: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                                              │                    ║  ║  ║  ║ »
q_12: ────────────────────────────────────────┼────────────────────╫──╫──╫──╫─»
                       ░       ░ ┌─────────┐  │  ┌─────────┐ ░  ░  ║  ║  ║  ║ »
q_13: ─────────────────░───────░─┤ U2(0,π) ├──■──┤ U2(0,π) ├─░──░──╫──╫──╫──╫─»
                       ░       ░ └─────────┘     └─────────┘ ░  ░  ║  ║  ║  ║ »
 c: 5/═════════════════════════════════════════════════════════════╩══╩══╩══╩═»
                                                                   0  1  2  3 »
«
« q_0: ───
«
« q_1: ───
«
« q_2: ───
«
« q_3: ───
«
« q_4: ───
«
« q_5: ───
«
« q_6: ───
«
« q_7: ───
«
« q_8: ───
«
« q_9: ───
«
«q_10: ───
«
«q_11: ───
«
«q_12: ───
«      ┌─┐
«q_13: ┤M├
«      └╥┘
« c: 5/═╩═
«       4 </pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_simple</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_simple</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">,</span><span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">)</span>
<span class="c1"># job_simple = execute(circ_simple, backend, shots=shots, max_credits=max_credits,noise_model=noise_model, coupling_map=coupling_map, basis_gates=basis_gates)</span>

<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_simple</span><span class="p">)</span>
<span class="n">result_simple</span> <span class="o">=</span> <span class="n">job_simple</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">P0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">zerocode</span><span class="p">]</span>
<span class="n">P1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">onecode</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|00...0&gt;) = &#39;</span><span class="p">,</span><span class="n">P0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|11...1&gt;) = &#39;</span><span class="p">,</span><span class="n">P1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
P(|00...0&gt;) =  0.4140625
P(|11...1&gt;) =  0.341796875
</pre></div></div>
</div>
<p>Now with error mitigation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs_simple</span><span class="p">,</span> <span class="n">state_labels_simple</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_simple_em</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs_simple</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                     <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_simple_em</span><span class="p">)</span>
<span class="n">meas_result</span> <span class="o">=</span> <span class="n">job_simple_em</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result</span><span class="p">,</span><span class="n">state_labels_simple</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="n">result_simple_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">result_simple</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_simple_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">zerocode</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.44859593996533753
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">P0_m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">zerocode</span><span class="p">]</span>
<span class="n">P1_m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">onecode</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|00...0&gt;) error mitigated = &#39;</span><span class="p">,</span><span class="n">P0_m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|11...1&gt;) error mitigated = &#39;</span><span class="p">,</span><span class="n">P1_m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
P(|00...0&gt;) error mitigated =  0.44859593996533753
P(|11...1&gt;) error mitigated =  0.4868663698086132
</pre></div></div>
</div>
<p>We will load these values in a dictionary for assessing fidelity later on:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;P0&#39;</span><span class="p">:</span> <span class="n">P0</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="n">P1</span><span class="p">,</span> <span class="s1">&#39;P0_m&#39;</span><span class="p">:</span> <span class="n">P0_m</span><span class="p">,</span> <span class="s1">&#39;P1_m&#39;</span><span class="p">:</span><span class="n">P1_m</span><span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="Part-1-:-MQC">
<h2>Part 1 : MQC<a class="headerlink" href="#Part-1-:-MQC" title="Link a questa intestazione">¶</a></h2>
<p>We now retrieve a parallelized MQC circuit for the n qubit device</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span> <span class="c1">#numbers of shots in a given experiment</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#number of credits</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#number of qubits</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span> <span class="c1">#will help us easily define the state |00...00&gt;</span>
<span class="n">sweep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="c1">#standard list of phase values we will sweep</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="n">circ</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span><span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_mqc_para</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">circ_total_mqc</span> <span class="o">=</span> <span class="p">[</span><span class="n">circ</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="n">t</span><span class="p">})</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sweep</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 1.87 s, sys: 16.3 ms, total: 1.89 s
Wall time: 1.89 s
</pre></div></div>
</div>
<p>We now execute the MQC experiment:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_exp_mqc</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_total_mqc</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">,</span>
                      <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span><span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_exp_mqc</span><span class="p">)</span>
<span class="n">result_exp_mqc</span> <span class="o">=</span> <span class="n">job_exp_mqc</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<p>Now we will plot the amount of counts measured for <span class="math notranslate nohighlight">\(|0 \rangle ^{\otimes n}\)</span> as a function of phase. It is important to note that when using a parametrized circuit like the one here, the method <code class="docutils literal notranslate"><span class="pre">get_counts()</span></code> accepts an <strong>index</strong> and not a <strong>circuit</strong>. In any other type of experiment, <code class="docutils literal notranslate"><span class="pre">get_counts()</span></code> accepts a <strong>circuit</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">zeros</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_exp_mqc</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="n">zerocode</span><span class="p">]</span> <span class="k">if</span>
          <span class="n">zerocode</span> <span class="ow">in</span> <span class="n">result_exp_mqc</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))</span> <span class="p">]</span> <span class="c1">#notice the important difference with proto2; takes only the index, not the actual circuit</span>
<span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;mqc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">zeros</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_47_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_47_0.png" />
</div>
</div>
<p>Now we get started on error mitigation. We create an identical quantum register and use complete_meas_cal from Ignis, to create circuits for calibrated measurements to be executed, and a calibration matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs_mqc</span><span class="p">,</span> <span class="n">state_labels_mqc</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span> <span class="c1">#from Ignis</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_cal_mqc</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs_mqc</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                     <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span><span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_cal_mqc</span><span class="p">)</span>
<span class="n">meas_result_mqc</span> <span class="o">=</span> <span class="n">job_cal_mqc</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter_mqc</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result_mqc</span><span class="p">,</span><span class="n">state_labels_mqc</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="c1"># print(meas_fitter.cal_matrix) #uncomment this to see how close the calibration matrix is to the calibration matrix</span>
</pre></div>
</div>
</div>
<p>Finally, we have our error mitigated results:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_exp_em</span> <span class="o">=</span> <span class="n">meas_fitter_mqc</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">result_exp_mqc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can see how the error mitigated results yield a far greater fidelity than the raw data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">zeros_m</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_exp_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="n">zerocode</span><span class="p">]</span> <span class="k">if</span>
          <span class="n">zerocode</span> <span class="ow">in</span> <span class="n">result_exp_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))</span> <span class="p">]</span>

<span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;mqc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">zeros</span><span class="p">,</span><span class="n">zeros_m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_55_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_55_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;mqc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_fourier_info</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">sweep</span><span class="p">,</span><span class="n">zeros</span><span class="p">,</span><span class="n">zeros_m</span><span class="p">,</span><span class="n">p_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Upper/Lower raw fidelity bounds =  0.857  +/-  0.009  ||  0.803  +/- 0.008
Upper/Lower error mitigated fidelity bounds =  0.886  +/-  0.009  ||  0.852  +/-  0.009
Raw fidelity =  0.869  +/-  0.009
Mitigated fidelity =  0.894  +/-  0.009
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;I0&#39;: (0.41552734375+0j),
 &#39;In&#39;: (0.16123040795800753+7.8682083452691e-05j),
 &#39;I0_m&#39;: (0.42314560290747766+0j),
 &#39;In_m&#39;: (0.18167459335619435+6.189882002559724e-05j),
 &#39;LB&#39;: 0.8030701766516697,
 &#39;UB&#39;: 0.857346092882548,
 &#39;LB_m&#39;: 0.8524660788583848,
 &#39;UB_m&#39;: 0.8862034748418814,
 &#39;F&#39;: 0.8692662432128102,
 &#39;F_m&#39;: 0.8939641943161678}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_56_2.png" src="../../_images/tutorials_noise_9_entanglement_verification_56_2.png" />
</div>
</div>
<p>We now plot the DFT and compare the heights of the peaks to give bounds for the fidelity</p>
<p>Statistical bootstrapping has found that the error on these measurements is at most 1.5% (arXiv 1905.05720), so these result fall within error bounds, despite the fidelity being slightly higher than the upper bound, and show how error mitigation dramatically increases fidelity</p>
</section>
<section id="Part-2:-Parity-Oscillation">
<h2>Part 2: Parity Oscillation<a class="headerlink" href="#Part-2:-Parity-Oscillation" title="Link a questa intestazione">¶</a></h2>
<p>We now retrieve a parallelized Parity Oscillation circuit for the n qubit device, and run experiments in the same fashion as we did in MQC.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span>
<span class="n">sweep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="n">circ</span><span class="p">,</span> <span class="p">[</span><span class="n">theta</span><span class="p">,</span><span class="n">thetaneg</span><span class="p">]</span> <span class="p">,</span> <span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_po_para</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>

<span class="n">circ_total</span> <span class="o">=</span> <span class="p">[</span><span class="n">circ</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="n">t</span><span class="p">,</span> <span class="n">thetaneg</span><span class="p">:</span><span class="o">-</span><span class="n">t</span><span class="p">})</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sweep</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 2.06 s, sys: 10.5 ms, total: 2.07 s
Wall time: 2.07 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_exp</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_total</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">,</span>
                  <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_exp</span><span class="p">)</span>
<span class="n">result_exp</span> <span class="o">=</span> <span class="n">job_exp</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<p>Now we construct the <span class="math notranslate nohighlight">\(\otimes _{j}^{N} \sigma_z^{j}\)</span> matrix for instruction, although this is already taken into account in the following method, <code class="docutils literal notranslate"><span class="pre">entanglement.analysis.composite_pauli_z_expvalue()</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">composite_sigma_z</span> <span class="o">=</span> <span class="n">sigma_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">qn</span><span class="p">):</span>
    <span class="n">composite_sigma_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">composite_sigma_z</span><span class="p">,</span><span class="n">sigma_z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we want to make sure that our list of counts is correctly ordered so that it coincides with the states of the <span class="math notranslate nohighlight">\(\otimes _{j}^{N} \sigma_z^{j}\)</span>, so that calculating <span class="math notranslate nohighlight">\(\langle \otimes _{j}^{N} \sigma_z^{j} \rangle\)</span> will be as simple as taking the dot product of this ordered list with the diagonal of <span class="math notranslate nohighlight">\(\otimes _{j}^{N} \sigma_z^{j}\)</span>. The <code class="docutils literal notranslate"><span class="pre">composite_pauli_z_expvalue</span></code> function does just that; it takes a circuit and appropriately orders the state vector counts. We can plot this
dot product as a function of <span class="math notranslate nohighlight">\(\phi\)</span> to observe parity oscillations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.analysis</span> <span class="kn">import</span> <span class="n">composite_pauli_z_expvalue</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">composite_pauli_z_expvalue</span><span class="p">(</span><span class="n">result_exp</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">qn</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_68_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_68_0.png" />
</div>
</div>
<p>Now for standard error mitigation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs</span><span class="p">,</span> <span class="n">state_labels</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_cal</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                  <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_cal</span><span class="p">)</span>
<span class="n">meas_result</span> <span class="o">=</span> <span class="n">job_cal</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result</span><span class="p">,</span><span class="n">state_labels</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="n">result_exp_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">result_exp</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_m</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">composite_pauli_z_expvalue</span><span class="p">(</span><span class="n">result_exp_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">qn</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y_m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_74_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_74_0.png" />
</div>
</div>
<p>We can see how error mitigation dramatically improves our measurement (much more so in PO than in MQC). Let us quantify this using the same DFT method we used in MQC, and calculating the actual fidelities:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_fourier_info</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y_m</span><span class="p">,</span><span class="n">p_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Raw fidelity =  0.641  +/-  0.006
Mitigated fidelity =  0.878  +/-  0.009
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;In&#39;: (-0.26317275322394224-0.0069647879792624975j),
 &#39;In_m&#39;: (-0.4101495965078221-0.009319374887961387j),
 &#39;F&#39;: 0.6411945851051803,
 &#39;F_m&#39;: 0.8779866146481243}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_76_2.png" src="../../_images/tutorials_noise_9_entanglement_verification_76_2.png" />
</div>
</div>
<p>As we see, the raw fidelity is much lower than what is achieved with MQC, but the error mitigated result is about the same.</p>
</section>
<section id="Part-3:-Tomography">
<h2>Part 3: Tomography<a class="headerlink" href="#Part-3:-Tomography" title="Link a questa intestazione">¶</a></h2>
<p>The first step in this experiment to just pass a simple GHZ state with <em>no</em> measurements. Also, the circuit cannot be transpiled; the <code class="docutils literal notranslate"><span class="pre">transpiled</span></code> argument in the <code class="docutils literal notranslate"><span class="pre">getGHZChecker()</span></code> method can be turned on and off as is shown</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_total</span><span class="p">,</span> <span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_layout</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">transpiled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We now pass a simulated backend from <code class="docutils literal notranslate"><span class="pre">Aer</span></code> to get theoretical statevector counts</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_exp</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_total</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_exp</span><span class="p">)</span>
<span class="n">result_exp</span> <span class="o">=</span> <span class="n">job_exp</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">psi_exp</span> <span class="o">=</span> <span class="n">result_exp</span><span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">circ_total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<p>This following code runs tomography experiments on the circuit we defined first, which is then compared to the theoretical statevector to generate a density matrix</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qst</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">circ_total</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">qst</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">initial_layout</span><span class="o">=</span><span class="n">initial_layout</span><span class="p">,</span><span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tomo</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>From here we can get the fidelity, although this method is not as fool proof as the one we will get to eventually:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">F</span> <span class="o">=</span> <span class="n">quantum_info</span><span class="o">.</span><span class="n">state_fidelity</span><span class="p">(</span><span class="n">psi_exp</span><span class="p">,</span><span class="n">tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>…And now for error mitigation…</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs</span><span class="p">,</span> <span class="n">state_labels</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_c</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                  <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_c</span><span class="p">)</span>
<span class="n">meas_result</span> <span class="o">=</span> <span class="n">job_c</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result</span><span class="p">,</span><span class="n">state_labels</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="n">result_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
<span class="n">tomo_em</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">result_em</span><span class="p">,</span> <span class="n">qst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, using <code class="docutils literal notranslate"><span class="pre">qiskit.visualization</span></code>, we can plot the raw density matrix, real, and imaginary parts being on separate plots,…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_state_city</span><span class="p">(</span><span class="n">tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span><span class="s2">&quot;city&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_94_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_94_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_94_1.png" src="../../_images/tutorials_noise_9_entanglement_verification_94_1.png" />
</div>
</div>
<p>And also the error mitigated density matrix,…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_state_city</span><span class="p">(</span><span class="n">tomo_em</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span><span class="s2">&quot;city&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_96_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_96_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_96_1.png" src="../../_images/tutorials_noise_9_entanglement_verification_96_1.png" />
</div>
</div>
<p>The actual density matrices can be obtained using the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method. Once we have the density matrix, we can compute the fidelity, which is nothing but half the sum of the four corners of the density matrix; the following method helps us:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.analysis</span> <span class="kn">import</span> <span class="n">rho_to_fidelity</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho</span><span class="p">,</span> <span class="n">rho_em</span> <span class="o">=</span> <span class="n">tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="p">,</span> <span class="n">tomo_em</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">F</span> <span class="o">=</span> <span class="n">rho_to_fidelity</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="n">F_em</span> <span class="o">=</span> <span class="n">rho_to_fidelity</span><span class="p">(</span><span class="n">rho_em</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Raw fidelity: &quot;</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error mitigated fidelity: &quot;</span><span class="p">,</span><span class="n">F_em</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Raw fidelity:  0.6368794947513089
Error mitigated fidelity:  0.8897132713838496
</pre></div></div>
</div>
<p>As we see, the raw fidelity is much lower than what is achieved with either MQC or Parity Oscillations, but the error mitigated result is about the same.</p>
<p><strong>A note on tomography</strong></p>
<p>Do not perform quantum tomography with &gt;5 qubits</p>
</section>
<section id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Link a questa intestazione">¶</a></h2>
<p>In conclusion, we see that without error mitigation, MQC is the superior method for characterizing the GHZ state. However, with error mitigation, all methods can, at least for a small number of qubits, achieve a much greater fidelity, and all near the same value. To get more accurate results, aside from using a real device, it is worth increasing the number of shots four to eight-fold. It may be worth comparing how the parallelized circuits used in this notebook perform fidelity-wise versus
linearized circuits.</p>
</section>
<section id="External-collaborators">
<h2>External collaborators<a class="headerlink" href="#External-collaborators" title="Link a questa intestazione">¶</a></h2>
<p>Rohith Karur</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.26.0</td></tr><tr><td>Terra</td><td>0.17.3</td></tr><tr><td>Aer</td><td>0.8.2</td></tr><tr><td>Ignis</td><td>0.6.0</td></tr><tr><td>Aqua</td><td>0.9.1</td></tr><tr><td>IBM Q Provider</td><td>0.13.1</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.9.4 (default, Apr 20 2021, 15:51:38)
[GCC 10.2.0]</td></tr><tr><td>OS</td><td>Linux</td></tr><tr><td>CPUs</td><td>32</td></tr><tr><td>Memory (Gb)</td><td>125.71707916259766</td></tr><tr><td colspan='2'>Wed May 12 06:38:49 2021 EDT</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2021.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</section>
</section>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Qiskit Development Team.
      Ultimo aggiornamento 2021/10/02.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Entanglement Verification</a><ul>
<li><a class="reference internal" href="#Introduction-to-the-GHZ-state">Introduction to the GHZ state</a></li>
<li><a class="reference internal" href="#Characterizing-a-quantum-state">Characterizing a quantum state</a></li>
<li><a class="reference internal" href="#Preparing-a-GHZ-State">Preparing a GHZ State</a></li>
<li><a class="reference internal" href="#Characterization,-Part-I">Characterization, Part I</a><ul>
<li><a class="reference internal" href="#Multiple-Quantum-Coherence-(MQC)">Multiple Quantum Coherence (MQC)</a></li>
<li><a class="reference internal" href="#Parity-Oscillations">Parity Oscillations</a></li>
<li><a class="reference internal" href="#Tomography">Tomography</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Parallelizing-circuits">Parallelizing circuits</a></li>
<li><a class="reference internal" href="#Error-Mitigation">Error Mitigation</a></li>
<li><a class="reference internal" href="#Experiment-Time">Experiment Time</a><ul>
<li><a class="reference internal" href="#Preliminary-Steps">Preliminary Steps</a></li>
<li><a class="reference internal" href="#Part-1-:-MQC">Part 1 : MQC</a></li>
<li><a class="reference internal" href="#Part-2:-Parity-Oscillation">Part 2: Parity Oscillation</a></li>
<li><a class="reference internal" href="#Part-3:-Tomography">Part 3: Tomography</a></li>
<li><a class="reference internal" href="#Conclusion">Conclusion</a></li>
<li><a class="reference internal" href="#External-collaborators">External collaborators</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
         <script src="../../_static/jquery.js"></script>
         <script src="../../_static/underscore.js"></script>
         <script src="../../_static/doctools.js"></script>
         <script src="../../_static/language_data.js"></script>
         <script src="../../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
         <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
     

  

  <script type="text/javascript" src="../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting Started</a>
          </li>
          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>
          <li>
            <a href="https://qiskit.org/documentation/partners/">Partners</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Applications
          </li>
          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.org/documentation/machine-learning/">Machine learning</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/nature/">Nature</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/finance/">Finance</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/optimization/">Optimization</a>
            </li>
          </ul>
          <br>
          <li>
            <a href="https://qiskit.org/documentation/experiments/">Experiments</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.slack.com">Slack support</a>
            </li>
          </ul>
          <br>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>