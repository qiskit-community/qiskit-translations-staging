


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es-UN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es-UN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Algoritmo de Estimación de Fase Cuántica Iterativa &mdash; documentación de Qiskit - 0.36.1</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Buscar" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting started</a>
          </li>

          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/partners/" target="_blank">Partners</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Applications
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/machine-learning/">
                  <span class="dropdown-title">Machine learning</span>
                  <p>QSVM, VQC (Variational Quantum Classifier), and QGAN (Quantum Generative
                    Adversarial Network) algorithms.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/nature/">
                  <span class="dropdown-title">Nature</span>
                  <p>Quantum applications in chemistry, physics, and biology.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/finance/">
                  <span class="dropdown-title">Finance</span>
                  <p>Uncertainty components for stock/securities problems, Ising translators for
                    portfolio optimizations and data providers to source real or random data.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/optimization/">
                  <span class="dropdown-title">Optimization</span>
                  <p>High-level optimization problems that are ready to
                    run on simulators and real quantum devices</p>
                </a>
              </div>
          </li>
          <li>
              <a href="https://qiskit.org/documentation/experiments/" target="_blank">Experiments</a>
          </li>
          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.slack.com">
                  <span class="dropdown-title">Slack support</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/textbook">
                  <span class="dropdown-title">Qiskit Textbook</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/events">
                  <span class="dropdown-title">Qiskit events</span>
                  <p></p>
                </a>
            </div>
          </li>
          <li>
            <a href="https://github.com/Qiskit/" target="_blank">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">Spanish</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Idiomas</dt>
      
        <dd><a class="version" href="/documentation/tutorials/textbook/01_IQPE.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/bn_BN/tutorials/textbook/01_IQPE.html">Bengali</a></dd>
      
        <dd><a class="version" href="/documentation/locale/fr_FR/tutorials/textbook/01_IQPE.html">French</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/tutorials/textbook/01_IQPE.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/tutorials/textbook/01_IQPE.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/tutorials/textbook/01_IQPE.html">Korean</a></dd>
      
        <dd><a class="version" href="/documentation/locale/pt_UN/tutorials/textbook/01_IQPE.html">Portuguese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/es_UN/tutorials/textbook/01_IQPE.html">Spanish</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ta_IN/tutorials/textbook/01_IQPE.html">Tamil</a></dd>
      
    </dl>
    
    <dl>
      <dt>Previous Releases</dt>
      
        <dd><a class="version" href="/documentation/stable/0.19/index.html">0.19</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.24/index.html">0.24</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.25/index.html">0.25</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.26/index.html">0.26</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.27/index.html">0.27</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.28/index.html">0.28</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.29/index.html">0.29</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.30/index.html">0.30</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.31/index.html">0.31</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.32/index.html">0.32</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.33/index.html">0.33</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.34/index.html">0.34</a></dd>
      
    </dl>
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Página de inicio de la Documentación</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Preliminares</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../qc_intro.html">Computación cuántica en pocas palabras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_tutorial1.html">Introducción a Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_to_qiskit.html">Contribuir a Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuración Local</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Preguntas Frecuentes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliotecas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/circuit_library.html">Biblioteca de circuitos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Referencias de la API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/terra.html">Qiskit Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aer.html">Qiskit Aer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ignis.html">Qiskit Ignis (obsoleto)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ibmq-provider.html">Proveedor Qiskit IBM Quantum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solución de Problemas</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/lab/docs/iql/manage/errors">Códigos de error de la API de IBM Quantum</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Algoritmo de Estimación de Fase Cuántica Iterativa</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/textbook/01_IQPE.ipynb" rel="nofollow"><img src="../../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content style-external-links">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Esta página fue generada a partir de <a class="reference external" href="https://github.com/Qiskit/qiskit-tutorials/blob/master/tutorials/textbook/01_IQPE.ipynb">tutorials/textbook/01_IQPE.ipynb</a>.</p>
</div>
<div class="section" id="Algoritmo-de-Estimación-de-Fase-Cuántica-Iterativa">
<h1>Algoritmo de Estimación de Fase Cuántica Iterativa<a class="headerlink" href="#Algoritmo-de-Estimación-de-Fase-Cuántica-Iterativa" title="Enlazar permanentemente con este título">¶</a></h1>
<p>El objetivo de este tutorial es comprender cómo funciona el algoritmo de Estimación de Fase Iterativa (Iterative Phase Estimation, IPE), por qué usaríamos el algoritmo IPE en lugar del algoritmo QPE (Quantum Phase Estimation, Estimación de Fase Cuántica) y cómo construirlo con Qiskit utilizando el mismo circuito aprovechando la compuerta de reinicio y el método <code class="docutils literal notranslate"><span class="pre">c_if</span></code> que permite aplicar compuertas condicionadas por los valores almacenados en un registro clásico, resultantes de mediciones previas.</p>
<p><strong>Referencias</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://qiskit.org/textbook/ch-labs/Lab04_IterativePhaseEstimation.html#2-iterative-phase-estimation-ipe-algorithm">Sección 2 del Lab 4: Algoritmo de Estimación de Fase Iterativa (IPE)</a></p></li>
<li><p><a class="reference external" href="https://qiskit.org/textbook/ch-algorithms/quantum-phase-estimation.html">Ch.3.6 Estimación de Fase Cuántica</a></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">ClassicalRegister</span><span class="p">,</span> <span class="n">QuantumRegister</span><span class="p">,</span> <span class="n">execute</span><span class="p">,</span> <span class="n">assemble</span><span class="p">,</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit.tools.visualization</span> <span class="kn">import</span> <span class="n">plot_histogram</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="section" id="Compuertas-condicionadas:-el-método-c_if">
<h2>Compuertas condicionadas: el método c_if<a class="headerlink" href="#Compuertas-condicionadas:-el-método-c_if" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Antes de iniciar el algoritmo IPE, vamos a dar un breve tutorial sobre el método condicional de Qiskit, c_if, a medida que se avanza en la construcción del circuito IPE.</p>
<p><code class="docutils literal notranslate"><span class="pre">c_if</span></code> es una función (en realidad, un método de la clase compuerta) para realizar operaciones condicionadas basadas en el valor almacenado previamente en un registro clásico. Con esta función puedes aplicar compuertas después de una medición en el mismo circuito condicionado por el resultado de la medición.</p>
<p>Por ejemplo, el siguiente código ejecutará la compuerta <span class="math notranslate nohighlight">\(X\)</span> si el valor del registro clásico es <span class="math notranslate nohighlight">\(0\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_4_0.png" src="../../_images/tutorials_textbook_01_IQPE_4_0.png" />
</div>
</div>
<p>Resaltamos que el método c_if espera como primer argumento un registro clásico completo, no un solo bit clásico (o una lista de bits clásicos), y como segundo argumento un valor en representación decimal (un entero no negativo), no el valor de un solo bit, 0, o 1 (o una lista/cadena de dígitos binarios).</p>
<p>Hagamos otro ejemplo. Considera que queremos realizar un cambio de bit en el tercer qubit después de las mediciones en el siguiente circuito, cuando los resultados de la medición de <span class="math notranslate nohighlight">\(q_0\)</span> y <span class="math notranslate nohighlight">\(q_1\)</span> son ambos <span class="math notranslate nohighlight">\(1\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_6_0.png" src="../../_images/tutorials_textbook_01_IQPE_6_0.png" />
</div>
</div>
<p>Queremos aplicar la compuerta <span class="math notranslate nohighlight">\(X\)</span>, solo si los resultados de la medición de <span class="math notranslate nohighlight">\(q_1\)</span> y <span class="math notranslate nohighlight">\(q_2\)</span> son <span class="math notranslate nohighlight">\(1\)</span>. Podemos hacer esto usando el método c_if, condicionando la aplicación de <span class="math notranslate nohighlight">\(X\)</span> dependiendo del valor pasado como argumento a c_if.</p>
<p>Tendremos que codificar el valor para pasar al método c_if de manera que verifique los valores 011 y 111 (en representación binaria), ya que no importa cuál esté en la posición más a la derecha.</p>
<p>Los 2 valores enteros en representación decimal:</p>
<p><img alt="ff8726543a1346f2850366f7993d0bbd" class="no-scaled-link" src="images/binary.png" style="width: 50%;" /></p>
<p>Podemos verificar las soluciones usando el método bin() en python (el prefijo <code class="docutils literal notranslate"><span class="pre">0b</span></code> indica el formato binario).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0b11
0b111
</pre></div></div>
</div>
<p>Entonces tenemos que aplicar <span class="math notranslate nohighlight">\(X\)</span> a <span class="math notranslate nohighlight">\(q_2\)</span> usando c_if dos veces, una para cada valor correspondiente a 011 y 111.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>

<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># for the 011 case</span>
<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="c1"># for the 111 case</span>

<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_12_0.png" src="../../_images/tutorials_textbook_01_IQPE_12_0.png" />
</div>
</div>
</div>
<div class="section" id="IPE">
<h2>IPE<a class="headerlink" href="#IPE" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La motivación para usar el algoritmo IPE es que el algoritmo QPE funciona bien para circuitos de poca profundidad, pero cuando el circuito comienza a crecer, no funciona correctamente debido al ruido de compuerta y los tiempos de decoherencia.</p>
<p>La explicación detallada de cómo funciona el algoritmo se puede encontrar en <a class="reference external" href="https://qiskit.org/textbook/ch-labs/Lab04_IterativePhaseEstimation.html#2-iterative-phase-estimation-ipe-algorithm">Algoritmo de Estimación de Fase Iterativa (IPE)</a>. Para comprender la QPE en profundidad, puedes consultar también <a class="reference external" href="https://qiskit.org/textbook/ch-algorithms/quantum-phase-estimation.html">Ch.3.6 Estimación de Fase Cuántica</a>.</p>
<div class="section" id="Ejemplo-de-IPE-con-una-compuerta-de-1-qubit-para-U">
<h3>Ejemplo de IPE con una compuerta de 1 qubit para <span class="math notranslate nohighlight">\(U\)</span><a class="headerlink" href="#Ejemplo-de-IPE-con-una-compuerta-de-1-qubit-para-U" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Queremos aplicar el algoritmo IPE para estimar la fase de un operador <span class="math notranslate nohighlight">\(U\)</span> de 1 qubit. Por ejemplo, aquí usamos la compuerta <span class="math notranslate nohighlight">\(S\)</span>.</p>
<p>Apliquemos el algoritmo IPE para estimar la fase de la compuerta <span class="math notranslate nohighlight">\(S\)</span>. Su matriz es</p>
<div class="math notranslate nohighlight">
\[\begin{split} S =
\begin{bmatrix}
1 &amp; 0\\
0 &amp; e^\frac{i\pi}{2}\\
\end{bmatrix}\end{split}\]</div>
<p>Es decir, la compuerta <span class="math notranslate nohighlight">\(S\)</span> agrega una fase de <span class="math notranslate nohighlight">\(\pi/2\)</span> al estado <span class="math notranslate nohighlight">\(|1\rangle\)</span>, dejando sin cambios a la fase del estado <span class="math notranslate nohighlight">\(|0\rangle\)</span></p>
<div class="math notranslate nohighlight">
\[S|1\rangle = e^\frac{i\pi}{2}|1\rangle\]</div>
<p>En lo siguiente, utilizaremos la notación y los términos utilizados en la <a class="reference external" href="https://qiskit.org/textbook/ch-labs/Lab04_IterativePhaseEstimation.html#2-iterative-phase-estimation-ipe-algorithm">Sección 2 del laboratorio 4</a>.</p>
<p>Consideremos estimar la fase <span class="math notranslate nohighlight">\(\phi=\frac{\pi}{2}\)</span> para el estado propio <span class="math notranslate nohighlight">\(|1\rangle\)</span>, deberíamos encontrar <span class="math notranslate nohighlight">\(\varphi=\frac{1}{4}\)</span> (donde <span class="math notranslate nohighlight">\(\phi = 2 \pi \varphi\)</span>). Por lo tanto, para estimar la fase necesitamos exactamente 2 bits de fase, es decir, <span class="math notranslate nohighlight">\(m=2\)</span>, ya que <span class="math notranslate nohighlight">\(1/2^2=1/4\)</span>. Entonces <span class="math notranslate nohighlight">\(\varphi=0.\varphi_1\varphi_2\)</span>.</p>
<p>Recuerda de la teoría que para el algoritmo IPE, <span class="math notranslate nohighlight">\(m\)</span> es también el número de iteraciones, por lo que solo necesitamos <span class="math notranslate nohighlight">\(2\)</span> iteraciones o pasos.</p>
<p>Primero, inicializamos el circuito. IPE trabaja con solo 1 qubit auxiliar, en lugar de <span class="math notranslate nohighlight">\(m\)</span> qubits contados del algoritmo QPE. Por lo tanto, necesitamos 2 qubits, 1 qubit auxiliar y 1 para el estado propio de la compuerta <span class="math notranslate nohighlight">\(U\)</span>, y un registro clásico de 2 bits, para los bits de fase <span class="math notranslate nohighlight">\(\varphi_1\)</span>, <span class="math notranslate nohighlight">\(\varphi_2\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nq</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">nq</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="n">qc_S</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Primer-paso">
<h4>Primer paso<a class="headerlink" href="#Primer-paso" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Ahora construimos el circuito cuántico para el primer paso, es decir, la primera iteración del algoritmo, para estimar el bit de fase menos significativo <span class="math notranslate nohighlight">\(\varphi_m\)</span>, en este caso <span class="math notranslate nohighlight">\(\varphi_2\)</span>. Para el primer paso tenemos 3 subpasos: - inicialización - aplicación de las compuertas Controladas-<span class="math notranslate nohighlight">\(U\)</span> - medición del qubit auxiliar en la base x</p>
<div class="section" id="Inicialización">
<h5>Inicialización<a class="headerlink" href="#Inicialización" title="Enlazar permanentemente con este título">¶</a></h5>
<p>La inicialización consiste en la aplicación de la compuerta Hadamard al qubit auxiliar y la preparación del estado propio <span class="math notranslate nohighlight">\(|1\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc_S</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc_S</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc_S</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_16_0.png" src="../../_images/tutorials_textbook_01_IQPE_16_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Aplicación-de-las-compuertas-Controladas-U">
<h4>Aplicación de las compuertas Controladas-<span class="math notranslate nohighlight">\(U\)</span><a class="headerlink" href="#Aplicación-de-las-compuertas-Controladas-U" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Luego tenemos que aplicar <span class="math notranslate nohighlight">\(2^t\)</span> veces los operadores Controlados-<span class="math notranslate nohighlight">\(U\)</span> (ver también en la documentación <a class="reference external" href="https://qiskit.org/documentation/tutorials/circuits/3_summary_of_quantum_operations.html#Two-qubit-gates">Compuertas de dos qubits</a>), que, en este ejemplo, es la compuerta Controlada-<span class="math notranslate nohighlight">\(S\)</span> (<span class="math notranslate nohighlight">\(CS\)</span> para abreviar).</p>
<p>Para implementar <span class="math notranslate nohighlight">\(CS\)</span> en el circuito, ya que <span class="math notranslate nohighlight">\(S\)</span> es una compuerta de fase, podemos usar la compuerta de fase controlada <span class="math notranslate nohighlight">\(\text{CP}(\theta)\)</span>, con <span class="math notranslate nohighlight">\(\theta=\pi/2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cu_circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cu_circ</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cu_circ</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_18_0.png" src="../../_images/tutorials_textbook_01_IQPE_18_0.png" />
</div>
</div>
<p>Apliquemos <span class="math notranslate nohighlight">\(2^t\)</span> veces <span class="math notranslate nohighlight">\(\text{CP}(\pi/2)\)</span>. Dado que para el primer paso <span class="math notranslate nohighlight">\(t=m-1\)</span>, y <span class="math notranslate nohighlight">\(m=2\)</span>, tenemos <span class="math notranslate nohighlight">\(2^t=2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">qc_S</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc_S</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_20_0.png" src="../../_images/tutorials_textbook_01_IQPE_20_0.png" />
</div>
</div>
</div>
<div class="section" id="Medición-en-la-base-x">
<h4>Medición en la base x<a class="headerlink" href="#Medición-en-la-base-x" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Finalmente, realizamos la medición del qubit auxiliar en la base x. Así que definiremos una función para realizar la x_measure y luego la aplicaremos.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">x_measurement</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">qubit</span><span class="p">,</span> <span class="n">cbit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Measure &#39;qubit&#39; in the X-basis, and store the result in &#39;cbit&#39;&quot;&quot;&quot;</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">qubit</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">cbit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>De esta forma obtenemos el bit de fase <span class="math notranslate nohighlight">\(\varphi_2\)</span> y lo almacenamos en el bit clásico <span class="math notranslate nohighlight">\(c_0\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_measurement</span><span class="p">(</span><span class="n">qc_S</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">qc_S</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_24_0.png" src="../../_images/tutorials_textbook_01_IQPE_24_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Pasos-posteriores-(segundo-paso)">
<h3>Pasos posteriores (segundo paso)<a class="headerlink" href="#Pasos-posteriores-(segundo-paso)" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ahora construimos el circuito cuántico para los otros pasos restantes, en este ejemplo, solo el segundo. En estos pasos tenemos 4 subpasos: los 3 subpasos como en el primer paso y, en medio, el paso adicional de la corrección de fase - inicialización con restablecimiento - corrección de fase - aplicación de la compuerta <span class="math notranslate nohighlight">\(U\)</span> Controlada - medición del qubit auxiliar en la base x</p>
<div class="section" id="Inicialización-con-restablecimiento">
<h4>Inicialización con restablecimiento<a class="headerlink" href="#Inicialización-con-restablecimiento" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Como queremos realizar un algoritmo iterativo en el mismo circuito, necesitamos restablecer el qubit auxiliar <span class="math notranslate nohighlight">\(q0\)</span> después de la compuerta de medición e inicializarlo nuevamente como antes para reciclar el qubit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc_S</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc_S</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc_S</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_26_0.png" src="../../_images/tutorials_textbook_01_IQPE_26_0.png" />
</div>
</div>
</div>
<div class="section" id="Corrección-de-fase-(para-el-paso-2)">
<h4>Corrección de fase (para el paso 2)<a class="headerlink" href="#Corrección-de-fase-(para-el-paso-2)" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Como se ve en la teoría, para extraer el bit de fase <span class="math notranslate nohighlight">\(\varphi_{1}\)</span>, realizamos una corrección de fase de <span class="math notranslate nohighlight">\(-\pi\varphi_2/2\)</span>. Por supuesto, necesitamos aplicar la corrección de fase en el circuito solo si el bit de fase <span class="math notranslate nohighlight">\(\varphi_2=1\)</span>, es decir, tenemos que aplicar la corrección de fase de <span class="math notranslate nohighlight">\(-\pi/2\)</span> solo si el bit clásico <span class="math notranslate nohighlight">\(c_0\)</span> es 1.</p>
<p>Entonces, después del restablecimiento, aplicamos la compuerta de fase <span class="math notranslate nohighlight">\(P(\theta)\)</span> con fase <span class="math notranslate nohighlight">\(\theta=-\pi/2\)</span> condicionada por el bit clásico <span class="math notranslate nohighlight">\(c_0\)</span> (<span class="math notranslate nohighlight">\(=\varphi_2\)</span>) usando el método <code class="docutils literal notranslate"><span class="pre">c_if</span></code>. Entonces, como vimos en la primera parte de este tutorial, tenemos que usar el método <code class="docutils literal notranslate"><span class="pre">c_if</span></code> con un valor de 1, como <span class="math notranslate nohighlight">\(1_{10} = 001_{2}\)</span> (los subíndices <span class="math notranslate nohighlight">\(_{10}\)</span> y <span class="math notranslate nohighlight">\(_2\)</span> indican las representaciones decimal y binaria).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc_S</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc_S</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_28_0.png" src="../../_images/tutorials_textbook_01_IQPE_28_0.png" />
</div>
</div>
</div>
<div class="section" id="Aplicación-de-las-compuertas-U-Controladas-y-medición-en-x-(para-el-paso-2)">
<h4>Aplicación de las compuertas <span class="math notranslate nohighlight">\(U\)</span> Controladas y medición en x (para el paso 2)<a class="headerlink" href="#Aplicación-de-las-compuertas-U-Controladas-y-medición-en-x-(para-el-paso-2)" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Aplicamos las operaciones <span class="math notranslate nohighlight">\(CU\)</span> como hicimos en el primer paso. Para el segundo paso tenemos <span class="math notranslate nohighlight">\(t=m-2\)</span>, por lo tanto <span class="math notranslate nohighlight">\(2^t=1\)</span>. Entonces aplicamos <span class="math notranslate nohighlight">\(\text{CP}(\pi/2)\)</span> una vez. Y luego realizamos la medición en x del qubit <span class="math notranslate nohighlight">\(q_0\)</span>, almacenando el resultado, el bit de fase <span class="math notranslate nohighlight">\(\varphi_1\)</span>, en el bit <span class="math notranslate nohighlight">\(c_1\)</span> del registro clásico.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 2^t c-U operations (with t=m-2)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">qc_S</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">x_measurement</span><span class="p">(</span><span class="n">qc_S</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Y listo, tenemos nuestro circuito final</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc_S</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_32_0.png" src="../../_images/tutorials_textbook_01_IQPE_32_0.png" />
</div>
</div>
<p>Ejecutemos el circuito con el <code class="docutils literal notranslate"><span class="pre">qasm_simulator</span></code>, el simulador sin ruido que se ejecuta localmente.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
<span class="n">count0</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">qc_S</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>

<span class="n">key_new</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">count0</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
<span class="n">count1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">key_new</span><span class="p">,</span> <span class="n">count0</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_histogram</span><span class="p">(</span><span class="n">count0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_histogram</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>En la imagen tenemos los mismos histogramas, pero a la izquierda tenemos en el eje x la cadena con bits de fase <span class="math notranslate nohighlight">\(\varphi_1\)</span>, <span class="math notranslate nohighlight">\(\varphi_2\)</span> y a la derecha la fase real <span class="math notranslate nohighlight">\(\varphi\)</span> en representación decimal.</p>
<p>Como esperábamos, hemos encontrado <span class="math notranslate nohighlight">\(\varphi=\frac{1}{4}=0.25\)</span> con una probabilidad de <span class="math notranslate nohighlight">\(100\%\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="Ejemplo-de-IPE-con-una-compuerta-de-2-qubits">
<h2>Ejemplo de IPE con una compuerta de 2 qubits<a class="headerlink" href="#Ejemplo-de-IPE-con-una-compuerta-de-2-qubits" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ahora, queremos aplicar el algoritmo IPE para estimar la fase para una compuerta <span class="math notranslate nohighlight">\(U\)</span> de 2 qubits. Para este ejemplo, consideremos la versión controlada de la compuerta <span class="math notranslate nohighlight">\(T\)</span>, es decir, la compuerta <span class="math notranslate nohighlight">\(U=\textrm{Controlled-}T\)</span> (que a partir de ahora expresaremos de manera más compacta con <span class="math notranslate nohighlight">\(CT\)</span>). Su matriz es</p>
<div class="math notranslate nohighlight">
\[\begin{split} CT =
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; e^\frac{i\pi}{4}\\
\end{bmatrix}\end{split}\]</div>
<p>Es decir, la compuerta <span class="math notranslate nohighlight">\(CT\)</span> agrega una fase de <span class="math notranslate nohighlight">\(\pi/4\)</span> al estado <span class="math notranslate nohighlight">\(|11\rangle\)</span>, dejando sin cambios la fase de los otros estados de la base computacional <span class="math notranslate nohighlight">\(|00\rangle\)</span>, <span class="math notranslate nohighlight">\(|01\rangle\)</span>, <span class="math notranslate nohighlight">\(|10\rangle\)</span>.</p>
<p>Consideremos estimar la fase <span class="math notranslate nohighlight">\(\phi=\pi/4\)</span> para el estado propio <span class="math notranslate nohighlight">\(|11\rangle\)</span>, deberíamos encontrar <span class="math notranslate nohighlight">\(\varphi=1/8\)</span>, ya que <span class="math notranslate nohighlight">\(\phi = 2 \pi \varphi\)</span>. Por lo tanto, para estimar la fase necesitamos exactamente 3 bits clásicos, es decir, <span class="math notranslate nohighlight">\(m=3\)</span>, ya que <span class="math notranslate nohighlight">\(1/2^3=1/8\)</span>. Entonces <span class="math notranslate nohighlight">\(\varphi=0.\varphi_1\varphi_2\varphi_3\)</span>.</p>
<p>Como se hizo con el ejemplo para el operador <span class="math notranslate nohighlight">\(U\)</span> de 1 qubit, seguiremos los mismos pasos, pero esta vez tendremos <span class="math notranslate nohighlight">\(3\)</span> pasos ya que <span class="math notranslate nohighlight">\(m=3\)</span>, y no repetiremos todas las explicaciones. Entonces, para obtener más detalles, consulta el ejemplo anterior para la compuerta <span class="math notranslate nohighlight">\(U\)</span> de 1 qubit.</p>
<p>Primero, inicializamos el circuito con 3 qubits, 1 para el qubit auxiliar y 2 para la compuerta de 2 qubits, y 3 bits clásicos para almacenar los bits de fase <span class="math notranslate nohighlight">\(\varphi_1\)</span>, <span class="math notranslate nohighlight">\(\varphi_2\)</span>, <span class="math notranslate nohighlight">\(\varphi_3\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nq</span> <span class="o">=</span> <span class="mi">3</span>    <span class="c1"># number of qubits</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>    <span class="c1"># number of classical bits</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">nq</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Primer paso<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ahora construimos el circuito cuántico para el primer paso, para estimar el bit de fase menos significativo <span class="math notranslate nohighlight">\(\varphi_m=\varphi_3\)</span>.</p>
<div class="section" id="id3">
<h4>Inicialización<a class="headerlink" href="#id3" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Inicializamos el qubit auxiliar y los otros qubits con el estado propio <span class="math notranslate nohighlight">\(|11\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_39_0.png" src="../../_images/tutorials_textbook_01_IQPE_39_0.png" />
</div>
</div>
</div>
<div class="section" id="id4">
<h4>Aplicación de las compuertas Controladas-<span class="math notranslate nohighlight">\(U\)</span><a class="headerlink" href="#id4" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Luego tenemos que aplicar varias veces el operador <span class="math notranslate nohighlight">\(CU\)</span>, que, en este ejemplo, es la compuerta Controlada-<span class="math notranslate nohighlight">\(CT\)</span> (<span class="math notranslate nohighlight">\(CCT\)</span> para abreviar).</p>
<p>Para implementar <span class="math notranslate nohighlight">\(CCT\)</span> en el circuito, ya que <span class="math notranslate nohighlight">\(T\)</span> es una compuerta de fase, podemos usar la compuerta de fase multicontrolada <span class="math notranslate nohighlight">\(\text{MCP}(\theta)\)</span>, con <span class="math notranslate nohighlight">\(\theta=\pi/4\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cu_circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span>
<span class="n">cu_circ</span><span class="o">.</span><span class="n">mcp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cu_circ</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_41_0.png" src="../../_images/tutorials_textbook_01_IQPE_41_0.png" />
</div>
</div>
<p>Apliquemos <span class="math notranslate nohighlight">\(2^t\)</span> veces <span class="math notranslate nohighlight">\(\text{MCP}(\pi/4)\)</span>. Dado que para el primer paso <span class="math notranslate nohighlight">\(t=m-1\)</span> y <span class="math notranslate nohighlight">\(m=3\)</span>, tenemos <span class="math notranslate nohighlight">\(2^t=4\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">mcp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_43_0.png" src="../../_images/tutorials_textbook_01_IQPE_43_0.png" />
</div>
</div>
</div>
<div class="section" id="id5">
<h4>Medición en la base x<a class="headerlink" href="#id5" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Finalmente, realizamos la medición del qubit auxiliar en la base x. Podemos usar la función <code class="docutils literal notranslate"><span class="pre">x_measurement</span></code> definida anteriormente en el ejemplo para la compuerta de 1 qubit. De esta forma hemos obtenido el bit de fase <span class="math notranslate nohighlight">\(\varphi_3\)</span> y lo almacenamos en el bit clásico <span class="math notranslate nohighlight">\(c_0\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_measurement</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_45_0.png" src="../../_images/tutorials_textbook_01_IQPE_45_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Pasos-posteriores-(segundo,-tercero)">
<h3>Pasos posteriores (segundo, tercero)<a class="headerlink" href="#Pasos-posteriores-(segundo,-tercero)" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ahora construimos el circuito cuántico para los otros pasos restantes, el segundo y el tercero. Como se dijo en el primer ejemplo, en estos pasos tenemos el subpaso adicional de la corrección de fase.</p>
<div class="section" id="id6">
<h4>Inicialización con restablecimiento<a class="headerlink" href="#id6" title="Enlazar permanentemente con este título">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_47_0.png" src="../../_images/tutorials_textbook_01_IQPE_47_0.png" />
</div>
</div>
</div>
<div class="section" id="id7">
<h4>Corrección de fase (para el paso 2)<a class="headerlink" href="#id7" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Para extraer el bit de fase <span class="math notranslate nohighlight">\(\varphi_{2}\)</span>, realizamos una corrección de fase de <span class="math notranslate nohighlight">\(-\pi\varphi_3/2\)</span>.</p>
<p>Entonces, después del restablecimiento, aplicamos la compuerta de fase <span class="math notranslate nohighlight">\(P(\theta)\)</span> con la fase <span class="math notranslate nohighlight">\(\theta=-\pi/2\)</span> condicionada por el bit clásico <span class="math notranslate nohighlight">\(c_0\)</span> (<span class="math notranslate nohighlight">\(=\varphi_3\)</span>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_49_0.png" src="../../_images/tutorials_textbook_01_IQPE_49_0.png" />
</div>
</div>
</div>
<div class="section" id="id8">
<h4>Aplicación de las compuertas <span class="math notranslate nohighlight">\(U\)</span> Controladas y medición en x (para el paso 2)<a class="headerlink" href="#id8" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Aplicamos las operaciones <span class="math notranslate nohighlight">\(CU\)</span> como hicimos en el primer paso. Para el segundo paso tenemos <span class="math notranslate nohighlight">\(t=m-2\)</span>, por lo tanto <span class="math notranslate nohighlight">\(2^t=2\)</span>. Entonces aplicamos <span class="math notranslate nohighlight">\(\text{MCP}(\pi/4)\)</span> <span class="math notranslate nohighlight">\(2\)</span> veces. Y luego realizamos la medición en x del qubit <span class="math notranslate nohighlight">\(q_0\)</span>, almacenando el bit de fase <span class="math notranslate nohighlight">\(\varphi_2\)</span> en el bit <span class="math notranslate nohighlight">\(c_1\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">mcp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_measurement</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_51_0.png" src="../../_images/tutorials_textbook_01_IQPE_51_0.png" />
</div>
</div>
</div>
<div class="section" id="Todos-los-subpasos-del-3er-paso">
<h4>Todos los subpasos del 3er paso<a class="headerlink" href="#Todos-los-subpasos-del-3er-paso" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Para el tercer y último paso, realizamos el restablecimiento e inicialización del qubit auxiliar como se hizo en el segundo paso.</p>
<p>Luego, en el tercer paso, tenemos que realizar la corrección de fase de <span class="math notranslate nohighlight">\(-2\pi 0.0\varphi_{2}\varphi_{3}= -2\pi \left(\frac{\varphi_2}{4}+\frac{\varphi_3}{8}\right)=-\frac{\varphi_2\pi}{2}-\frac{ \varphi_3\pi}{4}\)</span>, por lo que tenemos que aplicar 2 correcciones de fase condicionadas, una condicionada por <span class="math notranslate nohighlight">\(\varphi_3\)</span> (<span class="math notranslate nohighlight">\(=c_0\)</span>) y la otra por <span class="math notranslate nohighlight">\(\varphi_2\)</span>(<span class="math notranslate nohighlight">\(=c_1\)</span>). Para ello tenemos que aplicar lo siguiente: - compuerta <span class="math notranslate nohighlight">\(P(-\pi/4)\)</span> condicionada por <span class="math notranslate nohighlight">\(c_0=1\)</span>, es decir, por <span class="math notranslate nohighlight">\(c=001\)</span> (c_if con valor <span class="math notranslate nohighlight">\(1\)</span>) - compuerta <span class="math notranslate nohighlight">\(P(-\pi/2)\)</span> condicionada por <span class="math notranslate nohighlight">\(c_1=1\)</span>, es decir, la compuerta se aplica cuando <span class="math notranslate nohighlight">\(c=010\)</span> (c_if con valores <span class="math notranslate nohighlight">\(2\)</span>) - compuerta <span class="math notranslate nohighlight">\(P(-3\pi/4)\)</span> condicionada por <span class="math notranslate nohighlight">\(c_1=1\)</span> y <span class="math notranslate nohighlight">\(c_0=1\)</span> es decir, la compuerta se aplica cuando <span class="math notranslate nohighlight">\(c=011\)</span> (c_if con valores <span class="math notranslate nohighlight">\(3\)</span>)</p>
<p>A continuación, las operaciones <span class="math notranslate nohighlight">\(CU\)</span>: aplicamos <span class="math notranslate nohighlight">\(2^t\)</span> veces la compuerta <span class="math notranslate nohighlight">\(\text{MCP}(\pi/4)\)</span> y dado que en el 3er paso <span class="math notranslate nohighlight">\(t=m-3=0\)</span>, aplicamos la compuerta solo una vez.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialization of qubit q0</span>
<span class="n">qc</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># phase correction</span>
<span class="n">qc</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">qc</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># c-U operations</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="p">)):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">mcp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># X measurement</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_textbook_01_IQPE_53_0.png" src="../../_images/tutorials_textbook_01_IQPE_53_0.png" />
</div>
</div>
<p>Ahora, ejecutamos el circuito con el simulador sin ruido.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count0</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>

<span class="n">key_new</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">count0</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
<span class="n">count1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">key_new</span><span class="p">,</span> <span class="n">count0</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_histogram</span><span class="p">(</span><span class="n">count0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_histogram</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<p>Hemos obtenido <span class="math notranslate nohighlight">\(100\%\)</span> de probabilidad de encontrar <span class="math notranslate nohighlight">\(\varphi=0.125\)</span>, es decir, <span class="math notranslate nohighlight">\(1/8\)</span>, como se esperaba.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/miniconda3/envs/qiskit/lib/python3.9/site-packages/qiskit/aqua/operators/operator_globals.py:48: DeprecationWarning: `from_label` is deprecated and will be removed no earlier than 3 months after the release date. Use Pauli(label) instead.
  X = make_immutable(PrimitiveOp(Pauli.from_label(&#39;X&#39;)))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.24.1</td></tr><tr><td>Terra</td><td>0.17.3</td></tr><tr><td>Aer</td><td>0.7.6</td></tr><tr><td>Ignis</td><td>0.5.2</td></tr><tr><td>Aqua</td><td>0.8.2</td></tr><tr><td>IBM Q Provider</td><td>0.13.1</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.9.5 (default, May 18 2021, 12:31:01)
[Clang 10.0.0 ]</td></tr><tr><td>OS</td><td>Darwin</td></tr><tr><td>CPUs</td><td>4</td></tr><tr><td>Memory (Gb)</td><td>16.0</td></tr><tr><td colspan='2'>Fri Jul 02 06:38:27 2021 EDT</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2021.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Qiskit Development Team.
      Actualizado por última vez en 2022/04/25.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Algoritmo de Estimación de Fase Cuántica Iterativa</a><ul>
<li><a class="reference internal" href="#Compuertas-condicionadas:-el-método-c_if">Compuertas condicionadas: el método c_if</a></li>
<li><a class="reference internal" href="#IPE">IPE</a><ul>
<li><a class="reference internal" href="#Ejemplo-de-IPE-con-una-compuerta-de-1-qubit-para-U">Ejemplo de IPE con una compuerta de 1 qubit para <span class="math notranslate nohighlight">\(U\)</span></a><ul>
<li><a class="reference internal" href="#Primer-paso">Primer paso</a><ul>
<li><a class="reference internal" href="#Inicialización">Inicialización</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Aplicación-de-las-compuertas-Controladas-U">Aplicación de las compuertas Controladas-<span class="math notranslate nohighlight">\(U\)</span></a></li>
<li><a class="reference internal" href="#Medición-en-la-base-x">Medición en la base x</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Pasos-posteriores-(segundo-paso)">Pasos posteriores (segundo paso)</a><ul>
<li><a class="reference internal" href="#Inicialización-con-restablecimiento">Inicialización con restablecimiento</a></li>
<li><a class="reference internal" href="#Corrección-de-fase-(para-el-paso-2)">Corrección de fase (para el paso 2)</a></li>
<li><a class="reference internal" href="#Aplicación-de-las-compuertas-U-Controladas-y-medición-en-x-(para-el-paso-2)">Aplicación de las compuertas <span class="math notranslate nohighlight">\(U\)</span> Controladas y medición en x (para el paso 2)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Ejemplo-de-IPE-con-una-compuerta-de-2-qubits">Ejemplo de IPE con una compuerta de 2 qubits</a><ul>
<li><a class="reference internal" href="#id2">Primer paso</a><ul>
<li><a class="reference internal" href="#id3">Inicialización</a></li>
<li><a class="reference internal" href="#id4">Aplicación de las compuertas Controladas-<span class="math notranslate nohighlight">\(U\)</span></a></li>
<li><a class="reference internal" href="#id5">Medición en la base x</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Pasos-posteriores-(segundo,-tercero)">Pasos posteriores (segundo, tercero)</a><ul>
<li><a class="reference internal" href="#id6">Inicialización con restablecimiento</a></li>
<li><a class="reference internal" href="#id7">Corrección de fase (para el paso 2)</a></li>
<li><a class="reference internal" href="#id8">Aplicación de las compuertas <span class="math notranslate nohighlight">\(U\)</span> Controladas y medición en x (para el paso 2)</a></li>
<li><a class="reference internal" href="#Todos-los-subpasos-del-3er-paso">Todos los subpasos del 3er paso</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
         <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
         <script src="../../_static/jquery.js"></script>
         <script src="../../_static/underscore.js"></script>
         <script src="../../_static/doctools.js"></script>
         <script src="../../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
         <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
     

  

  <script type="text/javascript" src="../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting Started</a>
          </li>
          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>
          <li>
            <a href="https://qiskit.org/documentation/partners/">Partners</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Applications
          </li>
          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.org/documentation/machine-learning/">Machine learning</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/nature/">Nature</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/finance/">Finance</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/optimization/">Optimization</a>
            </li>
          </ul>
          <br>
          <li>
            <a href="https://qiskit.org/documentation/experiments/">Experiments</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.slack.com">Slack support</a>
            </li>
          </ul>
          <br>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>