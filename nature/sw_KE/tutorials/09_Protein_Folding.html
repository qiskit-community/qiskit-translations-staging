


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="sw-KE" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="sw-KE" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Protein Folding &mdash; Qiskit Nature 0.2.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Tafuta" href="../search.html" />
    <link rel="next" title="Release Notes" href="../release_notes.html" />
    <link rel="prev" title="The Property Framework" href="08_property_framework.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="../getting_started.html">Getting started</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/nature/tutorials/index.html" target="_blank">Tutorials</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/partners/" target="_blank">Partners</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Applications
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/machine-learning/">
                  <span class="dropdown-title">Machine learning</span>
                  <p>QSVM, VQC (Variational Quantum Classifier), and QGAN (Quantum Generative
                    Adversarial Network) algorithms.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/nature/">
                  <span class="dropdown-title">Nature</span>
                  <p>Quantum applications in chemistry, physics, and biology.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/finance/">
                  <span class="dropdown-title">Finance</span>
                  <p>Uncertainty components for stock/securities problems, Ising translators for
                    portfolio optimizations and data providers to source real or random data.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/optimization/">
                  <span class="dropdown-title">Optimization</span>
                  <p>High-level optimization problems that are ready to
                    run on simulators and real quantum devices</p>
                </a>
              </div>
          </li>
          <li>
              <a href="https://qiskit.org/documentation/experiments/" target="_blank">Experiments</a>
          </li>
          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.slack.com">
                  <span class="dropdown-title">Slack support</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/textbook">
                  <span class="dropdown-title">Qiskit Textbook</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/events">
                  <span class="dropdown-title">Qiskit events</span>
                  <p></p>
                </a>
            </div>
          </li>
          <li>
            <a href="https://github.com/Qiskit/qiskit-nature" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">sw_KE</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Lugha</dt>
      
        <dd><a class="version" href="/documentation/nature/tutorials/09_Protein_Folding.html">English</a></dd>
      
    </dl>
    
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  0.2.2
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidocs/qiskit_nature.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="index.html">Qiskit Nature Tutorials</a> &gt;</li>
        
      <li>Protein Folding</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/09_Protein_Folding.ipynb.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page was generated from <a class="reference external" href="https://github.com/Qiskit/qiskit-nature/blob/stable/0.2/docs/tutorials/09_Protein_Folding.ipynb">docs/tutorials/09_Protein_Folding.ipynb</a>.</p>
</div>
<div class="section" id="Protein-Folding">
<h1>Protein Folding<a class="headerlink" href="#Protein-Folding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>The structure and function of many natural and human-engineered proteins is still only poorly understood. As a result, our understanding of processes connected with protein folding, such as those encountered in Alzheimer’s disease, vaccine development, and crop improvement research, has remained limited.</p>
<p>Unfolded polypeptides have a very large number of degrees of freedom and thus an enormous number of potential conformations. For example, a chain with <span class="math notranslate nohighlight">\(100\)</span> aminoacids has on the order of <span class="math notranslate nohighlight">\(10^{47}\)</span> conformations. In reality, however, many proteins fold to their native structure within seconds. This is known as Levinthal’s paradox [1].</p>
<p>The exponential growth of potential conformations with chain length makes the problem intractable for classical computers. In the quantum framework, our resource-efficient algorithm scales linearly with the number of aminoacids N.</p>
<p>The goal of this work is to determine the minimum energy conformation of a protein. Starting from a random configuration, the protein’s structure is optimized to lower the energy. This can be achieved by encoding the protein folding problem into a qubit operator and ensuring that all physical constraints are satisfied.</p>
<p>For the problem encoding we use:</p>
<ul class="simple">
<li><p>Configuration qubits: qubits that are used to describe the configurations and the relative position of the different beads</p></li>
<li><p>Interaction qubits: qubits that encode interactions between the different aminoacids</p></li>
</ul>
<p>For our case we use a tetrahedral lattice (diamond shape lattice) where we encode the movement through the configuration qubits (see image below).</p>
<p><img alt="e00216ae7db24a71a47fb4bcc586e817" class="no-scaled-link" src="../_images/lattice_protein.png" style="width: 300px;" /></p>
<p>The Hamiltonian of the system for a set of qubits <span class="math notranslate nohighlight">\(\mathbf{q}=\{\mathbf{q}_{cf}, \mathbf{q}_{in}\}\)</span> is</p>
<div class="math notranslate nohighlight">
\[H(\mathbf{q}) = H_{gc}(\mathbf{q}_{cf}) + H_{ch}(\mathbf{q}_{cf}) + H_{in}(\mathbf{q}_{cf}, \mathbf{q}_{in})\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_{gc}\)</span> is the geometrical constraint term (governing the growth of the primary sequence of aminoacids without bifurcations)</p></li>
<li><p><span class="math notranslate nohighlight">\(H_{ch}\)</span> is the chirality constraint (enforcing the right stereochemistry for the system)</p></li>
<li><p><span class="math notranslate nohighlight">\(H_{in}\)</span> is the interaction energy terms of the system. In our case we consider only nearest neighbor interactions.</p></li>
</ul>
<p>Further details about the used model and the encoding of the problem can be found in [2].</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit_nature.problems.sampling.protein_folding.interactions.random_interaction</span> <span class="kn">import</span> <span class="n">RandomInteraction</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.problems.sampling.protein_folding.interactions.miyazawa_jernigan_interaction</span> <span class="kn">import</span> <span class="n">MiyazawaJerniganInteraction</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.problems.sampling.protein_folding.peptide.peptide</span> <span class="kn">import</span> <span class="n">Peptide</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.problems.sampling.protein_folding.protein_folding_problem</span> <span class="kn">import</span> <span class="n">ProteinFoldingProblem</span>

<span class="kn">from</span> <span class="nn">qiskit_nature.problems.sampling.protein_folding.penalty_parameters</span> <span class="kn">import</span> <span class="n">PenaltyParameters</span>

<span class="kn">from</span> <span class="nn">qiskit.utils</span> <span class="kn">import</span> <span class="n">algorithm_globals</span><span class="p">,</span> <span class="n">QuantumInstance</span>

<span class="n">algorithm_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="mi">23</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Protein-Main-Chain">
<h2>Protein Main Chain<a class="headerlink" href="#Protein-Main-Chain" title="Permalink to this headline">¶</a></h2>
<p>The Protein consists of a main chain that is a linear chain of aminoacids. For the naming of different residues we use the one-letter code as defined in Ref. [3]. Further details about the naming and the type of aminoacids can also be found in [4].</p>
<p>For this particular case we demonstrate the generation of the qubit operator in a neuropeptide with the main chain consisting of 7 aminoacids with letter codes APRLRFY (see also [2]).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">main_chain</span> <span class="o">=</span> <span class="s2">&quot;APRLRFY&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Side-Chains">
<h2>Side Chains<a class="headerlink" href="#Side-Chains" title="Permalink to this headline">¶</a></h2>
<p>Beyond the main chain of the protein there may be aminoacids attached to the residues of the main chain. Our model allows for side chains of the maximum length of one. Elongated side chains would require the introduction of additional penalty terms which are still under development. In this example we do not consider any side chains to keep the real structure of the neuropeptide.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">side_chains</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Interaction-between-Aminoacids">
<h2>Interaction between Aminoacids<a class="headerlink" href="#Interaction-between-Aminoacids" title="Permalink to this headline">¶</a></h2>
<p>For the description of inter-residue contacts for proteins we use knowledge-based (statistical) potentials derived using quasi-chemical approximation. The potentials used here are introduced by Miyazawa, S. and Jernigan, R. L. in [5].</p>
<p>Beyond this model we also allow for random contact maps (interactions) that provide a random interaction map. One can also introduce a custom interaction map that enhances certain configurations of the protein (e.g. alpha helix, beta sheet etc).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">random_interaction</span> <span class="o">=</span> <span class="n">RandomInteraction</span><span class="p">()</span>
<span class="n">mj_interaction</span> <span class="o">=</span> <span class="n">MiyazawaJerniganInteraction</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Physical-Constraints">
<h2>Physical Constraints<a class="headerlink" href="#Physical-Constraints" title="Permalink to this headline">¶</a></h2>
<p>To ensure that all physical constraints are respected we introduce penalty functions. The different penalty terms used are:</p>
<ul class="simple">
<li><p>penalty_chiral: A penalty parameter used to impose the right chirality.</p></li>
<li><p>penalty_back: A penalty parameter used to penalize turns along the same axis. This term is used to eliminate sequences where the same axis is chosen twice in a row. In this way we do not allow for a chain to fold back into itself.</p></li>
<li><p>penalty_1: A penalty parameter used to penalize local overlap between beads within a nearest neighbor contact.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">penalty_back</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">penalty_chiral</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">penalty_1</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">penalty_terms</span> <span class="o">=</span> <span class="n">PenaltyParameters</span><span class="p">(</span><span class="n">penalty_chiral</span><span class="p">,</span> <span class="n">penalty_back</span><span class="p">,</span> <span class="n">penalty_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Peptide-Definition">
<h2>Peptide Definition<a class="headerlink" href="#Peptide-Definition" title="Permalink to this headline">¶</a></h2>
<p>Based on the main chain and possible side chains we define the peptide object that includes all the structural information of the modeled system.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">peptide</span> <span class="o">=</span> <span class="n">Peptide</span><span class="p">(</span><span class="n">main_chain</span><span class="p">,</span> <span class="n">side_chains</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Protein-Folding-Problem">
<h2>Protein Folding Problem<a class="headerlink" href="#Protein-Folding-Problem" title="Permalink to this headline">¶</a></h2>
<p>Based on the defined peptide, the interaction (contact map) and the penalty terms we defined for our model we define the protein folding problem that returns qubit operators.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">protein_folding_problem</span> <span class="o">=</span> <span class="n">ProteinFoldingProblem</span><span class="p">(</span><span class="n">peptide</span><span class="p">,</span> <span class="n">mj_interaction</span><span class="p">,</span> <span class="n">penalty_terms</span><span class="p">)</span>
<span class="n">qubit_op</span> <span class="o">=</span> <span class="n">protein_folding_problem</span><span class="o">.</span><span class="n">qubit_op</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">qubit_op</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1613.5895000000003 * IIIIIIIII
- 701.802 * ZIIIIIIII
- 904.2875 * IZIIIIIII
+ 192.5 * IIZIIIIII
- 200.0 * ZIZIIIIII
+ 7.5 * IZZIIIIII
+ 105.0 * IIIZIIIII
- 105.0 * ZIIZIIIII
+ 95.0 * IIZZIIIII
- 100.0 * ZIZZIIIII
+ 5.0 * IZZZIIIII
- 497.5 * IIIIZIIII
+ 195.0 * ZIIIZIIII
+ 302.5 * IZIIZIIII
- 95.0 * IIZIZIIII
+ 100.0 * ZIZIZIIII
- 2.5 * IZZIZIIII
- 100.0 * IIIIIZIII
+ 102.5 * ZIIIIZIII
- 2.5 * IZIIIZIII
- 95.0 * IIIZIZIII
+ 100.0 * ZIIZIZIII
- 2.5 * IZIZIZIII
- 300.0 * IIIIZZIII
+ 97.5 * ZIIIZZIII
+ 202.5 * IZIIZZIII
- 95.0 * IIZZZZIII
+ 100.0 * ZIZZZZIII
- 2.5 * IZZZZZIII
+ 487.5 * IIIIIIZII
- 195.0 * ZIIIIIZII
- 295.0 * IZIIIIZII
+ 97.5 * IIZIIIZII
- 100.0 * ZIZIIIZII
+ 2.5 * IZZIIIZII
- 195.0 * IIIIZIZII
+ 97.5 * ZIIIZIZII
+ 100.0 * IZIIZIZII
+ 100.0 * IIIIIIIZI
- 102.5 * ZIIIIIIZI
+ 2.5 * IZIIIIIZI
+ 97.5 * IIIZIIIZI
- 100.0 * ZIIZIIIZI
+ 2.5 * IZIZIIIZI
- 195.0 * IIIIIZIZI
+ 97.5 * ZIIIIZIZI
+ 100.0 * IZIIIZIZI
+ 295.0 * IIIIIIZZI
- 97.5 * ZIIIIIZZI
- 197.5 * IZIIIIZZI
+ 97.5 * IIZZIIZZI
- 100.0 * ZIZZIIZZI
+ 2.5 * IZZZIIZZI
- 195.0 * IIIIZZZZI
+ 97.5 * ZIIIZZZZI
+ 100.0 * IZIIZZZZI
+ 195.0 * IIIIIIIIZ
+ 5.0 * ZIIIIIIIZ
- 200.0 * IZIIIIIIZ
- 97.5 * IIIZIIIIZ
+ 100.0 * ZIIZIIIIZ
- 2.5 * IZIZIIIIZ
+ 97.5 * IIZZIIIIZ
- 100.0 * ZIZZIIIIZ
+ 2.5 * IZZZIIIIZ
+ 197.5 * IIIIIZIIZ
- 97.5 * ZIIIIZIIZ
- 100.0 * IZIIIZIIZ
- 197.5 * IIIIZZIIZ
+ 97.5 * ZIIIZZIIZ
+ 100.0 * IZIIZZIIZ
- 192.5 * IIIIIIIZZ
+ 97.5 * ZIIIIIIZZ
+ 97.5 * IZIIIIIZZ
+ 192.5 * IIIIIIZZZ
- 97.5 * ZIIIIIZZZ
- 97.5 * IZIIIIZZZ
</pre></div></div>
</div>
</div>
<div class="section" id="Using-VQE-with-CVaR-expectation-value-for-the-solution-of-the-problem">
<h2>Using VQE with CVaR expectation value for the solution of the problem<a class="headerlink" href="#Using-VQE-with-CVaR-expectation-value-for-the-solution-of-the-problem" title="Permalink to this headline">¶</a></h2>
<p>The problem that we are tackling has now implemented all the physical constraints and has a diagonal Hamiltonian. For the particular case we are targeting the single bitstring that gives us the minimum energy (corresponding to the folded structure of the protein). Thus, we can use the Variational Quantum Eigensolver with Conditional Value at Risk (CVaR) expectation values for the solution of the problem and for finding the minimum configuration energy [6] . We follow the same approach as in Ref.
[2] but here we use COBYLA for the classical optimization part. One can also use the standard VQE or QAOA algorithm for the solution of the problem, though as discussed in Ref. [2] CVaR is more suitable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">RealAmplitudes</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms.optimizers</span> <span class="kn">import</span> <span class="n">COBYLA</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms</span> <span class="kn">import</span> <span class="n">NumPyMinimumEigensolver</span><span class="p">,</span> <span class="n">VQE</span>
<span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">PauliExpectation</span><span class="p">,</span> <span class="n">CVaRExpectation</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">execute</span><span class="p">,</span> <span class="n">Aer</span>

<span class="c1"># set classical optimizer</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">COBYLA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># set variational ansatz</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">RealAmplitudes</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#set the backend</span>
<span class="n">backend_name</span> <span class="o">=</span> <span class="s1">&#39;aer_simulator&#39;</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span>
    <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="n">backend_name</span><span class="p">),</span>
    <span class="n">shots</span><span class="o">=</span><span class="mi">8192</span><span class="p">,</span>
    <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">algorithm_globals</span><span class="o">.</span><span class="n">random_seed</span><span class="p">,</span>
    <span class="n">seed_simulator</span><span class="o">=</span><span class="n">algorithm_globals</span><span class="o">.</span><span class="n">random_seed</span><span class="p">)</span>

<span class="n">counts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">store_intermediate_result</span><span class="p">(</span><span class="n">eval_count</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
    <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_count</span><span class="p">)</span>
    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>

<span class="c1"># initialize CVaR_alpha objective with alpha = 0.1</span>
<span class="n">cvar_exp</span> <span class="o">=</span> <span class="n">CVaRExpectation</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">PauliExpectation</span><span class="p">())</span>

<span class="c1"># initialize VQE using CVaR</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">expectation</span><span class="o">=</span><span class="n">cvar_exp</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">ansatz</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
          <span class="n">callback</span><span class="o">=</span><span class="n">store_intermediate_result</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">compute_minimum_eigenvalue</span><span class="p">(</span><span class="n">qubit_op</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;aux_operator_eigenvalues&#39;: None,
    &#39;cost_function_evals&#39;: 50,
    &#39;eigenstate&#39;: {   &#39;000000010&#39;: 0.011048543456039806,
                      &#39;000000011&#39;: 0.03125,
                      &#39;000000100&#39;: 0.011048543456039806,
                      &#39;000000101&#39;: 0.02209708691207961,
                      &#39;000001011&#39;: 0.011048543456039806,
                      &#39;000001101&#39;: 0.019136638615493577,
                      &#39;000010011&#39;: 0.024705294220065465,
                      &#39;000010100&#39;: 0.011048543456039806,
                      &#39;000010101&#39;: 0.02209708691207961,
                      &#39;000011011&#39;: 0.015625,
                      &#39;000011101&#39;: 0.02209708691207961,
                      &#39;000100010&#39;: 0.04133986423538423,
                      &#39;000100011&#39;: 0.10004881620988826,
                      &#39;000100100&#39;: 0.046875,
                      &#39;000100101&#39;: 0.08267972847076846,
                      &#39;000100111&#39;: 0.011048543456039806,
                      &#39;000110010&#39;: 0.019136638615493577,
                      &#39;000110011&#39;: 0.04419417382415922,
                      &#39;000110100&#39;: 0.015625,
                      &#39;000110101&#39;: 0.036643873123620545,
                      &#39;000110110&#39;: 0.011048543456039806,
                      &#39;000111011&#39;: 0.011048543456039806,
                      &#39;001000010&#39;: 0.029231698334171417,
                      &#39;001000011&#39;: 0.0897587913521567,
                      &#39;001000100&#39;: 0.03125,
                      &#39;001000101&#39;: 0.07328774624724109,
                      &#39;001000110&#39;: 0.011048543456039806,
                      &#39;001001010&#39;: 0.019136638615493577,
                      &#39;001001011&#39;: 0.04419417382415922,
                      &#39;001001100&#39;: 0.034938562148434216,
                      &#39;001001101&#39;: 0.04555431167847891,
                      &#39;001001111&#39;: 0.011048543456039806,
                      &#39;001010010&#39;: 0.036643873123620545,
                      &#39;001010011&#39;: 0.08486547258750168,
                      &#39;001010100&#39;: 0.03983608994994363,
                      &#39;001010101&#39;: 0.06442352540027595,
                      &#39;001010110&#39;: 0.011048543456039806,
                      &#39;001011000&#39;: 0.015625,
                      &#39;001011001&#39;: 0.015625,
                      &#39;001011010&#39;: 0.038273277230987154,
                      &#39;001011011&#39;: 0.11103648752774918,
                      &#39;001011100&#39;: 0.07411588266019639,
                      &#39;001011101&#39;: 0.11267347735824966,
                      &#39;001011110&#39;: 0.011048543456039806,
                      &#39;001011111&#39;: 0.015625,
                      &#39;001100000&#39;: 0.011048543456039806,
                      &#39;001100010&#39;: 0.120017902310447,
                      &#39;001100011&#39;: 0.3167677333236452,
                      &#39;001100100&#39;: 0.1401903003509872,
                      &#39;001100101&#39;: 0.22453293536249866,
                      &#39;001100110&#39;: 0.024705294220065465,
                      &#39;001100111&#39;: 0.034938562148434216,
                      &#39;001101010&#39;: 0.011048543456039806,
                      &#39;001101011&#39;: 0.019136638615493577,
                      &#39;001101100&#39;: 0.015625,
                      &#39;001101101&#39;: 0.027063293868263706,
                      &#39;001101111&#39;: 0.015625,
                      &#39;001110000&#39;: 0.011048543456039806,
                      &#39;001110010&#39;: 0.0427908248050911,
                      &#39;001110011&#39;: 0.1254873312828829,
                      &#39;001110100&#39;: 0.05063078670631141,
                      &#39;001110101&#39;: 0.0855816496101822,
                      &#39;001111011&#39;: 0.015625,
                      &#39;010000000&#39;: 0.011048543456039806,
                      &#39;010000010&#39;: 0.05412658773652741,
                      &#39;010000011&#39;: 0.137553256731711,
                      &#39;010000100&#39;: 0.05846339666834283,
                      &#39;010000101&#39;: 0.10881553341550093,
                      &#39;010000111&#39;: 0.02209708691207961,
                      &#39;010001000&#39;: 0.015625,
                      &#39;010001010&#39;: 0.024705294220065465,
                      &#39;010001011&#39;: 0.09882117688026186,
                      &#39;010001100&#39;: 0.05412658773652741,
                      &#39;010001101&#39;: 0.10305395279900718,
                      &#39;010001110&#39;: 0.015625,
                      &#39;010001111&#39;: 0.02209708691207961,
                      &#39;010010000&#39;: 0.015625,
                      &#39;010010010&#39;: 0.05412658773652741,
                      &#39;010010011&#39;: 0.15896085897949846,
                      &#39;010010100&#39;: 0.08193819126329309,
                      &#39;010010101&#39;: 0.12645635981436443,
                      &#39;010010110&#39;: 0.011048543456039806,
                      &#39;010010111&#39;: 0.019136638615493577,
                      &#39;010011000&#39;: 0.015625,
                      &#39;010011001&#39;: 0.011048543456039806,
                      &#39;010011010&#39;: 0.07574499777213015,
                      &#39;010011011&#39;: 0.19764235376052372,
                      &#39;010011100&#39;: 0.12789613706050704,
                      &#39;010011101&#39;: 0.20191949973937634,
                      &#39;010011110&#39;: 0.027063293868263706,
                      &#39;010011111&#39;: 0.04555431167847891,
                      &#39;010100000&#39;: 0.011048543456039806,
                      &#39;010100010&#39;: 0.07733980419227864,
                      &#39;010100011&#39;: 0.19295451617544482,
                      &#39;010100100&#39;: 0.09504316453590968,
                      &#39;010100101&#39;: 0.15428451295415233,
                      &#39;010100110&#39;: 0.019136638615493577,
                      &#39;010100111&#39;: 0.011048543456039806,
                      &#39;010101101&#39;: 0.019136638615493577,
                      &#39;010110010&#39;: 0.027063293868263706,
                      &#39;010110011&#39;: 0.08699631816921909,
                      &#39;010110100&#39;: 0.0427908248050911,
                      &#39;010110101&#39;: 0.059498227389561786,
                      &#39;010110110&#39;: 0.011048543456039806,
                      &#39;010110111&#39;: 0.011048543456039806,
                      &#39;011000011&#39;: 0.015625,
                      &#39;011000101&#39;: 0.015625,
                      &#39;011001011&#39;: 0.015625,
                      &#39;011001101&#39;: 0.015625,
                      &#39;011010011&#39;: 0.029231698334171417,
                      &#39;011010100&#39;: 0.015625,
                      &#39;011010101&#39;: 0.015625,
                      &#39;011011010&#39;: 0.011048543456039806,
                      &#39;011011011&#39;: 0.019136638615493577,
                      &#39;011011100&#39;: 0.011048543456039806,
                      &#39;011011101&#39;: 0.03125,
                      &#39;011011111&#39;: 0.011048543456039806,
                      &#39;011100010&#39;: 0.015625,
                      &#39;011100011&#39;: 0.05740991584648074,
                      &#39;011100100&#39;: 0.024705294220065465,
                      &#39;011100101&#39;: 0.04133986423538423,
                      &#39;011110011&#39;: 0.024705294220065465,
                      &#39;011110101&#39;: 0.015625,
                      &#39;100000011&#39;: 0.03983608994994363,
                      &#39;100000100&#39;: 0.02209708691207961,
                      &#39;100000101&#39;: 0.03125,
                      &#39;100001011&#39;: 0.019136638615493577,
                      &#39;100001100&#39;: 0.011048543456039806,
                      &#39;100001101&#39;: 0.029231698334171417,
                      &#39;100010010&#39;: 0.015625,
                      &#39;100010011&#39;: 0.036643873123620545,
                      &#39;100010100&#39;: 0.024705294220065465,
                      &#39;100010101&#39;: 0.03125,
                      &#39;100011000&#39;: 0.011048543456039806,
                      &#39;100011010&#39;: 0.024705294220065465,
                      &#39;100011011&#39;: 0.04555431167847891,
                      &#39;100011100&#39;: 0.036643873123620545,
                      &#39;100011101&#39;: 0.04555431167847891,
                      &#39;100011111&#39;: 0.011048543456039806,
                      &#39;100100000&#39;: 0.011048543456039806,
                      &#39;100100010&#39;: 0.0427908248050911,
                      &#39;100100011&#39;: 0.11481983169296148,
                      &#39;100100100&#39;: 0.046875,
                      &#39;100100101&#39;: 0.07654655446197431,
                      &#39;100100110&#39;: 0.015625,
                      &#39;100100111&#39;: 0.019136638615493577,
                      &#39;100101101&#39;: 0.011048543456039806,
                      &#39;100110010&#39;: 0.015625,
                      &#39;100110011&#39;: 0.03314563036811941,
                      &#39;100110100&#39;: 0.024705294220065465,
                      &#39;100110101&#39;: 0.03983608994994363,
                      &#39;100111011&#39;: 0.011048543456039806,
                      &#39;101000010&#39;: 0.038273277230987154,
                      &#39;101000011&#39;: 0.07890238233095373,
                      &#39;101000100&#39;: 0.03125,
                      &#39;101000101&#39;: 0.0625,
                      &#39;101001011&#39;: 0.036643873123620545,
                      &#39;101001100&#39;: 0.02209708691207961,
                      &#39;101001101&#39;: 0.04941058844013093,
                      &#39;101010010&#39;: 0.03125,
                      &#39;101010011&#39;: 0.06899813176818631,
                      &#39;101010100&#39;: 0.036643873123620545,
                      &#39;101010101&#39;: 0.05412658773652741,
                      &#39;101010111&#39;: 0.011048543456039806,
                      &#39;101011000&#39;: 0.011048543456039806,
                      &#39;101011010&#39;: 0.036643873123620545,
                      &#39;101011011&#39;: 0.09504316453590968,
                      &#39;101011100&#39;: 0.046875,
                      &#39;101011101&#39;: 0.08907620508587015,
                      &#39;101011110&#39;: 0.011048543456039806,
                      &#39;101011111&#39;: 0.024705294220065465,
                      &#39;101100000&#39;: 0.015625,
                      &#39;101100010&#39;: 0.12203515118604147,
                      &#39;101100011&#39;: 0.2814669302289347,
                      &#39;101100100&#39;: 0.13395647030845506,
                      &#39;101100101&#39;: 0.21986323874172325,
                      &#39;101100110&#39;: 0.02209708691207961,
                      &#39;101100111&#39;: 0.02209708691207961,
                      &#39;101101011&#39;: 0.011048543456039806,
                      &#39;101101100&#39;: 0.024705294220065465,
                      &#39;101101101&#39;: 0.015625,
                      &#39;101101111&#39;: 0.011048543456039806,
                      &#39;101110000&#39;: 0.011048543456039806,
                      &#39;101110010&#39;: 0.04555431167847891,
                      &#39;101110011&#39;: 0.10539638721275033,
                      &#39;101110100&#39;: 0.05524271728019903,
                      &#39;101110101&#39;: 0.08043461047646094,
                      &#39;101110110&#39;: 0.011048543456039806,
                      &#39;101110111&#39;: 0.015625,
                      &#39;101111011&#39;: 0.015625,
                      &#39;110000010&#39;: 0.02209708691207961,
                      &#39;110000011&#39;: 0.06720566614877052,
                      &#39;110000100&#39;: 0.038273277230987154,
                      &#39;110000101&#39;: 0.05740991584648074,
                      &#39;110001010&#39;: 0.02209708691207961,
                      &#39;110001011&#39;: 0.05182226234930312,
                      &#39;110001100&#39;: 0.027063293868263706,
                      &#39;110001101&#39;: 0.04555431167847891,
                      &#39;110001111&#39;: 0.011048543456039806,
                      &#39;110010010&#39;: 0.024705294220065465,
                      &#39;110010011&#39;: 0.08267972847076846,
                      &#39;110010100&#39;: 0.04941058844013093,
                      &#39;110010101&#39;: 0.06810779599282303,
                      &#39;110010111&#39;: 0.015625,
                      &#39;110011000&#39;: 0.011048543456039806,
                      &#39;110011010&#39;: 0.04419417382415922,
                      &#39;110011011&#39;: 0.10245997694221876,
                      &#39;110011100&#39;: 0.05633673867912483,
                      &#39;110011101&#39;: 0.09943689110435824,
                      &#39;110011110&#39;: 0.011048543456039806,
                      &#39;110011111&#39;: 0.011048543456039806,
                      &#39;110100010&#39;: 0.03314563036811941,
                      &#39;110100011&#39;: 0.10768788087570486,
                      &#39;110100100&#39;: 0.046875,
                      &#39;110100101&#39;: 0.07890238233095373,
                      &#39;110101101&#39;: 0.011048543456039806,
                      &#39;110110000&#39;: 0.011048543456039806,
                      &#39;110110010&#39;: 0.019136638615493577,
                      &#39;110110011&#39;: 0.04419417382415922,
                      &#39;110110100&#39;: 0.019136638615493577,
                      &#39;110110101&#39;: 0.029231698334171417,
                      &#39;111100010&#39;: 0.029231698334171417,
                      &#39;111100011&#39;: 0.05846339666834283,
                      &#39;111100100&#39;: 0.027063293868263706,
                      &#39;111100101&#39;: 0.03983608994994363,
                      &#39;111101100&#39;: 0.011048543456039806,
                      &#39;111110011&#39;: 0.02209708691207961,
                      &#39;111110100&#39;: 0.015625,
                      &#39;111110101&#39;: 0.015625},
    &#39;eigenvalue&#39;: -1.4029738769529685,
    &#39;optimal_parameters&#39;: {   ParameterVectorElement(θ[3]): -0.8186867402589327,
                              ParameterVectorElement(θ[0]): 2.949180306189535,
                              ParameterVectorElement(θ[2]): 0.14444186020294084,
                              ParameterVectorElement(θ[1]): 1.3457240264704409,
                              ParameterVectorElement(θ[4]): -1.8240547294565919,
                              ParameterVectorElement(θ[5]): -0.5827243733538114,
                              ParameterVectorElement(θ[6]): -1.2832898975245257,
                              ParameterVectorElement(θ[7]): 0.4624546118844573,
                              ParameterVectorElement(θ[8]): 0.8545861177349986,
                              ParameterVectorElement(θ[9]): 0.9009227496535541,
                              ParameterVectorElement(θ[10]): 1.0664066215537364,
                              ParameterVectorElement(θ[11]): -1.168411616516486,
                              ParameterVectorElement(θ[12]): -0.9257640933096077,
                              ParameterVectorElement(θ[13]): 2.4469152902217863,
                              ParameterVectorElement(θ[14]): 1.6982911959520248,
                              ParameterVectorElement(θ[15]): -0.8473176376463815,
                              ParameterVectorElement(θ[16]): -2.028888948827069,
                              ParameterVectorElement(θ[17]): 0.3825263440080858},
    &#39;optimal_point&#39;: array([ 2.94918031,  1.06640662, -1.16841162, -0.92576409,  2.44691529,
        1.6982912 , -0.84731764, -2.02888895,  0.38252634,  1.34572403,
        0.14444186, -0.81868674, -1.82405473, -0.58272437, -1.2832899 ,
        0.46245461,  0.85458612,  0.90092275]),
    &#39;optimal_value&#39;: -1.4029738769529685,
    &#39;optimizer_evals&#39;: 50,
    &#39;optimizer_time&#39;: 34.98536920547485}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conformation Energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;VQE Iterations&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.44</span><span class="p">,</span><span class="mf">0.51</span><span class="p">,</span><span class="mf">0.44</span><span class="p">,</span><span class="mf">0.32</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">40</span><span class="p">:],</span><span class="n">values</span><span class="p">[</span><span class="mi">40</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conformation Energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;VQE Iterations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_09_Protein_Folding_30_0.png" src="../_images/tutorials_09_Protein_Folding_30_0.png" />
</div>
</div>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h2>
<p>[1] <a class="reference external" href="https://en.wikipedia.org/wiki/Levinthal%27s_paradox">https://en.wikipedia.org/wiki/Levinthal%27s_paradox</a></p>
<p>[2] A.Robert, P.Barkoutsos, S.Woerner and I.Tavernelli, Resource-efficient quantum algorithm for protein folding, NPJ Quantum Information, 2021, <a class="reference external" href="https://doi.org/10.1038/s41534-021-00368-4">https://doi.org/10.1038/s41534-021-00368-4</a></p>
<p>[3] IUPAC–IUB Commission on Biochemical Nomenclature (1972). “A one-letter notation for aminoacid sequences”. Pure and Applied Chemistry. 31 (4): 641–645. doi:10.1351/pac197231040639. PMID 5080161.</p>
<p>[4] <a class="reference external" href="https://en.wikipedia.org/wiki/Amino_acid">https://en.wikipedia.org/wiki/Amino_acid</a></p>
<p>[5] S. Miyazawa and R. L.Jernigan, Residue – Residue Potentials with a Favorable Contact Pair Term and an Unfavorable High Packing Density Term for Simulation and Threading, J. Mol. Biol.256, 623–644, 1996, Table 3, <a class="reference external" href="https://doi.org/10.1006/jmbi.1996.0114">https://doi.org/10.1006/jmbi.1996.0114</a></p>
<p>[6] P.Barkoutsos, G. Nannichini, A.Robert, I.Tavernelli, S.Woerner, Improving Variational Quantum Optimization using CVaR, Quantum 4, 256, 2020, <a class="reference external" href="https://doi.org/10.22331/q-2020-04-20-256">https://doi.org/10.22331/q-2020-04-20-256</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.26.2</td></tr><tr><td>Terra</td><td>0.18.0.dev0+33e7448</td></tr><tr><td>Aer</td><td>0.8.2</td></tr><tr><td>Ignis</td><td>0.6.0</td></tr><tr><td>Aqua</td><td>0.9.1</td></tr><tr><td>IBM Q Provider</td><td>0.13.1</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.7.10 (default, Feb 26 2021, 10:16:00)
[Clang 10.0.0 ]</td></tr><tr><td>OS</td><td>Darwin</td></tr><tr><td>CPUs</td><td>6</td></tr><tr><td>Memory (Gb)</td><td>16.0</td></tr><tr><td colspan='2'>Sat Aug 14 08:53:41 2021 CEST</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2021.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../release_notes.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="08_property_framework.html" class="btn btn-neutral" title="The Property Framework" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, 2021, Qiskit Nature Development Team.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Protein Folding</a><ul>
<li><a class="reference internal" href="#Introduction">Introduction</a></li>
<li><a class="reference internal" href="#Protein-Main-Chain">Protein Main Chain</a></li>
<li><a class="reference internal" href="#Side-Chains">Side Chains</a></li>
<li><a class="reference internal" href="#Interaction-between-Aminoacids">Interaction between Aminoacids</a></li>
<li><a class="reference internal" href="#Physical-Constraints">Physical Constraints</a></li>
<li><a class="reference internal" href="#Peptide-Definition">Peptide Definition</a></li>
<li><a class="reference internal" href="#Protein-Folding-Problem">Protein Folding Problem</a></li>
<li><a class="reference internal" href="#Using-VQE-with-CVaR-expectation-value-for-the-solution-of-the-problem">Using VQE with CVaR expectation value for the solution of the problem</a></li>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
         <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="../getting_started.html">Getting Started</a>
          </li>
          <li>
            <a href="https://qiskit.org/documentation/nature/tutorials/index.html" target="_blank">Tutorials</a>
          </li>
          <li>
            <a href="https://qiskit.org/documentation/partners/">Partners</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Applications
          </li>
          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.org/documentation/machine-learning/">Machine learning</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/nature/">Nature</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/finance/">Finance</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/optimization/">Optimization</a>
            </li>
          </ul>
          <br>
          <li>
            <a href="https://qiskit.org/documentation/experiments/">Experiments</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.slack.com">Slack support</a>
            </li>
          </ul>
          <br>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>