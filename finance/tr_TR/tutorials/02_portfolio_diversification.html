


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="tr-TR" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="tr-TR" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Portföy çeşitlendirme &mdash; Qiskit Finance 0.2.1 belgelendirmesi</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Dizin" href="../genindex.html" />
    <link rel="search" title="Arama" href="../search.html" />
    <link rel="next" title="Pricing European Call Options" href="03_european_call_option_pricing.html" />
    <link rel="prev" title="Portföy Optimizasyonu" href="01_portfolio_optimization.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/documentation/">Qiskit Documentation</a>
          </li>

          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/finance/tutorials/index.html" target="_blank">Tutorials</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/qiskit-finance" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">tr_TR</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Diller</dt>
      
        <dd><a class="version" href="/documentation/finance/tutorials/02_portfolio_diversification.html">English</a></dd>
      
    </dl>
    
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  0.2.1
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Başlangıç</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidocs/qiskit_finance.html">API Referansı</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Öğreticiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Sürüm Notları</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="index.html">Finance Tutorials</a> &gt;</li>
        
      <li>Portföy çeşitlendirme</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/02_portfolio_diversification.ipynb.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">Not</p>
<p>Bu sayfa <a class="reference external" href="https://github.com/Qiskit/qiskit-finance/blob/stable/0.2/docs/tutorials/02_portfolio_diversification.ipynb">docs/tutorials/02_portfolio_diversification.ipynb</a> sayfasından oluşturulmuştur.</p>
</div>
<div class="section" id="Portföy-çeşitlendirme">
<h1>Portföy çeşitlendirme<a class="headerlink" href="#Portföy-çeşitlendirme" title="Bu başlık için kalıcı bağlantı">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>Varlık yönteminde, genellikle iki yaklaşım vardır. Bunlar: aktif ve pasif yatırım yönetimi. Pasif yatırım yönetiminde, endeks takip fonları ve portföy çeşitlendirmesine dayalı yaklaşımlar bulunmaktadır. Bu yaklaşımlar, çok sayıda varlığa sahip bir portföyü daha az sayıda temsili hisse senedi ile temsil etmeyi amaçlamaktadır. Bu not defteri, son zamanlarda iki nedenden dolayı popüler hale gelen bir portföy çeşitlendirme sorununu örneklerle açıklamaktadır: 1. bir endeksin (veya benzer şekilde büyük bir varlık grubunun) performansını sınırlı bir bütçeyle, sınırlı işlem maliyetleriyle taklit etmeyi mümkün kılar. Yani: geleneksel endeks takibi, endeksteki tüm varlıkları, ideal olarak endeksteki aynı ağırlıklarda satın alabilir. Bu, birkaç nedenden ötürü pratik olmayabilir: varlık başına tek bir yuvarlak lotun toplamı, yönetilen varlıklardan daha fazlasına ulaşabilir, tümlevsel koşulları olan indeks takibi probleminin büyüklüğü optimizasyon problemini zorlaştırabilir ve pozisyonları endeksteki ağırlıklara göre ayarlamak için sık sık yeniden dengelemenin işlem maliyetleri, yaklaşımı pahalı hale getirebilir. Bu nedenle, <span class="math notranslate nohighlight">\(q\)</span>’nun <span class="math notranslate nohighlight">\(n\)</span>’den önemli ölçüde küçük olduğu ancak portföyün, piyasanın davranışını kopyaladığı, <span class="math notranslate nohighlight">\(n\)</span> varlıkla pazarı temsil eden <span class="math notranslate nohighlight">\(q\)</span> varlık portföyü seçmek popüler bir yaklaşımdır. Varlıkların <span class="math notranslate nohighlight">\(q\)</span> kümelerine nasıl gruplanacağını belirlemek ve hangi <span class="math notranslate nohighlight">\(q\)</span> varlıklarının <span class="math notranslate nohighlight">\(q\)</span> kümelerini temsil edeceğini nasıl belirleneceğini belirlemek büyük ölçekli bir optimizasyon problemini çözmek demektir. Aşağıda, [Cornuejols ve Tutuncu, 2006] ‘da gösterilen portföy çeşitlendirme problemi için matematiksel modeli açıklıyoruz. 2. Bu, kovaryans matrisinin ötesinde zaman serileri arasında benzerlik ölçümlerine izin verir. Geleneksel olarak, modern portföy teorisi, kovaryans matrisi, varlıklar arasındaki benzerliğin ölçüsü olarak değerlendirmektedir. Bununla birlikte, kovaryans matrisi eksiktir. Örneğin, bir şirketin hem Londra’da hem de New York’da listelendiğini düşünün. İkisinin de çok benzer olması gerekmesine rağmen, piyasaların açılma zamanlarının kısmi olarak örtüşmesi sebebiyle, fiyatlarının zaman serilerinin sadece bazı kısımları örtüşecektir. Kovaryans yerine, örneğin [Berndt ve Clifford, 1994] ‘ün dinamik zaman atlaması iki zaman serisi arasındaki benzerliğin bir ölçüsü olarak değerlendirilebilir. Bu, bazı zaman aralıkları için verinin sadece tek bir zaman serisi tarafından yakalanmasını sağlar, diğerleri içinse, hisse senedi fiyatının paralel olarak ilerlemesinden dolayı her iki zaman serisi benzerlik göstermektedir.</p>
<p>Gösterdiğimiz genel iş akışı şunları içerir:</p>
<ol class="arabic simple">
<li><p>temel varlık kümesini seçin. Bizim durumumuzda, bu az sayıda ABD hisse senedidir.</p></li>
<li><p>varlık fiyatlarının değişimini gösteren zaman serilerini yükleyin. Bizim örneğimizde bu, Wikipedia, Nasdaq, LSE veya EuroNext’ten alınan ayarlanmış günlük kapanış fiyat verilerinin basit bir yüklemesidir, oysa gerçek bir varlık yönetiminde, çok daha yüksek bir frekans değerlendirilebilir.</p></li>
<li><p>zaman serileri arasındaki ikili benzerliği hesaplayın. Bizim durumumuzda, dinamik zaman atlamasının doğrusal zaman yaklaştırımını hala klasik bilgisayarda çalıştırıyoruz.</p></li>
<li><p>benzerlik ölçüsüne göre temsil edecek nitelikteki <span class="math notranslate nohighlight">\(q\)</span> varlığının gerçek portföyünü hesaplayın. Bu adım aslında iki kez çalıştırılır. İlk olarak, klasik bilgisayarda bir IBM çözüm aracının (IBM ILOG CPLEX veya Exact Eigensolver) çalıştırılmasıyla bir referans değeri elde ederiz. İkinci olarak, kuantum bilgisayarda alternatif, hibrit bir algoritmayı kısmen çalıştırırız.</p></li>
<li><p>sonuçların görselleştirilmesi. Bizim durumumuzda, bu yine basit bir çizim.</p></li>
</ol>
<p>Aşağıda, ön koşulların kurulumu ve veri yükleme işlemine geçmeden önce yukarıda (4)‘te kullanılan modeli açıklıyoruz.</p>
</div>
<div class="section" id="Model">
<h2>Model<a class="headerlink" href="#Model" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>[Cornuejols &amp; Tutuncu, 2006]‘da ele alındığı gibi, varlıkları benzer gruplar halinde kümeleyen ve her gruptan endeks fon portföyüne dahil edilecek temsili bir varlık seçen matematiksel bir model tanımlıyoruz. Model, daha sonra ayrıntılı olarak ele alacağımız aşağıdaki verilere dayanmaktadır:</p>
<div class="math notranslate nohighlight">
\[\rho_{ij} = \textrm{similarity}\, \textrm{between}\, \textrm{stock}\, i \, \textrm{and}\, \textrm{stock}\, j.\]</div>
<p>Örneğin, <span class="math notranslate nohighlight">\(i \neq j\)</span> ve <span class="math notranslate nohighlight">\(\rho_{ij}\)</span> için <span class="math notranslate nohighlight">\(\rho_{ii} = 1\)</span>, <span class="math notranslate nohighlight">\(\rho_{ij} \leq 1\)</span> daha benzer hisse senetleri için daha büyüktür. Hisse senedi getirileri <span class="math notranslate nohighlight">\(i\)</span> ve <span class="math notranslate nohighlight">\(j\)</span> arasındaki korelasyon bunun bir örneğidir. Fakat diğer benzerlik indeksleri <span class="math notranslate nohighlight">\(\rho_{ij}\)</span> seçilebilir.</p>
<p>Çözmeye çalıştığımız problem şudur:</p>
<div class="math notranslate nohighlight">
\[(M) \quad  f = \max_{x_{ij}, y_{j}} \,\, \sum_{i=1}^n \sum_{j=1}^n \rho_{ij} x_{ij}\]</div>
<p>kümeleme kısıtlamasına tabi:</p>
<div class="math notranslate nohighlight">
\[\sum_{j=1}^n y_j = q,\]</div>
<p>tutarlılık koşullarına:</p>
<div class="math notranslate nohighlight">
\[\sum_{j=1}^n x_{ij} = 1, \,\textrm{ for }\,  i = 1,\ldots, n,
\quad x_{ij} \leq y_j,\,\textrm{ for }\,  i = 1,\ldots, n; \, j = 1,\ldots, n,
\quad x_{jj} = y_j,\,\textrm{ for }\,  j = 1,\ldots, n,\]</div>
<p>ve integral kısıtlamaları:</p>
<div class="math notranslate nohighlight">
\[\quad  x_{ij}, y_j \in\{0,1\}, \,\textrm{ for }\,  i = 1,\ldots, n; \, j = 1,\ldots, n.\]</div>
<p><span class="math notranslate nohighlight">\(y_j\)</span> değişkenleri hangi <span class="math notranslate nohighlight">\(j\)</span> hisse senetlerinin endeks fonunda olduğunu ifade eder (eğer <span class="math notranslate nohighlight">\(j\)</span> fonda seçildiyse <span class="math notranslate nohighlight">\(y_j = 1\)</span>, seçilmediyse <span class="math notranslate nohighlight">\(0\)</span>). Her bir <span class="math notranslate nohighlight">\(i = 1,\dots,n\)</span> hisse senedi için, <span class="math notranslate nohighlight">\(x_{ij}\)</span> değişkeni endeks fonundaki hangi <span class="math notranslate nohighlight">\(j\)</span> hisse senedinin <span class="math notranslate nohighlight">\(i\)</span>’ye en çok benzediğini gösterir (fondaki en benzer hisse senedi <span class="math notranslate nohighlight">\(j\)</span> ise <span class="math notranslate nohighlight">\(x_{ij} = 1\)</span>, değilse <span class="math notranslate nohighlight">\(0\)</span>).</p>
<p>Birinci koşul, fondaki <span class="math notranslate nohighlight">\(q\)</span> hisse senedini seçer. İkinci koşul, her <span class="math notranslate nohighlight">\(i\)</span> hisse senedinin fonda tam olarak bir temsili <span class="math notranslate nohighlight">\(j\)</span> hisse senedine sahip olduğunu belirtir. Üçüncü ve dördüncü koşullar, <span class="math notranslate nohighlight">\(i\)</span> hisse senedinin yalnızca <span class="math notranslate nohighlight">\(j\)</span>’nin fonda olması durumunda <span class="math notranslate nohighlight">\(j\)</span> hisse senedi ile temsil edilebileceğini garanti etmektedir. Modelin amacı, <span class="math notranslate nohighlight">\(n\)</span> hisse senetleri ile fondaki temsilcileri arasındaki benzerliği maksimuma çıkarmaktır. Farklı maliyet fonksiyonları da düşünülebilir.</p>
<p>Karar değişkenlerini bir vektörde birleştirelim</p>
<div class="math notranslate nohighlight">
\[{\bf z} = [x_{11},x_{12},\ldots,x_{1n}, x_{22},\ldots,x_{nn}, y_{1},\ldots,y_{n}],\]</div>
<p>boyutu <span class="math notranslate nohighlight">\(N = n (n+1)\)</span> olacak şekilde <span class="math notranslate nohighlight">\({\bf z} \in \{0,1\}^N\)</span>‘dir ve <span class="math notranslate nohighlight">\({\bf z}^*\)</span> ile en uygunu çözümü ve en uygun maliyet <span class="math notranslate nohighlight">\(f^*\)</span>’i göstermektedir.</p>
</div>
<div class="section" id="Hibrit-Bir-Yaklaşım">
<h2>Hibrit Bir Yaklaşım<a class="headerlink" href="#Hibrit-Bir-Yaklaşım" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>Burada, Farhi, Goldstone ve Gutman’ın (2014) kuantum yaklaşık optimizasyon yöntemini izleyerek klasik ve kuantum hesaplama adımlarını birleştiren bir yöntemi gösteriyoruz.</p>
<div class="section" id="İkili-bir-polinom-optimizasyonu-oluşturun">
<h3>İkili bir polinom optimizasyonu oluşturun<a class="headerlink" href="#İkili-bir-polinom-optimizasyonu-oluşturun" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p><span class="math notranslate nohighlight">\(x_{ij} \leq y_j\)</span> eşitsizlik koşulları, eşdeğer eşitlik koşulları <span class="math notranslate nohighlight">\(x_{ij} (1- y_j) = 0\)</span> ile değiştirilerek sadece eşitlik koşulları ile <span class="math notranslate nohighlight">\((M)\)</span>‘den ikili bir polinom optimizasyonu oluşturulabilmektedir. O zaman problem şuna dönüşür:</p>
<div class="math notranslate nohighlight">
\[(BPO) \quad  f = \max_{x_{ij}, y_{j}} \,\, \sum_{i=1}^n \sum_{j=1}^n \rho_{ij} x_{ij}\]</div>
<p>kümeleme kısıtlamasına, integral kısıtlamalarına ve aşağıdaki değiştirilmiş tutarlılık kısıtlamalarına tabidir:</p>
<div class="math notranslate nohighlight">
\[\sum_{j=1}^n x_{ij} = 1, \,\textrm{ for }\,  i = 1,\ldots, n,\]</div>
<div class="math notranslate nohighlight">
\[\quad x_{ij} (1- y_j) = 0,\,\textrm{ for }\,  i = 1,\ldots, n; \, j = 1,\ldots, n,\]</div>
<div class="math notranslate nohighlight">
\[\quad x_{jj} = y_j,\,\textrm{ for }\,  j = 1,\ldots, n.\]</div>
</div>
<div class="section" id="Ising-Hamilton’u-Oluşturun">
<h3>Ising Hamilton’u Oluşturun<a class="headerlink" href="#Ising-Hamilton’u-Oluşturun" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p>Artık Ising Hamiltonian’ı (QUBO) ceza yöntemleriyle (her bir eşitlik kısıtı için bir ceza katsayısı <span class="math notranslate nohighlight">\(A\)</span> ekleyerek) şu şekilde oluşturabiliriz</p>
<div class="math notranslate nohighlight">
\[(IH) \quad H = \sum_{i=1}^n \sum_{j=1}^n \rho_{ij} x_{ij} + A\Big( \sum_{j=1}^n y_j - q\Big)^2 + \sum_{i=1}^n A\Big( \sum_{j=1}^n x_{ij} - 1\Big)^2 + \sum_{j=1}^n A (x_{jj}-y_j)^2 +\sum_{i=1}^n \sum_{j=1}^n A \left(x_{ij} (1- y_j)\right).\]</div>
</div>
<div class="section" id="Hamiltonyen'den-Kuadratik-Programlama-(KP)-formülasyonuna">
<h3>Hamiltonyen’den Kuadratik Programlama (KP) formülasyonuna<a class="headerlink" href="#Hamiltonyen'den-Kuadratik-Programlama-(KP)-formülasyonuna" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p><span class="math notranslate nohighlight">\({\bf z}\)</span> vektöründe, Ising Hamiltonyen öğeleri aşağıdaki gibi yazılabilir,</p>
<p>İlk terim:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^n \sum_{j=1}^n \rho_{ij} x_{ij} = [\rho_{11},\rho_{12},\ldots,\rho_{11}, \rho_{22},\ldots,\rho_{nn}|{\bf 0}_n ]{\bf z} =: {\bf c}_0^T {\bf z}\]</div>
<p>İkinci terim:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A\Big( \sum_{j=1}^n y_j - q\Big)^2 = A \Big(\sum_{j=1}^n y_j\Big)^2 - 2 Aq \sum_{j=1}^n y_j + A q^2 = A {\bf z}^T \left[\begin{array}{c}{\bf 0}_{n^2} \\ \hline  {\bf 1}_n  \end{array}\right]\left[\begin{array}{cc}{\bf 0}_{n^2} | {\bf 1}_n  \end{array}\right]{\bf z} - 2 A q [{\bf 0}_{n^2}|{\bf 1}_n]{\bf z} + A q^2 =: {\bf z}^T {\bf Q}_0 {\bf z} + {\bf c}_1^T {\bf z} + r_0\end{split}\]</div>
<p>Üçüncü terim:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^n A\Big( \sum_{j=1}^n x_{ij} - 1\Big)^2 = A\sum_{i=1}^n \Big(\sum_{j=1}^n x_{ij}\Big)^2 - 2 A \sum_{i=1}^n\sum_{j=1}^n x_{ij} + n A = \qquad\qquad\qquad\qquad\qquad\qquad\qquad\]</div>
<p>bu da aşağıdakine eşittir:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\qquad\qquad\qquad\qquad\qquad\qquad\qquad = A {\bf z}^T \left(\sum_{i=1}^n \left[\begin{array}{c}{\bf 0}_{n(i-1)}  \\ {\bf 1}_n  \\ {\bf 0}_{n(n-i)} \\ \hline {\bf 0}_{n} \end{array}\right]\left[\begin{array}{cccc}{\bf 0}_{n(i-1)} &amp; {\bf 1}_n  &amp; {\bf 0}_{n(n-i)} &amp; | {\bf 0}_{n} \end{array}\right]\right){\bf z} - 2 A [{\bf 1}_{n^2}|{\bf 0}_n]{\bf z} + n A =: {\bf z}^T {\bf Q}_1 {\bf z} + {\bf c}_2^T {\bf z} + r_1\end{split}\]</div>
<p>Dördüncü terim:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A \sum_{j=1}^n  (x_{jj}-y_j)^2 = A {\bf z}^T  \left(\sum_{j=0}^{n-1} \left[\begin{array}{c}{\bf 0}_{nj + j}  \\ 1  \\ {\bf 0}_{n^2-(nj+j+1)} \\ \hline {\bf 0}_{j} \\ -1 \\ {\bf 0}_{n-j-1} \end{array}\right]\left[\begin{array}{cccccc}{\bf 0}_{nj + j} &amp; 1  &amp; {\bf 0}_{n^2-(nj+j+1)} &amp; | {\bf 0}_{j} &amp; -1 &amp; {\bf 0}_{n-j-1}  \end{array}\right]\right){\bf z} = A {\bf z}^T {\bf Q}_2 {\bf z}\end{split}\]</div>
<p>Beşinci terim:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\sum_{i=1}^n \sum_{j=1}^n A \left(x_{ij} (1- y_j)\right) = A [{\bf 1}_{n^2}|{\bf 0}_n]{\bf z} + A {\bf z}^T \left( \sum_{i=1}^n \sum_{j=1}^n \left[\begin{array}{ccc|c}  &amp;  &amp; &amp; \\ &amp; {\bf 0}_{n^2\times n^2} &amp; &amp; -1/2_{(ij,j)}  \\ &amp; &amp; &amp; \\ \hline &amp; -1/2_{(j, ij)} &amp;  &amp; {\bf 0}_{n} \end{array}\right] \right) {\bf z} =:  {\bf z}^T {\bf Q}_3 {\bf z} + {\bf c}_3^T {\bf z}\end{split}\]</div>
<p>Böylece, formülasyon şu hale gelir,</p>
<div class="math notranslate nohighlight">
\[(IH-QP)\quad \max_{{\bf z}\in\{0,1\}^{n(n+1)}} \, {\bf z}^T ({\bf Q}_0+{\bf Q}_1+ {\bf Q}_2 + {\bf Q}_3 ){\bf z} + ({\bf c}_0+{\bf c}_1+{\bf c}_2+{\bf c}_3)^T {\bf z} +r_0+r_1+r_2\]</div>
<p>variational quantum eigensolver‘a geçirilebilir.</p>
</div>
</div>
<div class="section" id="Kaynaklar">
<h2>Kaynaklar<a class="headerlink" href="#Kaynaklar" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>[1] G. Cornuejols, M. L. Fisher, and G. L. Nemhauser, <em>Location of bank accounts to optimize float: an analytical study of exact and approximate algorithms</em>, Management Science, vol. 23(8), 1997</p>
<p>[2] E. Farhi, J. Goldstone, S. Gutmann e-print <a class="reference external" href="https://arxiv.org/abs/1411.4028">arXiv 1411.4028, 2014</a></p>
<p>[3] G. Cornuejols and R. Tutuncu, <a class="reference external" href="http://web.math.ku.dk/~rolf/CT_FinOpt.pdf">Optimization methods in finance</a>, 2006</p>
<p>[4] DJ. Berndt and J. Clifford, <em>Using dynamic time warping to find patterns in time series</em>. In KDD workshop 1994 (Vol. 10, No. 16, pp. 359-370).</p>
<p>[5] <a class="reference external" href="https://github.com/Qiskit/qiskit-optimization/blob/main/docs/tutorials/06_examples_max_cut_and_tsp.ipynb">Max-Cut and Traveling Salesman Problem</a></p>
</div>
<div class="section" id="Uygulama">
<h2>Uygulama<a class="headerlink" href="#Uygulama" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>İlk olarak, gerekli modülleri içe aktarıyoruz.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import requisite modules</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Import Qiskit packages</span>
<span class="kn">import</span> <span class="nn">qiskit</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms</span> <span class="kn">import</span> <span class="n">VQE</span><span class="p">,</span> <span class="n">QAOA</span><span class="p">,</span> <span class="n">NumPyMinimumEigensolver</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms.optimizers</span> <span class="kn">import</span> <span class="n">COBYLA</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">TwoLocal</span>
<span class="kn">from</span> <span class="nn">qiskit.utils</span> <span class="kn">import</span> <span class="n">QuantumInstance</span>
<span class="kn">from</span> <span class="nn">qiskit_optimization.algorithms</span> <span class="kn">import</span> <span class="n">MinimumEigenOptimizer</span>
<span class="c1"># The data providers of stock-market data</span>
<span class="kn">from</span> <span class="nn">qiskit_finance.data_providers</span> <span class="kn">import</span> <span class="n">RandomDataProvider</span>
<span class="kn">from</span> <span class="nn">qiskit_finance.applications.optimization</span> <span class="kn">import</span> <span class="n">PortfolioDiversification</span>
</pre></div>
</div>
</div>
<p>Next, we download price data for two stocks and compute their pair-wise similarity matrix (<a class="reference external" href="https://en.wikipedia.org/wiki/Dynamic_time_warping">dynamic time warping</a> distance normalized to (0,1] by taking the reciprocal). If this fails, e.g., due to you being offline or exceeding the daily limit for accesses to the stock-market data, we consider a constant matrix instead.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Generate a pairwise time-series similarity matrix</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">123</span>

<span class="n">stocks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;TICKER1&quot;</span><span class="p">,</span> <span class="s2">&quot;TICKER2&quot;</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stocks</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">RandomDataProvider</span><span class="p">(</span><span class="n">tickers</span> <span class="o">=</span> <span class="n">stocks</span><span class="p">,</span>
                 <span class="n">start</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                 <span class="n">end</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span>
                 <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_similarity_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Şimdi küme sayılarına karar veriyoruz. Bu, yüklediğimiz hisse senetlerinin sayısından daha küçük olmalı.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># q less or equal than n</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="IBM-ILOG-CPLEX-kullanılarak-klasik-çözüm">
<h2>IBM ILOG CPLEX kullanılarak klasik çözüm<a class="headerlink" href="#IBM-ILOG-CPLEX-kullanılarak-klasik-çözüm" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>Klasik bir çözüm için IBM CPLEX kullanırız. CPLEX, bu sorunun tam çözümünü bulabilmektedir. Önce, problemi CPLEX’in çözebileceği şekilde kodlayan bir ClassicalOptimizer sınıfı tanımlıyoruz ve ardından sınıfı örnekleyerek çözüyoruz.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">ClassicalOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>  <span class="c1"># number of inner variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">q</span>  <span class="c1"># number of required selection</span>

    <span class="k">def</span> <span class="nf">compute_allowed_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">cplex_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># refactoring</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>

        <span class="n">my_obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>
        <span class="n">my_ub</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="p">)]</span>
        <span class="n">my_lb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="p">)]</span>
        <span class="n">my_ctype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;I&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="p">)])</span>

        <span class="n">my_rhs</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span> <span class="o">+</span><span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)]</span>
        <span class="n">my_sense</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;E&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)])</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;E&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)])</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;L&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">my_prob</span> <span class="o">=</span> <span class="n">cplex</span><span class="o">.</span><span class="n">Cplex</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populatebyrow</span><span class="p">(</span><span class="n">my_prob</span><span class="p">,</span> <span class="n">my_obj</span><span class="p">,</span> <span class="n">my_ub</span><span class="p">,</span> <span class="n">my_lb</span><span class="p">,</span> <span class="n">my_ctype</span><span class="p">,</span> <span class="n">my_sense</span><span class="p">,</span> <span class="n">my_rhs</span><span class="p">)</span>

            <span class="n">my_prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

        <span class="k">except</span> <span class="n">CplexError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">my_prob</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">my_prob</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">get_objective_value</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">cost</span>

    <span class="k">def</span> <span class="nf">populatebyrow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">my_obj</span><span class="p">,</span> <span class="n">my_ub</span><span class="p">,</span> <span class="n">my_lb</span><span class="p">,</span> <span class="n">my_ctype</span><span class="p">,</span> <span class="n">my_sense</span><span class="p">,</span> <span class="n">my_rhs</span><span class="p">):</span>

        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>

        <span class="n">prob</span><span class="o">.</span><span class="n">objective</span><span class="o">.</span><span class="n">set_sense</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">objective</span><span class="o">.</span><span class="n">sense</span><span class="o">.</span><span class="n">minimize</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">my_obj</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="n">my_lb</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="n">my_ub</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="n">my_ctype</span><span class="p">)</span>

        <span class="n">prob</span><span class="o">.</span><span class="n">set_log_stream</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">set_error_stream</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">set_warning_stream</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">set_results_stream</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)]</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">col</span><span class="p">,</span> <span class="n">coef</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">ii</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">ii</span><span class="p">)]</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>

            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">col</span><span class="p">,</span> <span class="n">coef</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="n">ii</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">ii</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ii</span><span class="p">]</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">col</span><span class="p">,</span> <span class="n">coef</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="n">ii</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="n">jj</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">jj</span><span class="p">]</span>
                <span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">col</span><span class="p">,</span> <span class="n">coef</span><span class="p">])</span>

        <span class="n">prob</span><span class="o">.</span><span class="n">linear_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">lin_expr</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">senses</span><span class="o">=</span><span class="n">my_sense</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">my_rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instantiate the classical optimizer class</span>
<span class="n">classical_optimizer</span> <span class="o">=</span> <span class="n">ClassicalOptimizer</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="c1"># Compute the number of feasible solutions:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of feasible combinations= &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">classical_optimizer</span><span class="o">.</span><span class="n">compute_allowed_combinations</span><span class="p">()))</span>

<span class="c1"># Compute the total number of possible combinations (feasible + unfeasible)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total number of combinations= &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of feasible combinations= 2
Total number of combinations= 64
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Visualize the solution</span>
<span class="k">def</span> <span class="nf">visualize_solution</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">title_str</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xc</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.015</span><span class="p">,</span> <span class="n">yc</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span> <span class="n">yc</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">iy</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">//</span> <span class="n">n</span>
            <span class="n">ix</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">%</span> <span class="n">n</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xc</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">xc</span><span class="p">[</span><span class="n">iy</span><span class="p">]],</span> <span class="p">[</span><span class="n">yc</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">yc</span><span class="p">[</span><span class="n">iy</span><span class="p">]],</span> <span class="s1">&#39;C2&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title_str</span> <span class="o">+</span><span class="s1">&#39; cost = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">C</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Çözüm, seçilen hisse senetlerini yıldızlarla ve bağlı hisse senetleri ile fonda temsil edilen diğer hisse senetleriyle olan bağlantıları (benzerlikler yoluyla) yeşil renkte gösterir.</p>
</div>
<div class="section" id="IBM-Q-ile-Kuantum-Hesaplama">
<h2>IBM Q ile Kuantum Hesaplama<a class="headerlink" href="#IBM-Q-ile-Kuantum-Hesaplama" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>Kuantum çözümü için Qiskit’i kullanıyoruz. Problemi çözmek için önce, kuantum yaklaşımını kodlayan bir QuantumOptimizer sınıfı tanımlıyoruz ve sonra onu örnekleyip çözüyoruz. Aşağıdaki metotları sınıf içinde tanımlıyoruz:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exact_solution</span></code>: Ising Hamiltonyen’in <span class="math notranslate nohighlight">\(Z\)</span> bazında doğru kodlandığından emin olmak için, <span class="math notranslate nohighlight">\(2^N \times 2^N\)</span> boyutunun simetrik bir matrisini dikkate alarak, özdeğerlerine ve özvektörlerine ayırmasını klasik olarak hesaplayabiliriz. Elimizdeki problem için <span class="math notranslate nohighlight">\(n=3\)</span>, yani <span class="math notranslate nohighlight">\(N = 12\)</span>, birçok dizüstü bilgisayar için sınır olarak görünüyor;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vqe_solution</span></code> : <span class="math notranslate nohighlight">\((M)\)</span> problemini variational quantum eigensolver (VQE) aracılığıyla çözer;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qaoa_solution</span></code> : <span class="math notranslate nohighlight">\((M)\)</span> problemini bir Kuantum Yaklaşık Optimizasyon Algoritması (QAOA) aracılığıyla çözer.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">StateFn</span>
<span class="kn">from</span> <span class="nn">qiskit.utils</span> <span class="kn">import</span> <span class="n">algorithm_globals</span>

<span class="k">class</span> <span class="nc">QuantumOptimizer</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">q</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">PortfolioDiversification</span><span class="p">(</span><span class="n">similarity_matrix</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span> <span class="n">num_assets</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">num_clusters</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">to_quadratic_program</span><span class="p">()</span>

    <span class="c1"># Obtains the least eigenvalue of the Hamiltonian classically</span>
    <span class="k">def</span> <span class="nf">exact_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">exact_mes</span> <span class="o">=</span> <span class="n">NumPyMinimumEigensolver</span><span class="p">()</span>
        <span class="n">exact_eigensolver</span> <span class="o">=</span> <span class="n">MinimumEigenOptimizer</span><span class="p">(</span><span class="n">exact_mes</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">exact_eigensolver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qp</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">vqe_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">algorithm_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">)</span>
        <span class="n">cobyla</span> <span class="o">=</span> <span class="n">COBYLA</span><span class="p">()</span>
        <span class="n">cobyla</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
        <span class="n">ry</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="s1">&#39;cz&#39;</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">entanglement</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
        <span class="n">quantum_instance</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">vqe_mes</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">ry</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">cobyla</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">quantum_instance</span><span class="p">)</span>
        <span class="n">vqe</span> <span class="o">=</span> <span class="n">MinimumEigenOptimizer</span><span class="p">(</span><span class="n">vqe_mes</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qp</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">qaoa_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">algorithm_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="mi">1234</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">)</span>
        <span class="n">cobyla</span> <span class="o">=</span> <span class="n">COBYLA</span><span class="p">()</span>
        <span class="n">cobyla</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
        <span class="n">quantum_instance</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">qaoa_mes</span> <span class="o">=</span> <span class="n">QAOA</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">cobyla</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">quantum_instance</span><span class="p">)</span>
        <span class="n">qaoa</span> <span class="o">=</span> <span class="n">MinimumEigenOptimizer</span><span class="p">(</span><span class="n">qaoa_mes</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">qaoa</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qp</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">decode_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">quantum_solution</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ground_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qp</span><span class="o">.</span><span class="n">objective</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">quantum_solution</span><span class="p">,</span> <span class="n">ground_level</span>

</pre></div>
</div>
</div>
<div class="section" id="1.-Adım">
<h3>1. Adım<a class="headerlink" href="#1.-Adım" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p>Kuantum en iyileştirici sınıfını şu parametrelerle örnekleyin: - benzerlik matrisi <code class="docutils literal notranslate"><span class="pre">rho</span></code>; - varlıkların ve kümelerin sayısı <code class="docutils literal notranslate"><span class="pre">n</span></code> ve <code class="docutils literal notranslate"><span class="pre">q</span></code>;</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instantiate the quantum optimizer class with parameters:</span>
<span class="n">quantum_optimizer</span> <span class="o">=</span> <span class="n">QuantumOptimizer</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.-Adım">
<h3>2. Adım<a class="headerlink" href="#2.-Adım" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p>Problemi ikili formülasyon (IH-QP) olarak kodlayın.</p>
<p>Sağlama: kuantum en iyileyicideki ikili formülasyonun doğru olduğundan emin olun (yani, aynı çözüm verildiğinde aynı maliyet sonucunu vermeli).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check if the binary representation is correct. This requires CPLEX</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cplex</span>
    <span class="c1">#warnings.filterwarnings(&#39;ignore&#39;)</span>
    <span class="n">quantum_solution</span><span class="p">,</span> <span class="n">quantum_cost</span> <span class="o">=</span> <span class="n">quantum_optimizer</span><span class="o">.</span><span class="n">exact_solution</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">quantum_solution</span><span class="p">,</span> <span class="n">quantum_cost</span><span class="p">)</span>
    <span class="n">classical_solution</span><span class="p">,</span> <span class="n">classical_cost</span> <span class="o">=</span> <span class="n">classical_optimizer</span><span class="o">.</span><span class="n">cplex_solution</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">classical_solution</span><span class="p">,</span> <span class="n">classical_cost</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">quantum_cost</span> <span class="o">-</span> <span class="n">classical_cost</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Binary formulation is correct&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the formulation of the Hamiltonian&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1. 0. 1. 0. 1. 0.] 1.000779571614484
[1. 0. 1. 0. 1. 0.] 1.000779571614484
Binary formulation is correct
</pre></div></div>
</div>
</div>
<div class="section" id="3.-Adım">
<h3>3. Adım<a class="headerlink" href="#3.-Adım" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p>Problemi Z bazında Ising Hamiltonyen olarak kodlayın.</p>
<p>Sağlama: formülasyonun doğru olduğundan emin olun (yani, aynı çözüm verildiğinde aynı maliyeti sağlamalı)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ground_state</span><span class="p">,</span> <span class="n">ground_level</span> <span class="o">=</span> <span class="n">quantum_optimizer</span><span class="o">.</span><span class="n">exact_solution</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ground_state</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ground_level</span> <span class="o">-</span> <span class="n">classical_cost</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.01</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ising Hamiltonian in Z basis is correct&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the Ising Hamiltonian formulation&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1. 0. 1. 0. 1. 0.]
Ising Hamiltonian in Z basis is correct
</pre></div></div>
</div>
</div>
<div class="section" id="4.-Adım">
<h3>4. Adım<a class="headerlink" href="#4.-Adım" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p>Problemi VQE ile çözün. Kübit sayısına bağlı olarak bunun biraz zaman alabileceğine dikkat etmelisiniz: 6 kübit için 2015 Macbook Pro’da 15 dakika, 12 kübit için 12 saatten fazla sürer. Daha uzun süreli çalıştırmalarda, çalışmaları gözlemlemek için kayıt tutmak yararlı olabilir; aksi takdirde, çözüm yazdırılana kadar beklemeniz gerekir.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vqe_state</span><span class="p">,</span> <span class="n">vqe_level</span> <span class="o">=</span> <span class="n">quantum_optimizer</span><span class="o">.</span><span class="n">vqe_solution</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vqe_state</span><span class="p">,</span> <span class="n">vqe_level</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ground_state</span> <span class="o">-</span> <span class="n">vqe_state</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;VQE produces the same solution as the exact eigensolver.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;VQE does not produce the same solution as the exact eigensolver, but that is to be expected.&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0. 1. 0. 1. 0. 1.] 1.000779571614484
VQE does not produce the same solution as the exact eigensolver, but that is to be expected.
/Users/atsushi/github/qiskit-optimization/qiskit_optimization/algorithms/optimization_algorithm.py:137: UserWarning: The sum of probability of samples is not close to 1: 0.99990516095309
  warn(&#39;The sum of probability of samples is not close to 1: {}&#39;.format(sum_prob))
</pre></div></div>
</div>
</div>
<div class="section" id="5.-Adım">
<h3>5. Adım<a class="headerlink" href="#5.-Adım" title="Bu başlık için kalıcı bağlantı">¶</a></h3>
<p>Çözümü görselleştirme</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visualize_solution</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">ground_state</span><span class="p">,</span> <span class="n">ground_level</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="s1">&#39;Classical&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_portfolio_diversification_24_0.svg" src="../_images/tutorials_02_portfolio_diversification_24_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visualize_solution</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">vqe_state</span><span class="p">,</span> <span class="n">vqe_level</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="s1">&#39;VQE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_portfolio_diversification_25_0.svg" src="../_images/tutorials_02_portfolio_diversification_25_0.svg" /></div>
</div>
<p>Çözüm, seçilen hisse senetlerini yıldızlarla ve bağlı hisse senedi ile fonda temsil edilen diğer hisse senetleriyle bağlantılarını (benzerlikler yoluyla) yeşil renkte gösterir. Yine de, VQE’nin Ising Hamiltonyen’in QP formülasyonunda buluşsal bir çalışma olduğunu unutmayınız. Uygun A seçimleri için, QP formülasyonunun yerel optimumları, ILP’ye yönelik uygun çözümler olacaktır. Yukarıdaki gibi bazı küçük örnekler için, ILP’nin optimumları ile örtüşen QP formülasyonunun optimal çözümlerini bulabilsek de, genel olarak, ILP’nin optimal çözümlerinin bulunması QP formülasyonunun optimal çözümlerinin bulunmasından daha zordur. VQE içinde bile, belirli değişimsel formlar için (deneme dalga fonksiyonları) daha güçlü güvenceler sağlanabilir.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>None</td></tr><tr><td>Terra</td><td>0.17.0.dev0+89d15f3</td></tr><tr><td>Aer</td><td>0.7.4</td></tr><tr><td>Ignis</td><td>0.5.2</td></tr><tr><td>Aqua</td><td>None</td></tr><tr><td>IBM Q Provider</td><td>0.11.1</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.8.6 (default, Mar 10 2021, 14:41:09)
[Clang 12.0.0 (clang-1200.0.32.29)]</td></tr><tr><td>OS</td><td>Darwin</td></tr><tr><td>CPUs</td><td>8</td></tr><tr><td>Memory (Gb)</td><td>32.0</td></tr><tr><td colspan='2'>Thu Mar 18 19:23:31 2021 JST</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2021.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="03_european_call_option_pricing.html" class="btn btn-neutral float-right" title="Pricing European Call Options" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="01_portfolio_optimization.html" class="btn btn-neutral" title="Portföy Optimizasyonu" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, 2021, Qiskit Finance Development Team.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Portföy çeşitlendirme</a><ul>
<li><a class="reference internal" href="#Introduction">Introduction</a></li>
<li><a class="reference internal" href="#Model">Model</a></li>
<li><a class="reference internal" href="#Hibrit-Bir-Yaklaşım">Hibrit Bir Yaklaşım</a><ul>
<li><a class="reference internal" href="#İkili-bir-polinom-optimizasyonu-oluşturun">İkili bir polinom optimizasyonu oluşturun</a></li>
<li><a class="reference internal" href="#Ising-Hamilton’u-Oluşturun">Ising Hamilton’u Oluşturun</a></li>
<li><a class="reference internal" href="#Hamiltonyen'den-Kuadratik-Programlama-(KP)-formülasyonuna">Hamiltonyen’den Kuadratik Programlama (KP) formülasyonuna</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Kaynaklar">Kaynaklar</a></li>
<li><a class="reference internal" href="#Uygulama">Uygulama</a></li>
<li><a class="reference internal" href="#IBM-ILOG-CPLEX-kullanılarak-klasik-çözüm">IBM ILOG CPLEX kullanılarak klasik çözüm</a></li>
<li><a class="reference internal" href="#IBM-Q-ile-Kuantum-Hesaplama">IBM Q ile Kuantum Hesaplama</a><ul>
<li><a class="reference internal" href="#1.-Adım">1. Adım</a></li>
<li><a class="reference internal" href="#2.-Adım">2. Adım</a></li>
<li><a class="reference internal" href="#3.-Adım">3. Adım</a></li>
<li><a class="reference internal" href="#4.-Adım">4. Adım</a></li>
<li><a class="reference internal" href="#5.-Adım">5. Adım</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
         <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/documentation/">Qiskit Documentation</a>
          </li>

          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/qiskit-finance" target="_blank">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>